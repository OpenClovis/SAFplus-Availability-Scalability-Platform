<?xml version='1.0'?>
<project name="model" default="all" basedir="..">
    <property name="debug"      value="true"/>

    <property name="lib.home"   value="lib"/>
    <property name="lib.castor" value="${lib.home}/castor"/>
    <property name="src.home"   value="src"/>
    <property name="src.model"  value="${src.home}/com/clovis/model"/>
    <property name="dist.home"  value="dist"/>
    <property name="genpackage" value="com.clovis.model.schema.castor"/>
    
    <property name="castor_gen_pkg" value="com.clovis.model.schema.castor"/>
    <property name="castor_gen_dir" value="com/clovis/model/schema/castor"/>

    <path id="model.classpath">
        <fileset dir="${lib.home}">
            <include name="**/*.jar"/>
        </fileset>
        <fileset dir="${dist.home}">
            <include name="logging.jar"/>
        </fileset>
    </path>

    <taskdef name="castor"
        classpathref="model.classpath" classname="CastorSourceGenTask"/>

    <target name="clean">
        <delete>
            <fileset dir="${src.model}" includes="*.class"/>
            <fileset dir="${src.model}" includes="**/*.class"/>
        </delete>
    </target>

    <target name="distclean">
        <delete>
            <fileset dir="${src.model}" includes="*.class"/>
            <fileset dir="${src.model}" includes="**/*.class"/>
            <fileset dir="${src.home}/${castor_gen_dir}" includes="*.java"/>
            <fileset dir="${src.home}/${castor_gen_dir}" includes="**/*.java"/>
        </delete>
    </target>

    <target name="classgen">
        <castor file="${src.model}/schema/SchemaAttrs.xsd" 
            types="j2"
            properties="${src.model}/schema/castorbuilder.properties"
            todir="${src.home}" package="${castor_gen_pkg}"/>
    </target>

    <target name="test" depends="all">
        <java classname="${test.class}">
            <arg line="${test.args}"/>
            <classpath>
                <pathelement location="${src.home}"/>
                <path refid="model.classpath"/>
            </classpath>
        </java>
    </target>

    <target name="all" depends="classgen">
        <javac srcdir="${src.model}"
            destdir="${src.home}"
			debug="${debug}" deprecation="${deprecation}" optimize="${optimize}">
			<classpath refid="model.classpath"/>
		</javac>
    </target>
</project>
