------------------------------------------------------------------------
r1451 | sdake | 2007-09-15 13:48:31 -0700 (Sat, 15 Sep 2007) | 3 lines

Fix reference counting in LCR code.  Also fix problem with inability to compile
from the exec directory because PREFIX wasn't defined for lcr_ifact.c.

------------------------------------------------------------------------
r1448 | sdake | 2007-09-15 13:32:36 -0700 (Sat, 15 Sep 2007) | 2 lines

Allow missing spots in the synchronization engine

------------------------------------------------------------------------
r1447 | sdake | 2007-09-15 13:14:55 -0700 (Sat, 15 Sep 2007) | 24 lines

Fixes the following problems:
1) the encapsulated and not encapsulated values for multicast messages
are now enumerated instead of magic number.
2) the endian detector is now set for new encapsulated messages intended
for transmission.  previously these messages would use whichever endian
detector value happened to be in memory which could be a) correct endian
b) incorrect endian from another machine byte order message c) junk
values.
3) The retransmission flag is not set by default on new originated
tokens in the recovery state.  Instead it is set based upon whether the
node actually can retransmit any messages.
4) some workaround code was removed that was necessary to make the
system work when #3 was incorrect
5) the my_install_seq and my_aru fields are compared based upon a window
instead of static comparison because it could be that the my_aru is
0xFFFFFF5 where my_install_seq is 5.  In this case (after a lot of
messages are sent) the comparison would return the incorrect result in
the recovery phase of the algorithm.
6) The queue chosen for adding messages to the retransmission queue is
now set based upon the encapsulated bit rather then the current state of
the state machine.
7) the encapsulated bit is set properly in an endian conversion
operation for a multicast message header.

------------------------------------------------------------------------
r1445 | sdake | 2007-09-11 12:27:13 -0700 (Tue, 11 Sep 2007) | 2 lines

Add missing files from the ais utils exporting patch.

------------------------------------------------------------------------
r1444 | sdake | 2007-09-09 00:00:53 -0700 (Sun, 09 Sep 2007) | 2 lines

Calculate the default path based on the project value of PREFIX

------------------------------------------------------------------------
r1443 | sdake | 2007-09-09 00:00:13 -0700 (Sun, 09 Sep 2007) | 2 lines

Ensure DESTDIR and PREFIX are properly used in Makefiles

------------------------------------------------------------------------
r1442 | sdake | 2007-09-08 23:58:41 -0700 (Sat, 08 Sep 2007) | 2 lines

Expose utils to the user

------------------------------------------------------------------------
r1441 | sdake | 2007-09-08 23:57:41 -0700 (Sat, 08 Sep 2007) | 2 lines

Now that -l is set correclt yuse #include <header.h> instead of using quotes.

------------------------------------------------------------------------
r1440 | sdake | 2007-09-08 23:51:39 -0700 (Sat, 08 Sep 2007) | 2 lines

Static libraries become out of date on Darwin once they are copied or moved

------------------------------------------------------------------------
r1439 | sdake | 2007-09-08 23:50:52 -0700 (Sat, 08 Sep 2007) | 2 lines

Use makefile loops where possible

------------------------------------------------------------------------
r1438 | sdake | 2007-09-08 23:50:18 -0700 (Sat, 08 Sep 2007) | 2 lines

Provide information as to why a plugin refused to load

------------------------------------------------------------------------
r1437 | sdake | 2007-09-08 23:49:43 -0700 (Sat, 08 Sep 2007) | 2 lines

Add extra brackets to clarify scope.

------------------------------------------------------------------------
r1436 | sdake | 2007-09-08 23:47:57 -0700 (Sat, 08 Sep 2007) | 2 lines

Fix build dependencies

------------------------------------------------------------------------
r1435 | sdake | 2007-09-08 23:47:16 -0700 (Sat, 08 Sep 2007) | 3 lines

If iface_ver0_p is not reset, then as long as the first plugin loads 
then all subsequent plugins will report success.

------------------------------------------------------------------------
r1434 | sdake | 2007-09-08 23:46:41 -0700 (Sat, 08 Sep 2007) | 2 lines

Missing stdlib.h from lcr_ifact.c.

------------------------------------------------------------------------
r1433 | sdake | 2007-09-08 23:46:03 -0700 (Sat, 08 Sep 2007) | 2 lines

HZ not always defined on all Linux systems.

------------------------------------------------------------------------
r1432 | sdake | 2007-09-08 23:45:35 -0700 (Sat, 08 Sep 2007) | 2 lines

Patch to allow CFLAGS and LDFLAGS modifications to take effect

------------------------------------------------------------------------
r1431 | sdake | 2007-09-08 23:43:20 -0700 (Sat, 08 Sep 2007) | 2 lines

Logsys testing system.

------------------------------------------------------------------------
r1430 | sdake | 2007-09-08 23:41:19 -0700 (Sat, 08 Sep 2007) | 2 lines

Fixes for the logsys system.

------------------------------------------------------------------------
r1429 | sdake | 2007-09-08 23:38:27 -0700 (Sat, 08 Sep 2007) | 2 lines

The man page for the logsys logging system.

------------------------------------------------------------------------
r1428 | sdake | 2007-09-08 23:38:10 -0700 (Sat, 08 Sep 2007) | 2 lines

The logsys logging system.  Read logsys_overview.8.

------------------------------------------------------------------------
r1427 | sdake | 2007-09-08 23:24:00 -0700 (Sat, 08 Sep 2007) | 2 lines

totem srp merge from whitetank

------------------------------------------------------------------------
r1425 | sdake | 2007-09-08 23:15:31 -0700 (Sat, 08 Sep 2007) | 3 lines

Patch to log security warnings when invalid identifier is used in message
header for a totem message.

------------------------------------------------------------------------
r1424 | sdake | 2007-09-08 23:12:56 -0700 (Sat, 08 Sep 2007) | 3 lines

Fix problem in synchronization engine which results in possible failures of
the synchronization engine.

------------------------------------------------------------------------
r1421 | sdake | 2007-08-24 12:45:23 -0700 (Fri, 24 Aug 2007) | 3 lines

Patch to allocate event dispatch data in saEvtInitialize instead of directly
on the stack for small thread-stack sized dispatch functions.

------------------------------------------------------------------------
r1420 | sdake | 2007-08-10 21:40:42 -0700 (Fri, 10 Aug 2007) | 3 lines

Patch to not overwrite defualt configuration file or amf.conf file when
executing make install

------------------------------------------------------------------------
r1418 | sdake | 2007-08-10 21:36:52 -0700 (Fri, 10 Aug 2007) | 2 lines

Allow make doxygen to work properly

------------------------------------------------------------------------
r1417 | sdake | 2007-08-10 21:35:50 -0700 (Fri, 10 Aug 2007) | 2 lines

Patch to add amf_strdup instead of malloc and then copy for amf service.

------------------------------------------------------------------------
r1412 | sdake | 2007-08-07 16:52:21 -0700 (Tue, 07 Aug 2007) | 2 lines

Fix minor leaks caused by not calling pthread_mutex_destroy throughout the tree.

------------------------------------------------------------------------
r1411 | sdake | 2007-08-07 16:49:24 -0700 (Tue, 07 Aug 2007) | 2 lines

Patch to fix compile warning on mac platforms.

------------------------------------------------------------------------
r1405 | sdake | 2007-07-02 14:13:52 -0700 (Mon, 02 Jul 2007) | 2 lines

Add the testcpg2 file missing from a previous commit.

------------------------------------------------------------------------
r1404 | fthomas | 2007-07-02 05:41:53 -0700 (Mon, 02 Jul 2007) | 1 line

remove warnings under Darwin for missing includes and too many parameters in TRACE2
------------------------------------------------------------------------
r1399 | pcaulfie | 2007-06-25 05:34:44 -0700 (Mon, 25 Jun 2007) | 2 lines

Clear pid when we leave a process group

------------------------------------------------------------------------
r1398 | sdake | 2007-06-25 01:45:58 -0700 (Mon, 25 Jun 2007) | 3 lines

Fix bug where if checkpoint section is expired about the same time as a
checkpoint is deleted, a warning would be displayed.

------------------------------------------------------------------------
r1397 | sdake | 2007-06-25 01:45:29 -0700 (Mon, 25 Jun 2007) | 2 lines

Update testckpt program to properly test checkpoint system.

------------------------------------------------------------------------
r1391 | sdake | 2007-06-24 20:04:35 -0700 (Sun, 24 Jun 2007) | 2 lines

Add cpg_local_get api to cpg service

------------------------------------------------------------------------
r1388 | sdake | 2007-06-23 23:44:27 -0700 (Sat, 23 Jun 2007) | 2 lines

Add IP address takeover as an AMF component

------------------------------------------------------------------------
r1386 | sdake | 2007-06-23 02:14:15 -0700 (Sat, 23 Jun 2007) | 2 lines

Add passive monitoring support to AMF.

------------------------------------------------------------------------
r1385 | pcaulfie | 2007-06-14 07:21:49 -0700 (Thu, 14 Jun 2007) | 2 lines

Add man pages for cpg_context_* and fix library exports to include them too.

------------------------------------------------------------------------
r1384 | pcaulfie | 2007-06-13 02:09:10 -0700 (Wed, 13 Jun 2007) | 4 lines

Install the timer.h file so it can be used by
external services and remove a dependency on tlist.h


------------------------------------------------------------------------
r1383 | pcaulfie | 2007-06-13 02:01:30 -0700 (Wed, 13 Jun 2007) | 9 lines

Currently saLckResourceUnlockAsync leaves the lockid in the handle database even
when the lock has been unlocked. This can cause exec crashes if the lock is
unlocked twice.

This patch adds an extra field to the res_lib_lck_resourceunlockasync structure
so that the library can remove the lock from the handle database when the lock
is unlocked successfully, as well as code to do it, obviously.


------------------------------------------------------------------------
r1381 | fthomas | 2007-06-12 09:43:50 -0700 (Tue, 12 Jun 2007) | 1 line

repair BSD/Darwin build by moving HZ constant in tlist.h
------------------------------------------------------------------------
r1380 | pcaulfie | 2007-06-05 02:52:29 -0700 (Tue, 05 Jun 2007) | 2 lines

Cast away a compile warning

------------------------------------------------------------------------
r1379 | sdake | 2007-06-05 01:55:44 -0700 (Tue, 05 Jun 2007) | 2 lines

Remove this_ip from the source tree and replace with accessor functions.

------------------------------------------------------------------------
r1378 | sdake | 2007-06-04 16:21:46 -0700 (Mon, 04 Jun 2007) | 3 lines

Change timers to add duration and absolute timers.  Use nanoseconds since
epoch to track timers.

------------------------------------------------------------------------
r1377 | pcaulfie | 2007-05-31 02:41:37 -0700 (Thu, 31 May 2007) | 2 lines

Add get/set context API calls to the cpg service.

------------------------------------------------------------------------
r1376 | pcaulfie | 2007-05-30 01:41:46 -0700 (Wed, 30 May 2007) | 3 lines

Don't try and remove a lock from a list if it's not on one, but DO remove
it from the resources list when it gets unlocked.

------------------------------------------------------------------------
r1375 | sdake | 2007-05-22 08:45:31 -0700 (Tue, 22 May 2007) | 2 lines

Sanitize the ETCDIR usage in the Makefiles.

------------------------------------------------------------------------
r1374 | sdake | 2007-05-22 08:44:42 -0700 (Tue, 22 May 2007) | 2 lines

Use rync -a when cp -a is not available on MAC OSX platform install

------------------------------------------------------------------------
r1373 | pcaulfie | 2007-05-18 00:28:36 -0700 (Fri, 18 May 2007) | 6 lines

This patch fixes the marshalling of lock names in libSaLck, they
were copied using memcpy, but the alignment of a mar_name_t is not necessarily
the same as SaNameT. This patch changes memcpy() to marshall_to_mar_name_t().



------------------------------------------------------------------------
r1371 | sdake | 2007-05-17 13:37:20 -0700 (Thu, 17 May 2007) | 3 lines

on 32 bit platforms, the message source conn info could have uninitialized
values.

------------------------------------------------------------------------
r1370 | pcaulfie | 2007-05-05 07:02:53 -0700 (Sat, 05 May 2007) | 7 lines

In trunk, totemip.h and totem.h call for "../include/swab.h" - this works fine
when building openais itself but causes problems when installed as those files
will not be in the right place.

So, I've moved these includes out of totemip.h and totem.h and into the .c files
that call them.

------------------------------------------------------------------------
r1367 | sdake | 2007-04-24 16:10:51 -0700 (Tue, 24 Apr 2007) | 2 lines

Fix section iteration size comparison

------------------------------------------------------------------------
r1366 | sdake | 2007-04-24 16:08:48 -0700 (Tue, 24 Apr 2007) | 2 lines

Print Unknown Time if the time is unknown of an event.

------------------------------------------------------------------------
r1365 | sdake | 2007-04-24 16:08:18 -0700 (Tue, 24 Apr 2007) | 2 lines

Change tab alignment on checkpoint write operation to match coding style guidelines

------------------------------------------------------------------------
r1362 | sdake | 2007-04-24 16:02:21 -0700 (Tue, 24 Apr 2007) | 2 lines

Fixes problem where if attributes list is zero, library would segfault

------------------------------------------------------------------------
r1361 | sdake | 2007-04-21 16:49:47 -0700 (Sat, 21 Apr 2007) | 2 lines

change references to evs to cpg to match API

------------------------------------------------------------------------
r1360 | sdake | 2007-04-20 17:02:29 -0700 (Fri, 20 Apr 2007) | 2 lines

Patch from Angus to fix return code of saAmfResponse if the handle was invalid.

------------------------------------------------------------------------
r1358 | sdake | 2007-03-21 13:08:29 -0700 (Wed, 21 Mar 2007) | 2 lines

Fix documentation errors in cpg service.

------------------------------------------------------------------------
r1355 | sdake | 2007-03-14 12:02:49 -0700 (Wed, 14 Mar 2007) | 2 lines

Solaris port patch to fix a few problems from last big patch.

------------------------------------------------------------------------
r1354 | sdake | 2007-03-12 10:28:44 -0700 (Mon, 12 Mar 2007) | 2 lines

Patch to allow BSD/Linux systems to compile with latest Solaris porting patch.

------------------------------------------------------------------------
r1353 | sdake | 2007-03-06 09:18:44 -0700 (Tue, 06 Mar 2007) | 2 lines

Patch from Renaud to report some broken Solaris porting from past.

------------------------------------------------------------------------
r1352 | hafe | 2007-01-26 06:03:55 -0700 (Fri, 26 Jan 2007) | 8 lines

This patch improves AMF's behaviour for handling component instantiation level.
AMF is complemented to handle termination and instantiation with respect to
instantiation level also for the following scenarios:
- SU restart
- termination/instantiation errors during component/SU restart
- instantiation error during cluster start up


------------------------------------------------------------------------
r1351 | hafe | 2007-01-25 01:19:38 -0700 (Thu, 25 Jan 2007) | 2 lines

Was writing to random mem using an uninitialized pointer

------------------------------------------------------------------------
r1350 | sdake | 2007-01-23 10:39:43 -0700 (Tue, 23 Jan 2007) | 2 lines

Display the names of the configuration files used by openais.

------------------------------------------------------------------------
r1349 | sdake | 2007-01-23 10:38:58 -0700 (Tue, 23 Jan 2007) | 2 lines

Add two notifications about things to avoid to ensure proper operation of the parser.

------------------------------------------------------------------------
r1348 | sdake | 2007-01-23 10:07:50 -0700 (Tue, 23 Jan 2007) | 2 lines

Fixes from Zoltan regarding AMF mispellings and type errors.

------------------------------------------------------------------------
r1347 | homlhl | 2007-01-18 00:39:42 -0700 (Thu, 18 Jan 2007) | 4 lines

- improves the inclosed dokumentation in amfsu,amfsg and amnode.
- improves error handling  caused by the INSTANTIATE or CLEANUP  command
  while recovering  with component_restart or su_restart

------------------------------------------------------------------------
r1346 | homlhl | 2006-12-21 05:33:39 -0700 (Thu, 21 Dec 2006) | 4 lines

1 The patch contains mainly updates of the header documentation in the
amf_files
2 Correction of the misspelling in lib/cfg.c

------------------------------------------------------------------------
r1343 | sdake | 2006-12-18 08:22:59 -0700 (Mon, 18 Dec 2006) | 2 lines

Fix unaligned access for ia64 arch.

------------------------------------------------------------------------
r1342 | sdake | 2006-12-18 08:21:28 -0700 (Mon, 18 Dec 2006) | 2 lines

Fix typo in pthread_mutex_destroy.

------------------------------------------------------------------------
r1341 | sdake | 2006-12-18 08:09:31 -0700 (Mon, 18 Dec 2006) | 2 lines

Execute pthread destroy in queue_free in trunk.

------------------------------------------------------------------------
r1336 | sdake | 2006-12-12 11:44:19 -0700 (Tue, 12 Dec 2006) | 2 lines

Fix mutex leak on various platforms.

------------------------------------------------------------------------
r1335 | sdake | 2006-12-12 11:40:01 -0700 (Tue, 12 Dec 2006) | 2 lines

Remove leak when pthread mutex isn't released

------------------------------------------------------------------------
r1333 | sdake | 2006-12-12 11:35:58 -0700 (Tue, 12 Dec 2006) | 2 lines

Fix leak by forward porting a change already in whitetank.

------------------------------------------------------------------------
r1332 | sdake | 2006-12-12 11:33:13 -0700 (Tue, 12 Dec 2006) | 2 lines

Change timing parameters for trunk to something more reasonable for a busy network.

------------------------------------------------------------------------
r1331 | sdake | 2006-12-12 11:21:33 -0700 (Tue, 12 Dec 2006) | 2 lines

Convert some spaces to tabs that was already in the whitetank branch.

------------------------------------------------------------------------
r1328 | sdake | 2006-12-12 11:08:06 -0700 (Tue, 12 Dec 2006) | 2 lines

Fix leak in uid and gid determination.

------------------------------------------------------------------------
r1327 | sdake | 2006-12-12 11:03:55 -0700 (Tue, 12 Dec 2006) | 2 lines

Fix flow control problem in trunk.

------------------------------------------------------------------------
r1326 | sdake | 2006-12-12 10:58:41 -0700 (Tue, 12 Dec 2006) | 2 lines

Add rundir patch to /var/lib/openais.

------------------------------------------------------------------------
r1324 | pcaulfie | 2006-12-12 10:47:33 -0700 (Tue, 12 Dec 2006) | 2 lines

Fix ordering of join messages

------------------------------------------------------------------------
r1322 | homlhl | 2006-12-10 23:06:21 -0700 (Sun, 10 Dec 2006) | 3 lines

Correct not initialized value  of  amf_comp in
amf_comp_find_from_conn_info () 

------------------------------------------------------------------------
r1321 | homlhl | 2006-12-10 22:37:07 -0700 (Sun, 10 Dec 2006) | 43 lines

This patch contians:

-  AMF handles a component report of injurious health.

- AMF handles saAmfHealthcheckConfirm() SA_AIS_ERR_FAILED_OPERATION
so that if it's a recent recovery ongoing amf does nothing but if it's
no  immediate recovery in progress, AMF invokes the recovery action
specified by the component when the health check is started If
the individual recommendation was SA_AMF_NO_RECOMMENDATION,
then AMF uses the configured recovery action for the component
(saAmfCompRecoveryOnError). If this recommendation also is
SA_AMF_NO_RECOMMENDATION, then AMF makes a component restart or
component/SU fail over counts on the value of
saAmfCompDisableRestart and saAmfSUFailover.

- Handling of cleanup of a component and health check response hardened.


- Time supervision and check return value of clc-cli CLEANUP command.


- Handle 'recommended recovery' specified by a component in an error
report. The potential recovery action to  choose
implemented is - component restart - and - node fails over.

- The attribute saAmfCompDisableRestart is now recognizable which means
that if the component specifies 'Component restart' and restart is
disabled
then the SU in which the component is contained shall fall over.

- The attribute saAmfSUFailover will not be recognized. SU will always
  fail
over as a single entity.

- A component can report an error on another component than itself.


- Implementation 'Instantiation Level' according to chapter 3.9.2 in the
AMF specification.
- Implementation of the escalation levels, component restart, SU
restart, SU fail over and Node fail over.


------------------------------------------------------------------------
r1320 | hafe | 2006-12-06 02:02:25 -0700 (Wed, 06 Dec 2006) | 2 lines

Corrected amf.c bug that could cause segv

------------------------------------------------------------------------
r1318 | hafe | 2006-12-05 05:36:29 -0700 (Tue, 05 Dec 2006) | 3 lines

Correction to segv handler
Added abort handler

------------------------------------------------------------------------
r1317 | hafe | 2006-12-04 07:28:40 -0700 (Mon, 04 Dec 2006) | 4 lines

- Use of sync_request() in SYNC service
- sync_abort() callback implemented


------------------------------------------------------------------------
r1311 | fthomas | 2006-11-23 01:49:21 -0700 (Thu, 23 Nov 2006) | 1 line

handle case where POLLHUP or POLLERR are not supported by OS
------------------------------------------------------------------------
r1310 | hafe | 2006-11-16 23:57:00 -0700 (Thu, 16 Nov 2006) | 2 lines

Cleaning up and preparing for later patch.

------------------------------------------------------------------------
r1309 | fthomas | 2006-11-16 10:36:52 -0700 (Thu, 16 Nov 2006) | 1 line

set default downcheck value to 1000ms
------------------------------------------------------------------------
r1308 | fthomas | 2006-11-16 10:34:44 -0700 (Thu, 16 Nov 2006) | 1 line

remove invalid code / warnings detected by Intel compiler
------------------------------------------------------------------------
r1304 | sdake | 2006-11-13 11:08:32 -0700 (Mon, 13 Nov 2006) | 3 lines

Print information about when we enter the gather state and what state the
membership protocol is in when the token is lost.

------------------------------------------------------------------------
r1303 | sdake | 2006-11-13 10:55:51 -0700 (Mon, 13 Nov 2006) | 2 lines

Forward port of IPC code from whitetank branch to fix known defects.

------------------------------------------------------------------------
r1302 | sdake | 2006-11-13 10:47:42 -0700 (Mon, 13 Nov 2006) | 2 lines

Flushed printing for trunk branch.

------------------------------------------------------------------------
r1301 | sdake | 2006-11-13 10:39:10 -0700 (Mon, 13 Nov 2006) | 3 lines

Improve behavior of IPC flow control for CPG service during configuration
changes.

------------------------------------------------------------------------
r1299 | sdake | 2006-11-10 10:46:22 -0700 (Fri, 10 Nov 2006) | 3 lines

Update checkpoint service from all qualifications that have occured in
whitetank branch.

------------------------------------------------------------------------
r1298 | sdake | 2006-11-10 10:45:38 -0700 (Fri, 10 Nov 2006) | 2 lines

Recovery algorithms described in this document.

------------------------------------------------------------------------
r1297 | homlhl | 2006-11-10 07:10:46 -0700 (Fri, 10 Nov 2006) | 2 lines

improved cluster_applications_are_starting_sgs

------------------------------------------------------------------------
r1292 | hafe | 2006-11-08 05:13:39 -0700 (Wed, 08 Nov 2006) | 2 lines

removed compiler warning in amfcomp.c

------------------------------------------------------------------------
r1291 | homlhl | 2006-11-08 04:55:16 -0700 (Wed, 08 Nov 2006) | 3 lines

This patch contains several corrections concerning SU and Node fail 
over and some hardening concerning health check handling.

------------------------------------------------------------------------
r1290 | pcaulfie | 2006-11-07 07:47:01 -0700 (Tue, 07 Nov 2006) | 3 lines

2.6.19 kernel headers do not include IFA_RTA so we provide it.
Patch from Fabio Massimo Di Nitto

------------------------------------------------------------------------
r1289 | sdake | 2006-11-04 15:29:14 -0700 (Sat, 04 Nov 2006) | 2 lines

Forward port of flow control work from whitetank branch.

------------------------------------------------------------------------
r1287 | sdake | 2006-11-04 15:20:24 -0700 (Sat, 04 Nov 2006) | 2 lines

Updated readme.devmap file

------------------------------------------------------------------------
r1285 | hafe | 2006-10-27 02:58:59 -0700 (Fri, 27 Oct 2006) | 12 lines

* Improvement of SU fail over to handle remove of those standby assignments
 that doesn't directly is associated to the failing over SU's active assignments
 in other SU's 
* Improvement of Node fail over to handle remove of those standby assignments
 that doesn't directly is associated to the failing over  Node SU's active assignments
 in other SU's.

* Improvement of SU fail over to handle si assignments to spare SU:s

* Improvement of Node fail over to handle si assignments to spare SU:s


------------------------------------------------------------------------
r1281 | hafe | 2006-10-23 23:45:35 -0700 (Mon, 23 Oct 2006) | 3 lines

AMF healthcheck keylen was not compared before matching key values


------------------------------------------------------------------------
r1280 | hafe | 2006-10-23 23:30:50 -0700 (Mon, 23 Oct 2006) | 6 lines

- sync_abort is called if there is a new config change during synchronization

- a new function sync_request() that can be called by a user to execute
synchronization on request of a specified service. 


------------------------------------------------------------------------
r1274 | hafe | 2006-10-20 08:03:42 -0700 (Fri, 20 Oct 2006) | 6 lines

Changes to testamf1.c to have two healthchecks running at the same time.
One of type 'AMF invoked' and one of type 'component invoked'. testamf1.c
code got a bit restructured at the same time.

Changes in amf.conf to complement testamf1 

------------------------------------------------------------------------
r1273 | hafe | 2006-10-20 04:28:51 -0700 (Fri, 20 Oct 2006) | 3 lines

I found some (copy paste I guess) errors in the AMF library. It was
the reason for why component invoked healthchecks did not work at all. 

------------------------------------------------------------------------
r1272 | hafe | 2006-10-20 04:20:59 -0700 (Fri, 20 Oct 2006) | 6 lines

A couple of errors was found when I did unit (component) testing of amf.c
using CUnit. With this patch, amf.c can handle a full totem send queue.
This is not easily reproducable with function test.

amf.c is also prepared for further component testing with this patch. 

------------------------------------------------------------------------
r1266 | homlhl | 2006-10-13 03:18:04 -0700 (Fri, 13 Oct 2006) | 26 lines

Patch contains:

A mechanism to defer and recall simultaneous
events in the state machines for amf_cluster,
amf_application and amf_sg.

The implication of this defer and recall mechanism is
that it's now possible to to recover from e.g. several
simultaneous SU failures in an ordered serialized manner.

The events that could be deferred/recalled so far is
SG_FAILOVER_NODE_EV,SG_START_EV,SG_FAILOVER_SU_EV,
CLUSTER_SYNC_READY_EV,APPLICATION_START_EV and
APPLICATION_ASSIGN_WORKLOAD_EV.

Files involved:

Index: exec/amfnode.c
Index: exec/amfsg.c
Index: exec/amfutil.c
Index: exec/amfapp.c
Index: exec/amfcomp.c
Index: exec/amfcluster.c
Index: exec/amf.h


------------------------------------------------------------------------
r1259 | hafe | 2006-10-11 23:54:14 -0700 (Wed, 11 Oct 2006) | 5 lines

This simple patch solves a problem we see when testing AMF. If a node leaves
and joins the cluster quickly (within one second is default), the config
change messages will not indicate that the node left and rejoined. The patch
introduces a short delay in main() to make sure the token_timeout expires. 

------------------------------------------------------------------------
r1255 | sdake | 2006-10-09 00:41:46 -0700 (Mon, 09 Oct 2006) | 2 lines

Enable commit tokens to be processed properly in all circumstances.

------------------------------------------------------------------------
r1254 | sdake | 2006-10-09 00:41:12 -0700 (Mon, 09 Oct 2006) | 2 lines

Fix subset set operation to work properly.

------------------------------------------------------------------------
r1253 | sdake | 2006-10-09 00:40:46 -0700 (Mon, 09 Oct 2006) | 2 lines

Remove some debbugging code from totemsrp impacting performance.

------------------------------------------------------------------------
r1251 | homlhl | 2006-10-03 22:24:14 -0700 (Tue, 03 Oct 2006) | 65 lines

The patch contains:
 
 The instantiaton of the component is performed with some new steps:
 
 1. SU invoke Comp to instantiate
 2. Comp multicast a new event 
 MESSAGE_REQ_EXEC_AMF_COMPONENT_INSTANTIATE
 3. Comp receive the new  event 
 MESSAGE_REQ_EXEC_AMF_COMPONENT_INSTANTIATE
 4. If the Comp is within the SU hosted on the node. The 

 component invokes

    the clc_cli instantiate script to start the component 

 and start a timer

    to supervise the start and registration of the component.
 5. If the instantiation time elapse before the component has 
 registered himself
    Comp is sending a new multicasted event
    MESSAGE_REQ_EXEC_AMF_COMPONENT_INSTANTIATE_TMO.
 6. Comp receive 

 MESSAGE_REQ_EXEC_AMF_COMPONENT_INSTANTIATE_TMO event.

 7. The Comp presence state is set to 
 SA_AMF_PRESENCE_INSTANTIATION_FAILED
 8. When all Components are in presence state 

 SA_AMF_PRESENCE_INSTANTIATED or

    SA_AMF_PRESENCE_INSTANTIATION_FAILED the start or restart will 
 continue with
    the assignment of load.
 
 This implemntation means that the complete instantiation procedure 
 never will be endlessly waiting for a register. The 

 instantiation will 

 either turn out in a component instantiation failure or a success.
 
 
 Hardening of the cluster start use case:
 
 1. A clearer separation of the responsibilities between 

 amf_cluster and

    amf_application.
                      
 2. A clearer interface and separation between amf_main (amf.c) and 
 amf_cluster.
 
 3. A clearer interface and separation between amf_cluster 

 and amf_node.

 
 4. A clearer separation of the responsibilities between amf_node and
    amf_application.
 


------------------------------------------------------------------------
r1250 | hafe | 2006-09-29 06:27:01 -0700 (Fri, 29 Sep 2006) | 3 lines

The configuration attribute 'saAmfSGNumPrefInserviceSUs' was not
considered by AMF during initial start. 

------------------------------------------------------------------------
r1249 | hafe | 2006-09-29 04:23:00 -0700 (Fri, 29 Sep 2006) | 3 lines

Two configuration attributes for SG objects were not handled
correctly by the config parser. 

------------------------------------------------------------------------
r1247 | hafe | 2006-09-27 22:53:44 -0700 (Wed, 27 Sep 2006) | 7 lines

Patches from Mathieu.Marie@sun.com:
2- On Solaris, the SA components executed have no names.
3- When killing the testamf1 component, it makes the aisexec process 
crash on both of my nodes.
4- max priority for RR on solaris is 59.


------------------------------------------------------------------------
r1244 | hafe | 2006-09-24 23:55:39 -0700 (Sun, 24 Sep 2006) | 7 lines

An update of README.amf to match current state of the implementation.
README.amf now also includes a detailed list of what is currently
NOT implemented.

README.amf includes now, as before, a "demo example".


------------------------------------------------------------------------
r1243 | hafe | 2006-09-24 23:48:38 -0700 (Sun, 24 Sep 2006) | 4 lines

- Fix for bug: 'default section created when syncing'
- Section count synced correctly


------------------------------------------------------------------------
r1242 | hafe | 2006-09-24 23:46:29 -0700 (Sun, 24 Sep 2006) | 4 lines

global_ckpt_id fix #2
ckpt dump function


------------------------------------------------------------------------
r1241 | hafe | 2006-09-20 01:27:01 -0700 (Wed, 20 Sep 2006) | 4 lines

Correction to a problem when a cluster consisting of several nodes starts
initially in an order such that at least two nodes start after at least one
node has been started and its SUs has been instantiated. 

------------------------------------------------------------------------
r1240 | hafe | 2006-09-12 04:04:54 -0700 (Tue, 12 Sep 2006) | 2 lines

Created

------------------------------------------------------------------------
r1239 | hafe | 2006-09-11 00:15:53 -0700 (Mon, 11 Sep 2006) | 3 lines

Fix for global_ckpt_id not synced


------------------------------------------------------------------------
r1238 | hafe | 2006-09-05 22:40:06 -0700 (Tue, 05 Sep 2006) | 4 lines

- ckpt_id was not synced.
- debug printout of list reduced


------------------------------------------------------------------------
r1237 | hafe | 2006-09-05 00:54:00 -0700 (Tue, 05 Sep 2006) | 6 lines

1.    Improvement to manage more than one SG within an Application  and to
	asymmetrically distribute the SG:s among the Nodes.
2.    strcmp bug fixes  several *_find functions.
3.    Minor bug fixes.


------------------------------------------------------------------------
r1236 | hafe | 2006-09-05 00:31:28 -0700 (Tue, 05 Sep 2006) | 14 lines

- "No need for DNS or /etc/hosts"

The call to gethostbyaddr() has been removed. This has been replaced by a
protocol where each node multicasts its hostname (obtained with gethostname()).

- "Logical AMF nodes"

The AMF node name is no longer a hostname. The saAmfNodeClmNode
configuration attribute of the AMF node is now the hostname. This config
attribute is now mandatory. The change to amf.conf file shows required changes.

- Some other AMF sync bug fixes


------------------------------------------------------------------------
r1235 | hafe | 2006-09-01 03:16:25 -0700 (Fri, 01 Sep 2006) | 3 lines

Added file and line of caller, useful for troubleshooting.


------------------------------------------------------------------------
r1234 | hafe | 2006-09-01 03:12:25 -0700 (Fri, 01 Sep 2006) | 7 lines

- enable the global debug flag again, individual 'logger' directives might
  be used to disable a certain logger source.
- when DEBUG compiled it does not use the new printer threads (printouts are not buffered)
- man page update
- openais.conf update


------------------------------------------------------------------------
r1233 | hafe | 2006-08-28 06:11:23 -0700 (Mon, 28 Aug 2006) | 3 lines

Allow AMF to handle health check responses while syncing.


------------------------------------------------------------------------
r1232 | hafe | 2006-08-28 05:44:15 -0700 (Mon, 28 Aug 2006) | 7 lines

1.    Improvement of the use case 'Amf node leave spontaneously'
2.    Improvement of the use case 'Amf node join'
3.    Improvement to manage more than one SG within an Application.
4.    Improvement to manage an arbitrary number of Csi-assignments associated
       to the Csi


------------------------------------------------------------------------
r1231 | fthomas | 2006-08-28 05:19:59 -0700 (Mon, 28 Aug 2006) | 1 line

add missing clean for libcfg
------------------------------------------------------------------------
r1229 | fthomas | 2006-08-24 08:54:10 -0700 (Thu, 24 Aug 2006) | 1 line

correct fd leak on error case
------------------------------------------------------------------------
r1228 | fthomas | 2006-08-24 08:48:25 -0700 (Thu, 24 Aug 2006) | 1 line

correct broken POLLHUP, POLLERR under BSD
------------------------------------------------------------------------
r1227 | hafe | 2006-08-24 02:30:27 -0700 (Thu, 24 Aug 2006) | 1 line

AMF sync improvements: change assert to return in mcast rec.
------------------------------------------------------------------------
r1226 | hafe | 2006-08-24 02:23:40 -0700 (Thu, 24 Aug 2006) | 1 line

testamf1.c improvements
------------------------------------------------------------------------
r1225 | fthomas | 2006-08-23 02:33:08 -0700 (Wed, 23 Aug 2006) | 1 line

return SA_AIS_ERR_INVALID_PARAM when vector ptr is NULL or len equal to 0
------------------------------------------------------------------------
r1222 | fthomas | 2006-08-21 02:49:42 -0700 (Mon, 21 Aug 2006) | 1 line

doc was not updated when switching command line options to lowercase
------------------------------------------------------------------------
r1221 | fthomas | 2006-08-18 00:38:21 -0700 (Fri, 18 Aug 2006) | 1 line

do not include alloca.h under BSD; alloca is in stdlib.h
------------------------------------------------------------------------
r1220 | hafe | 2006-08-17 06:25:01 -0700 (Thu, 17 Aug 2006) | 1 line

AMF sync #2
------------------------------------------------------------------------
r1219 | fthomas | 2006-08-17 00:30:55 -0700 (Thu, 17 Aug 2006) | 1 line

add command line support with: launch as a foreground application, do not set priority
------------------------------------------------------------------------
r1214 | sdake | 2006-08-15 21:25:47 -0700 (Tue, 15 Aug 2006) | 4 lines

Add scalability to 128 nodes by adding new parameter to protocol which is
a random timeout bounded by a configuration parameter when sending join
messages.

------------------------------------------------------------------------
r1211 | sdake | 2006-08-15 18:21:52 -0700 (Tue, 15 Aug 2006) | 2 lines

Return ERR_TIMEOUT if timeout value is zero in saEvtChannelOpen

------------------------------------------------------------------------
r1208 | sdake | 2006-08-15 17:08:52 -0700 (Tue, 15 Aug 2006) | 2 lines

Fix make install to install clm shared object files properly.

------------------------------------------------------------------------
r1207 | sdake | 2006-08-15 17:05:02 -0700 (Tue, 15 Aug 2006) | 2 lines

Improve recovery code to produce correct printf notice outputs.

------------------------------------------------------------------------
r1206 | sdake | 2006-08-15 17:04:27 -0700 (Tue, 15 Aug 2006) | 2 lines

Fix debug output for testckpt service.

------------------------------------------------------------------------
r1200 | hafe | 2006-08-11 05:28:10 -0700 (Fri, 11 Aug 2006) | 19 lines

- New sync state machine, implemented and described in amf.c
- One AMF node reads the AMF config file (IMM style)
- One AMF node syncs others AMF nodes
- One AMF object is serialized and sent as one message
- Serialization/deserialization of most objects is trivial (memcpy)
except for component and csi-attributes objects which have variable size
arrays/strings.
- Depth first AMF object tree traversal preserves relations when syncing
- Ordered lists of SUs and SIs
- Constructors/destructor per class
- Serializers/deserializers per class
- Config-change changes sync state
- Sync callbacks executes the sync
- "Use case" tracing for sync using the SYNCTRACE macro (trace6)
- Sync master is initially the winner of a timeout race and if the
master leaves the cluster, the node with the lowest node ID becomes new master.
- amf_malloc implements an AMF central malloc routine with error handling.


------------------------------------------------------------------------
r1199 | pcaulfie | 2006-08-11 00:37:15 -0700 (Fri, 11 Aug 2006) | 3 lines

fixe a bug in cpg where get_group() will return the wrong group
info structure if there is a hash collision.

------------------------------------------------------------------------
r1178 | sdake | 2006-08-07 15:49:36 -0700 (Mon, 07 Aug 2006) | 2 lines

Fix checkpoint header file error

------------------------------------------------------------------------
r1177 | sdake | 2006-08-05 01:51:06 -0700 (Sat, 05 Aug 2006) | 2 lines

Committed a bunch of changes for testing scalability - reverting patch

------------------------------------------------------------------------
r1176 | sdake | 2006-08-04 19:23:40 -0700 (Fri, 04 Aug 2006) | 2 lines

non-blocking syslog and file logging support

------------------------------------------------------------------------
r1175 | sdake | 2006-08-04 19:22:12 -0700 (Fri, 04 Aug 2006) | 2 lines

Solaris port for openais

------------------------------------------------------------------------
r1174 | sdake | 2006-08-02 22:32:11 -0700 (Wed, 02 Aug 2006) | 2 lines

Make sure sync_activate is called only once per service handler.

------------------------------------------------------------------------
r1172 | hafe | 2006-08-02 01:24:58 -0700 (Wed, 02 Aug 2006) | 3 lines

Removes the hardcoded limit of environment variables and argvs from components, now unlimited.


------------------------------------------------------------------------
r1171 | hafe | 2006-07-31 22:56:30 -0700 (Mon, 31 Jul 2006) | 4 lines

- Handling of HUP and other poll errors improved in saAmfDispatch.
- Termination of testamf1 when saAmfDispatch returns an error.


------------------------------------------------------------------------
r1170 | sdake | 2006-07-28 16:34:28 -0700 (Fri, 28 Jul 2006) | 2 lines

Patch so realloc reverts to old buffer if reallocation fails.

------------------------------------------------------------------------
r1169 | sdake | 2006-07-28 16:33:57 -0700 (Fri, 28 Jul 2006) | 2 lines

Fix lock marshalling.

------------------------------------------------------------------------
r1168 | sdake | 2006-07-26 00:42:50 -0700 (Wed, 26 Jul 2006) | 2 lines

Endian conversion for evs service.

------------------------------------------------------------------------
r1167 | sdake | 2006-07-26 00:41:44 -0700 (Wed, 26 Jul 2006) | 2 lines

Endian cleanup for ykd.

------------------------------------------------------------------------
r1166 | sdake | 2006-07-26 00:39:53 -0700 (Wed, 26 Jul 2006) | 2 lines

Cleanup log_printf to use gnu attributes to do automatic type checking.

------------------------------------------------------------------------
r1165 | sdake | 2006-07-26 00:32:43 -0700 (Wed, 26 Jul 2006) | 2 lines

Endian conversion for the lock service.

------------------------------------------------------------------------
r1164 | sdake | 2006-07-26 00:21:08 -0700 (Wed, 26 Jul 2006) | 3 lines

Use memb_ring_id_copy for alignment purposes on 64 aligned arches and keep
the port id in host byte order until it is used in the totem protocol stack.

------------------------------------------------------------------------
r1163 | sdake | 2006-07-26 00:11:26 -0700 (Wed, 26 Jul 2006) | 2 lines

Add endian cleanup fixes.

------------------------------------------------------------------------
r1162 | sdake | 2006-07-26 00:07:22 -0700 (Wed, 26 Jul 2006) | 2 lines

Clean up endian swabbing for cpg service.

------------------------------------------------------------------------
r1161 | sdake | 2006-07-25 23:58:28 -0700 (Tue, 25 Jul 2006) | 2 lines

Fix where setsockopt is bound to in totemnet.

------------------------------------------------------------------------
r1160 | sdake | 2006-07-25 23:57:52 -0700 (Tue, 25 Jul 2006) | 2 lines

Cleanup comparisons in lcr_ifact and use strtok_r instead of junky parser.

------------------------------------------------------------------------
r1159 | sdake | 2006-07-25 23:55:10 -0700 (Tue, 25 Jul 2006) | 2 lines

Add errno.h include since it was removed from swab.h.

------------------------------------------------------------------------
r1158 | sdake | 2006-07-25 23:53:50 -0700 (Tue, 25 Jul 2006) | 2 lines

Remove bunch of unused includes from swab.h.

------------------------------------------------------------------------
r1157 | sdake | 2006-07-25 23:51:17 -0700 (Tue, 25 Jul 2006) | 2 lines

Fix processor count in evs interface.

------------------------------------------------------------------------
r1156 | sdake | 2006-07-25 23:50:22 -0700 (Tue, 25 Jul 2006) | 2 lines

Endian cleanup for the clm service.

------------------------------------------------------------------------
r1152 | sdake | 2006-07-23 18:34:17 -0700 (Sun, 23 Jul 2006) | 2 lines

Allow build type of COVERAGE for code coverage analysis

------------------------------------------------------------------------
r1151 | sdake | 2006-07-21 13:30:29 -0700 (Fri, 21 Jul 2006) | 2 lines

Ensure make install works with recent libcfg changes.

------------------------------------------------------------------------
r1150 | pcaulfie | 2006-07-21 05:22:05 -0700 (Fri, 21 Jul 2006) | 6 lines

Add a 'family' parameter to totemip_parse so it can be told to look for 
either IPv4 or IPv6 addresses, or both.

As we get the (unambiguous) multicast address first, we can make sure we always
look for the right type of node address afterwards.

------------------------------------------------------------------------
r1149 | sdake | 2006-07-21 02:01:12 -0700 (Fri, 21 Jul 2006) | 3 lines

Increase IPC thread stack size from 100k to 200k to accomodate larger data
structures in ipc message handlers (for the CLM service).

------------------------------------------------------------------------
r1148 | sdake | 2006-07-20 20:30:40 -0700 (Thu, 20 Jul 2006) | 2 lines

Remove TODO for swabbing conn data structure

------------------------------------------------------------------------
r1147 | sdake | 2006-07-20 20:26:22 -0700 (Thu, 20 Jul 2006) | 2 lines

Validate IO Vector elements in a saCkptCheckpointWrite operation

------------------------------------------------------------------------
r1146 | sdake | 2006-07-20 20:18:03 -0700 (Thu, 20 Jul 2006) | 2 lines

Remove TODO comment that has long been fixed in the code.

------------------------------------------------------------------------
r1145 | sdake | 2006-07-20 20:07:14 -0700 (Thu, 20 Jul 2006) | 3 lines

Correct malloc of checkpoint iteration size from 500 bytes to max section id
size bytes for the created checkpoint

------------------------------------------------------------------------
r1144 | sdake | 2006-07-20 19:39:21 -0700 (Thu, 20 Jul 2006) | 3 lines

Reduce memory usage in large configurations by dynamically allocating
fragmentation assembly buffer.

------------------------------------------------------------------------
r1143 | sdake | 2006-07-20 19:33:13 -0700 (Thu, 20 Jul 2006) | 2 lines

Remove marshall TODO items as they are not needed

------------------------------------------------------------------------
r1142 | sdake | 2006-07-20 15:39:22 -0700 (Thu, 20 Jul 2006) | 2 lines

Remove unnecessary exit from testevs

------------------------------------------------------------------------
r1141 | sdake | 2006-07-20 03:01:57 -0700 (Thu, 20 Jul 2006) | 2 lines

Remove debug printf in totemsrp

------------------------------------------------------------------------
r1140 | sdake | 2006-07-19 21:51:32 -0700 (Wed, 19 Jul 2006) | 2 lines

Don't segfault if unauthorized user connects

------------------------------------------------------------------------
r1139 | sdake | 2006-07-19 21:50:15 -0700 (Wed, 19 Jul 2006) | 3 lines

Make checkpoint service work according to specifications with regards to the
unlink operation.

------------------------------------------------------------------------
r1138 | sdake | 2006-07-19 12:33:20 -0700 (Wed, 19 Jul 2006) | 2 lines

Remove compile warning from cfgtool commit.

------------------------------------------------------------------------
r1137 | sdake | 2006-07-19 12:31:01 -0700 (Wed, 19 Jul 2006) | 3 lines

Add support for reenabling a failed redundant ring and printing ring status
through the test/opeanis-cfgtool application.

------------------------------------------------------------------------
r1136 | pcaulfie | 2006-07-19 08:32:25 -0700 (Wed, 19 Jul 2006) | 3 lines

Send the new joinlists using the sync service, so it happens atomically.
This should fix some odd sequencing bugs.

------------------------------------------------------------------------
r1135 | pcaulfie | 2006-07-17 23:33:39 -0700 (Mon, 17 Jul 2006) | 3 lines

printing ipv6 addresses often needs more than a 32 byte buffer. THis could
causes a crash with sone ipv6 installations.

------------------------------------------------------------------------
r1133 | sdake | 2006-07-17 15:36:13 -0700 (Mon, 17 Jul 2006) | 2 lines

Support for ia64 arch builds.

------------------------------------------------------------------------
r1132 | sdake | 2006-07-17 14:52:55 -0700 (Mon, 17 Jul 2006) | 2 lines

Fix synchronization not working properly.

------------------------------------------------------------------------
r1131 | sdake | 2006-07-17 13:16:14 -0700 (Mon, 17 Jul 2006) | 2 lines

Event marshalling patch for 32/64/endian support.

------------------------------------------------------------------------
r1130 | sdake | 2006-07-16 23:18:19 -0700 (Sun, 16 Jul 2006) | 2 lines

If version field is NULL as passed to saClmInitialize, return INVALID_PARAM

------------------------------------------------------------------------
r1129 | sdake | 2006-07-16 23:17:47 -0700 (Sun, 16 Jul 2006) | 3 lines

If TRACK_CURRENT is specified in CLM service and notify buffer is null,
return tracking data in callback as per specification.

------------------------------------------------------------------------
r1128 | sdake | 2006-07-16 23:15:47 -0700 (Sun, 16 Jul 2006) | 2 lines

Remove debug printf in track stop operation

------------------------------------------------------------------------
r1127 | sdake | 2006-07-16 23:14:33 -0700 (Sun, 16 Jul 2006) | 2 lines

Check for invalid handles first in API calls.

------------------------------------------------------------------------
r1126 | sdake | 2006-07-16 23:12:11 -0700 (Sun, 16 Jul 2006) | 2 lines

If the max section size is less then the read size, return INVALID_PARAM.

------------------------------------------------------------------------
r1125 | sdake | 2006-07-16 19:20:37 -0700 (Sun, 16 Jul 2006) | 2 lines

Return INVALID_PARAM when section read is larger then checkpoint section

------------------------------------------------------------------------
r1124 | sdake | 2006-07-16 14:58:35 -0700 (Sun, 16 Jul 2006) | 2 lines

CheckpointRead wasn't checking the active replica was set.

------------------------------------------------------------------------
r1123 | sdake | 2006-07-16 14:50:39 -0700 (Sun, 16 Jul 2006) | 3 lines

The creation attributes set bit wasn't set from the library to executive
message handlers causing significant problems with open was called from a app.

------------------------------------------------------------------------
r1122 | sdake | 2006-07-16 14:49:36 -0700 (Sun, 16 Jul 2006) | 2 lines

The open flags are used before they are verified to be valid.

------------------------------------------------------------------------
r1121 | sdake | 2006-07-14 14:09:57 -0700 (Fri, 14 Jul 2006) | 2 lines

Proper barrier operation as requested.

------------------------------------------------------------------------
r1120 | sdake | 2006-07-13 15:02:47 -0700 (Thu, 13 Jul 2006) | 2 lines

Add support for s390 and s390x architectures.

------------------------------------------------------------------------
r1119 | sdake | 2006-07-13 14:57:35 -0700 (Thu, 13 Jul 2006) | 2 lines

Fix library renames to 2.0.0 as needed by distros.

------------------------------------------------------------------------
r1118 | sdake | 2006-07-11 16:41:56 -0700 (Tue, 11 Jul 2006) | 2 lines

Update to checkpoint service to use new APIs as rest of services do.

------------------------------------------------------------------------
r1117 | sdake | 2006-07-10 16:51:43 -0700 (Mon, 10 Jul 2006) | 2 lines

Fix broken timers when release type set to RELEASE

------------------------------------------------------------------------
r1116 | sdake | 2006-07-10 15:22:21 -0700 (Mon, 10 Jul 2006) | 2 lines

Remove dead definition of struct queue

------------------------------------------------------------------------
r1115 | sdake | 2006-07-10 15:19:46 -0700 (Mon, 10 Jul 2006) | 2 lines

Missing commit from previous rename of saServiceConnectTwo

------------------------------------------------------------------------
r1114 | sdake | 2006-07-10 15:18:32 -0700 (Mon, 10 Jul 2006) | 2 lines

Rename saConnectServiceTwo to saConnectService

------------------------------------------------------------------------
r1113 | sdake | 2006-07-10 15:12:49 -0700 (Mon, 10 Jul 2006) | 2 lines

Fix typo in saMsg.h header file.

------------------------------------------------------------------------
r1112 | sdake | 2006-07-10 15:11:43 -0700 (Mon, 10 Jul 2006) | 2 lines

Rev versions to 2.0 and update versions script for all services

------------------------------------------------------------------------
r1111 | sdake | 2006-07-07 12:44:11 -0700 (Fri, 07 Jul 2006) | 3 lines

The member list, joined list, and left list in configuration changes
was not valid.

------------------------------------------------------------------------
r1110 | fthomas | 2006-07-07 09:35:21 -0700 (Fri, 07 Jul 2006) | 1 line

remove commited conflict
------------------------------------------------------------------------
r1109 | pcaulfie | 2006-07-07 02:36:03 -0700 (Fri, 07 Jul 2006) | 2 lines

testcpg -i shows node ids as IP addresses.

------------------------------------------------------------------------
r1108 | hafe | 2006-07-07 01:04:01 -0700 (Fri, 07 Jul 2006) | 14 lines

- Error escalation improved, SU failover recovery action added
- Most runtime attributes in the inf. model calculated in runtime from
  more fundamental information. (improves consistency)
- sg_assign_si can now recalculate workloads considering existing
  assignments
- Logging improvements, similar to what is required as notification in
  AMF spec.
- CLC-CLI INSTANTIATE now exits aisexec when it fails (should later be
  sent as an NTF alarm)
- CLC-CLI CLEANUP correctly handles already terminated processes
- testamf1.c printouts removed for normal operation
- Iterator functions for SI/CSI assignments 


------------------------------------------------------------------------
r1105 | sdake | 2006-07-06 18:34:55 -0700 (Thu, 06 Jul 2006) | 2 lines

Make sure RELEASE version detaches from tty

------------------------------------------------------------------------
r1103 | sdake | 2006-07-06 15:34:14 -0700 (Thu, 06 Jul 2006) | 3 lines

The testcpg tool now prints IP addresses instead of a hex value indicating the
node id.

------------------------------------------------------------------------
r1102 | sdake | 2006-07-06 15:33:41 -0700 (Thu, 06 Jul 2006) | 3 lines

The recent endian/32/64 changes broke cpg callbacks.  The left list address
was incorrectly calculated.

------------------------------------------------------------------------
r1101 | sdake | 2006-07-06 14:08:48 -0700 (Thu, 06 Jul 2006) | 2 lines

The totem rrp incorrectly increased the wrong failure counter.

------------------------------------------------------------------------
r1100 | sdake | 2006-06-30 12:21:30 -0700 (Fri, 30 Jun 2006) | 2 lines

marshall of cpg_join name field is wrong.

------------------------------------------------------------------------
r1099 | sdake | 2006-06-29 15:03:08 -0700 (Thu, 29 Jun 2006) | 2 lines

Rework of the timer system to allow timers to be added in dispatch handlers.

------------------------------------------------------------------------
r1098 | sdake | 2006-06-29 14:41:51 -0700 (Thu, 29 Jun 2006) | 2 lines

Rewrite of the checkpoint benchmark using threads tool

------------------------------------------------------------------------
r1097 | sdake | 2006-06-28 21:05:47 -0700 (Wed, 28 Jun 2006) | 2 lines

set serialize lock to proper function.

------------------------------------------------------------------------
r1096 | sdake | 2006-06-28 17:01:10 -0700 (Wed, 28 Jun 2006) | 2 lines

Rework of IPC layer once again

------------------------------------------------------------------------
r1095 | sdake | 2006-06-27 16:42:38 -0700 (Tue, 27 Jun 2006) | 4 lines

Fix problem where AMF locks up system if two or more components are members
of the same service unit.  Also fixes problem where AMF asserts if two or
more components are specified in a service unit.

------------------------------------------------------------------------
r1094 | sdake | 2006-06-27 16:37:06 -0700 (Tue, 27 Jun 2006) | 2 lines

Fix 32/64 endian for all services from a previous missed commit.

------------------------------------------------------------------------
r1092 | sdake | 2006-06-27 16:31:21 -0700 (Tue, 27 Jun 2006) | 3 lines

Fix double free problem in ipc by reworking libais_disconnect to match previous
rewritten model in picacho.

------------------------------------------------------------------------
r1091 | hafe | 2006-06-27 01:49:07 -0700 (Tue, 27 Jun 2006) | 7 lines

AMF changes:
- Revised cluster start 
- Includes Steven's "amf invalid write patch"
- Includes "components not started with 0.76" patch
- New timer API use backed out of AMF (temporary)


------------------------------------------------------------------------
r1090 | sdake | 2006-06-26 14:02:00 -0700 (Mon, 26 Jun 2006) | 2 lines

Finally remove all references to ais_amf.h and replace with saAmf.h.

------------------------------------------------------------------------
r1089 | sdake | 2006-06-26 13:30:44 -0700 (Mon, 26 Jun 2006) | 3 lines

Corrected timer deadlock that occurs when a timer add or delete operation
occurs within a timer expiration event.

------------------------------------------------------------------------
r1088 | sdake | 2006-06-26 13:30:15 -0700 (Mon, 26 Jun 2006) | 2 lines

Removed ais_amf.h and instead point all refs to saAmf.h

------------------------------------------------------------------------
r1087 | sdake | 2006-06-25 13:29:14 -0700 (Sun, 25 Jun 2006) | 2 lines

Remove dead file

------------------------------------------------------------------------
r1086 | sdake | 2006-06-23 13:49:19 -0700 (Fri, 23 Jun 2006) | 2 lines

Missed commit of marshall file for some reason.

------------------------------------------------------------------------
r1085 | sdake | 2006-06-23 11:38:25 -0700 (Fri, 23 Jun 2006) | 2 lines

Make cpg 32/64 userland safe and endian safe.

------------------------------------------------------------------------
r1084 | pcaulfie | 2006-06-22 09:07:30 -0700 (Thu, 22 Jun 2006) | 3 lines

Fix message alignment in CPG.
we now unpack the message in the same way as we pack it.

------------------------------------------------------------------------
r1081 | sdake | 2006-06-21 16:32:46 -0700 (Wed, 21 Jun 2006) | 2 lines

Change makefile to install swab from correct place

------------------------------------------------------------------------
r1077 | sdake | 2006-06-21 16:03:11 -0700 (Wed, 21 Jun 2006) | 2 lines

New make release in top level makefile

------------------------------------------------------------------------
r1076 | sdake | 2006-06-21 14:32:03 -0700 (Wed, 21 Jun 2006) | 2 lines

Modify AMF to use new timer.c/timer.h routines properly

------------------------------------------------------------------------
r1074 | sdake | 2006-06-21 14:15:16 -0700 (Wed, 21 Jun 2006) | 2 lines

32/64/mixed endian support for checkpoint service.

------------------------------------------------------------------------
r1073 | sdake | 2006-06-21 14:13:34 -0700 (Wed, 21 Jun 2006) | 2 lines

Fix for early logging from Hans.

------------------------------------------------------------------------
r1072 | sdake | 2006-06-21 14:10:05 -0700 (Wed, 21 Jun 2006) | 2 lines

Fix error where pathlist buffer is overrun resulting in segfault

------------------------------------------------------------------------
r1071 | hafe | 2006-06-19 23:45:16 -0700 (Mon, 19 Jun 2006) | 10 lines

Refactoring of AMF into several files (based on classed in inf.
model). A central header file (amf.h) keeps all the definitions and
prototypes needed.

New things apart from that:
- some doxygen html generated from AMF e.g. each file has a description
- saAmfHAStateGet() now works
- component invoked healthchecks implemented (but not tested)


------------------------------------------------------------------------
r1070 | sdake | 2006-06-19 15:59:32 -0700 (Mon, 19 Jun 2006) | 2 lines

Fix off by one error in totemsrp.

------------------------------------------------------------------------
r1069 | sdake | 2006-06-19 03:51:41 -0700 (Mon, 19 Jun 2006) | 2 lines

Missed timer commit.

------------------------------------------------------------------------
r1068 | sdake | 2006-06-19 03:50:34 -0700 (Mon, 19 Jun 2006) | 2 lines

missed commit

------------------------------------------------------------------------
r1067 | sdake | 2006-06-16 12:51:55 -0700 (Fri, 16 Jun 2006) | 2 lines

deferred timer system so that timers may be deferred during synchronization.

------------------------------------------------------------------------
r1066 | sdake | 2006-06-16 12:16:22 -0700 (Fri, 16 Jun 2006) | 3 lines

Fix dependencies and install all header files for external service handlers.
New defination required to build external service handlers.

------------------------------------------------------------------------
r1065 | sdake | 2006-06-16 12:07:28 -0700 (Fri, 16 Jun 2006) | 3 lines

Allow CFLAGS and LDFLAGS to be overridden through the environment or command
line.

------------------------------------------------------------------------
r1061 | sdake | 2006-06-05 15:39:07 -0700 (Mon, 05 Jun 2006) | 2 lines

Remove warnings in AMF executive service.

------------------------------------------------------------------------
r1060 | sdake | 2006-06-05 15:18:09 -0700 (Mon, 05 Jun 2006) | 2 lines

Update TODO file with cluster membership 32/64/endian work being completed.

------------------------------------------------------------------------
r1059 | sdake | 2006-06-05 15:14:46 -0700 (Mon, 05 Jun 2006) | 2 lines

32/64/endian everything should work now for openais clm service.

------------------------------------------------------------------------
r1058 | hafe | 2006-05-31 06:20:43 -0700 (Wed, 31 May 2006) | 16 lines

- (Re-)introduction of event based multicast messages (not all yet)
- Use of Distinguished Names (DN) in API and multicast messages
- CSI resassignment properly handled (by using restarting state)
- State 'setter' functions with uniform printouts
- Simple 'assign SU to host' algorithm:
	- based on saAmfSUHostedByNode config attribute
	- see config file for example
- Debug print runtime attributes upon user request:
	$ pkill -USR2 aisexec
- Object-oriented naming of functions started (but not finished)
- testamf1.c updated with some new tests
- Minor fix in print.h and print.c
- AMF can be started on two nodes (example config file needs
  modification for this) 


------------------------------------------------------------------------
r1057 | sdake | 2006-05-28 15:14:44 -0700 (Sun, 28 May 2006) | 2 lines

Set to SCHED_RR:1 to match ipc layer

------------------------------------------------------------------------
r1056 | sdake | 2006-05-28 15:13:52 -0700 (Sun, 28 May 2006) | 2 lines

sched_setscheduler was passing wrong argument

------------------------------------------------------------------------
r1055 | sdake | 2006-05-27 00:17:24 -0700 (Sat, 27 May 2006) | 2 lines

Update TODO to match 2006 project priorities.

------------------------------------------------------------------------
r1054 | sdake | 2006-05-26 19:19:09 -0700 (Fri, 26 May 2006) | 8 lines

This sanitizes the makefiles in several ways
* .so and .so.1 files are linked to library.so.1.0.0 and installed with
make install
* renames all build targets to library.so.1.0.0 from library.so.1.0
* puts ld.so.conf.d files in the correct place
* allows not installing static libraries by using make install
STATICLIBS=NO

------------------------------------------------------------------------
r1053 | sdake | 2006-05-26 19:18:11 -0700 (Fri, 26 May 2006) | 6 lines

This patch checks the result of read operations on a socket which can
return errors or 0.  Now if those cases happen, the operation is
ignored.  This part of the code needs more attention later to handle
short reads.  This removes a warning when fortify source is defined to
the compiler.

------------------------------------------------------------------------
r1052 | sdake | 2006-05-26 19:17:33 -0700 (Fri, 26 May 2006) | 7 lines

This patch does the following things:
* changes the default search path for lcrso files to /usr/libexec/lcrso
* checks the result of getcwd which can fail and return an error - in
that case handle the error appropriately
* changes a comment that was incorrectly stating only the cwd was being
searched for lcrso files

------------------------------------------------------------------------
r1051 | sdake | 2006-05-26 19:16:21 -0700 (Fri, 26 May 2006) | 5 lines

Under load, it was observed that the token could be lost because the
totem protocol was not being scheduled above the other I/O processes.
This patch reinstalls the sched_setscheduler call which for some reason
was commented out.

------------------------------------------------------------------------
r1050 | sdake | 2006-05-26 12:41:01 -0700 (Fri, 26 May 2006) | 4 lines

defect 1270
Fix checkpoint read operation which would return invalid operation in some
circumstances.

------------------------------------------------------------------------
r1049 | sdake | 2006-05-25 23:46:24 -0700 (Thu, 25 May 2006) | 3 lines

Remove scandir error=%s printf since it spews a bunch of errors when the
aisexec is run after a make install

------------------------------------------------------------------------
r1048 | sdake | 2006-05-25 23:15:33 -0700 (Thu, 25 May 2006) | 2 lines

sanitize make install in Makefile

------------------------------------------------------------------------
r1047 | sdake | 2006-05-25 21:22:55 -0700 (Thu, 25 May 2006) | 2 lines

Fix segfault if rrp_mode: MODE isn't set in configuration file.

------------------------------------------------------------------------
r1046 | sdake | 2006-05-25 21:19:40 -0700 (Thu, 25 May 2006) | 3 lines

Remove warning about memb_set_print not being used.  This is only useful for
debugging.

------------------------------------------------------------------------
r1045 | sdake | 2006-05-25 21:08:18 -0700 (Thu, 25 May 2006) | 4 lines

Remove deliver_fn which is not the ipc delivery function handler but the
executive multicasted messages delivery function.  This was inadvertantly copied
and pasted from main.c

------------------------------------------------------------------------
r1044 | sdake | 2006-05-25 19:31:49 -0700 (Thu, 25 May 2006) | 2 lines

Properly process the ld.so.conf file if it has includes.

------------------------------------------------------------------------
r1043 | sdake | 2006-05-25 19:31:04 -0700 (Thu, 25 May 2006) | 2 lines

Remove warning about unsigned/signed passed to strcpy

------------------------------------------------------------------------
r1042 | sdake | 2006-05-25 19:25:20 -0700 (Thu, 25 May 2006) | 2 lines

Modified initscript to not start by default on redhat systems

------------------------------------------------------------------------
r1041 | sdake | 2006-05-25 19:21:03 -0700 (Thu, 25 May 2006) | 2 lines

Return unsigned char as needed by gcc 4.1

------------------------------------------------------------------------
r1040 | sdake | 2006-05-25 19:09:48 -0700 (Thu, 25 May 2006) | 3 lines

code analysis found a memset overwrote a data structure.


------------------------------------------------------------------------
r1039 | pcaulfie | 2006-05-25 00:33:12 -0700 (Thu, 25 May 2006) | 2 lines

Add missing endian conversion to memb_merge_detect

------------------------------------------------------------------------
r1038 | pcaulfie | 2006-05-23 01:43:02 -0700 (Tue, 23 May 2006) | 3 lines

Remove poinless man-page.
bug fix CPG example.

------------------------------------------------------------------------
r1035 | sdake | 2006-05-21 16:11:42 -0700 (Sun, 21 May 2006) | 4 lines

commit for redundant ring take 4 was only done from exec directory missing all
of the commits for the rest of the directories.  This commit will now allow the
tree to compile.

------------------------------------------------------------------------
r1034 | sdake | 2006-05-21 16:01:34 -0700 (Sun, 21 May 2006) | 2 lines

First take at doxygen support for openais APIs.

------------------------------------------------------------------------
r1033 | sdake | 2006-05-19 13:31:35 -0700 (Fri, 19 May 2006) | 3 lines

Endian fixes for the recent redundant ring protocol work plus the cluster
membership API support.

------------------------------------------------------------------------
r1032 | sdake | 2006-05-19 12:49:40 -0700 (Fri, 19 May 2006) | 4 lines

The redundant ring take 4 patch.  This includes modes for active, passive,
and none.  Read openais.conf.5 for information regarding how to configure
redundant ring.

------------------------------------------------------------------------
r1031 | sdake | 2006-05-19 12:40:40 -0700 (Fri, 19 May 2006) | 3 lines

Patch to allow system to work if no ld.so.conf is present.  ld.so.conf is
optional and may not be present on a system.

------------------------------------------------------------------------
r1030 | pcaulfie | 2006-05-19 00:38:30 -0700 (Fri, 19 May 2006) | 2 lines

Don't crash if we get an unathenticated connection from a library.

------------------------------------------------------------------------
r1029 | pcaulfie | 2006-05-19 00:36:49 -0700 (Fri, 19 May 2006) | 2 lines

Allow the syslog facility type to be set in the configuration file.

------------------------------------------------------------------------
r1028 | pcaulfie | 2006-05-17 05:54:37 -0700 (Wed, 17 May 2006) | 2 lines

Move CPG_SERVICE into service_types where it belongs.

------------------------------------------------------------------------
r1027 | pcaulfie | 2006-05-17 00:34:09 -0700 (Wed, 17 May 2006) | 2 lines

Close ld.so.conf file descriptor when finished with it.

------------------------------------------------------------------------
r1026 | hafe | 2006-05-17 00:22:43 -0700 (Wed, 17 May 2006) | 16 lines

Introduction of SA Forum information model for AMF as specified in
SAI-Overview-B.02.01.pdf. Other AMF changes as specified in
SAI-AIS-AMF-B.02.01.

Summary:

- SA Forum B.02 Information model for AMF
- groups.conf renamed to amf.conf
- amf.conf syntax changed heavily to follow SA Forum specs.
- AMF works when daemon.
- linux lists removed from AMF
- component cmd environment variables support
- component argv support
- multi value csi attributes


------------------------------------------------------------------------
r1025 | pcaulfie | 2006-05-15 06:38:25 -0700 (Mon, 15 May 2006) | 7 lines

getaddrinfo() doesn't actually set errno, it has its own error variable, so 
returning -errno is not useful (it may be zero even if getaddrinfo failed).

So, simply return -1 if getaddrinfo fails, to indicate a name resolution
or badly formed address.


------------------------------------------------------------------------
r1024 | sdake | 2006-05-10 17:40:06 -0700 (Wed, 10 May 2006) | 4 lines

Environment variable cleanup, documentation of environment variables in
man pages, and rename of one of the environment variables used to specify
the main openais configuration file.

------------------------------------------------------------------------
r1023 | fthomas | 2006-05-10 05:43:17 -0700 (Wed, 10 May 2006) | 1 line

fix compile under darwin: sched_setscheduler does not exist
------------------------------------------------------------------------
r1022 | hafe | 2006-05-09 23:20:00 -0700 (Tue, 09 May 2006) | 12 lines

- Preprocessor flags to control user, group and directory for
configuration files removed.

- Environment variables for the same thing added:
	OPENAIS_AISPARSER_FILE
	OPENAIS_AMF_CONFIG_FILE
	OPENAIS_TOTEM_AUTHKEY_FILE

- Make depend target in exec makefile updated with missing source files.



------------------------------------------------------------------------
r1021 | hafe | 2006-05-03 01:45:44 -0700 (Wed, 03 May 2006) | 8 lines

- printouts buffered before log_setup() has been called, flushed at early exit.
- rests of old logging removed from all code (#define LOG_SERVICE...).
- line feed added if not in message.
- new trace() function added so that trace macros adds minimum of code and runtime penalties to user code.
- ENTER_ARGS macro changed to ENTER. ENTER macro now requires arguments.
- openais.conf.5 man page updated with logger directives.


------------------------------------------------------------------------
r1020 | pcaulfie | 2006-05-02 07:49:23 -0700 (Tue, 02 May 2006) | 3 lines

Cope with >32 groups on a node that goes down.
Add a missing endian conversion.

------------------------------------------------------------------------
r1019 | sdake | 2006-04-29 21:57:22 -0700 (Sat, 29 Apr 2006) | 2 lines

Fix comile failures for BSD/Darwin port

------------------------------------------------------------------------
r1018 | sdake | 2006-04-29 21:52:21 -0700 (Sat, 29 Apr 2006) | 2 lines

add vsf none option for those that don't want a virtual synchrony filter

------------------------------------------------------------------------
r1017 | sdake | 2006-04-28 10:57:04 -0700 (Fri, 28 Apr 2006) | 2 lines

Fix up mutexes to avoid deadlocks

------------------------------------------------------------------------
r1016 | pcaulfie | 2006-04-28 01:55:33 -0700 (Fri, 28 Apr 2006) | 6 lines

A misplaced close brace, caused cpg to only return the first node in the
list went several went down.

Also, replaced totemip_equal() calls with nodeid comparisons as CPG works
entirely on nodeIDs anyway.

------------------------------------------------------------------------
r1015 | sdake | 2006-04-27 13:41:22 -0700 (Thu, 27 Apr 2006) | 2 lines

Remove prio commented out code

------------------------------------------------------------------------
r1014 | sdake | 2006-04-27 13:18:44 -0700 (Thu, 27 Apr 2006) | 2 lines

Add invalid handle definition

------------------------------------------------------------------------
r1013 | sdake | 2006-04-26 18:46:36 -0700 (Wed, 26 Apr 2006) | 3 lines

Remove priority from aispoll since we now use the kernel scheduler for
priorities for polling

------------------------------------------------------------------------
r1012 | sdake | 2006-04-26 18:43:28 -0700 (Wed, 26 Apr 2006) | 2 lines

Add IPC files from missing previous commit

------------------------------------------------------------------------
r1011 | sdake | 2006-04-26 18:39:10 -0700 (Wed, 26 Apr 2006) | 2 lines

This patch reworks IPC to use threads instead of the main poll loop

------------------------------------------------------------------------
r1010 | sdake | 2006-04-26 15:24:30 -0700 (Wed, 26 Apr 2006) | 4 lines

Fix segfault because list was not reinitialized after its entry was deleted
and it would later be deleted by closing the ipc.
the 

------------------------------------------------------------------------
r1009 | hafe | 2006-04-26 02:00:41 -0700 (Wed, 26 Apr 2006) | 1 line

test commit, one line amf.c change in clc_cli_cleanup
------------------------------------------------------------------------
r1008 | fthomas | 2006-04-25 00:28:20 -0700 (Tue, 25 Apr 2006) | 1 line

Remove warnings under Darwin
------------------------------------------------------------------------
r1007 | sdake | 2006-04-25 00:11:25 -0700 (Tue, 25 Apr 2006) | 2 lines

Fix scanning of LCRSOs not working on various systems

------------------------------------------------------------------------
r1006 | sdake | 2006-04-25 00:04:09 -0700 (Tue, 25 Apr 2006) | 3 lines

Patch to ensure backlogs are never negative which would cause problems with
the flow control algorithm and protocol in general.

------------------------------------------------------------------------
r1005 | sdake | 2006-04-25 00:03:09 -0700 (Tue, 25 Apr 2006) | 2 lines

Allow running with BUILD_DYNAMIC set to zero.

------------------------------------------------------------------------
r1002 | sdake | 2006-04-24 12:05:59 -0700 (Mon, 24 Apr 2006) | 3 lines

Patch from Hans to clean up some error handling in main.c when service handlers
do the wrong thing.

------------------------------------------------------------------------
r1001 | sdake | 2006-04-24 12:00:26 -0700 (Mon, 24 Apr 2006) | 2 lines

Patch from Hans to clean up main error handling a little bit

------------------------------------------------------------------------
r1000 | sdake | 2006-04-24 11:58:36 -0700 (Mon, 24 Apr 2006) | 2 lines

Clean out private key memory area in case of parser override is used

------------------------------------------------------------------------
r999 | sdake | 2006-04-24 11:56:02 -0700 (Mon, 24 Apr 2006) | 2 lines

Patch from Hans to fix segfault in loading of LCR components

------------------------------------------------------------------------
r998 | sdake | 2006-04-20 16:17:16 -0700 (Thu, 20 Apr 2006) | 2 lines

More make install work to install all necessary files

------------------------------------------------------------------------
r997 | markh | 2006-04-20 10:14:38 -0700 (Thu, 20 Apr 2006) | 2 lines

Updated copyright dates.

------------------------------------------------------------------------
r996 | sdake | 2006-04-19 13:39:25 -0700 (Wed, 19 Apr 2006) | 3 lines

Make install now works along with different search paths for openais's
lcrsos.

------------------------------------------------------------------------
r995 | sdake | 2006-04-18 12:53:18 -0700 (Tue, 18 Apr 2006) | 3 lines

Patch from Hans to significantly improve the logging functionality
read openais.conf.5 for info on how the new logging works.

------------------------------------------------------------------------
r994 | sdake | 2006-04-15 19:05:27 -0700 (Sat, 15 Apr 2006) | 2 lines

Remove segfault when object database can't be loaded

------------------------------------------------------------------------
r993 | sdake | 2006-04-15 19:03:45 -0700 (Sat, 15 Apr 2006) | 2 lines

Remove segfaults when object database can't be loaded for some reason.

------------------------------------------------------------------------
r992 | sdake | 2006-04-15 01:28:28 -0700 (Sat, 15 Apr 2006) | 2 lines

remove -DDEBUG from release build

------------------------------------------------------------------------
r991 | sdake | 2006-04-15 01:27:48 -0700 (Sat, 15 Apr 2006) | 3 lines

defect 1201
cleanup poll_dispatch_delete in trunk

------------------------------------------------------------------------
r990 | sdake | 2006-04-15 01:04:21 -0700 (Sat, 15 Apr 2006) | 3 lines

remove warnings form totemrrp and also fix bug where send_flush wasn't
being called for the active replication algorithm

------------------------------------------------------------------------
r989 | sdake | 2006-04-15 00:52:28 -0700 (Sat, 15 Apr 2006) | 2 lines

remove printf on evs join because groups may be binary data and crash executive

------------------------------------------------------------------------
r988 | sdake | 2006-04-15 00:42:30 -0700 (Sat, 15 Apr 2006) | 2 lines

Fix warning about unsigned int passed to orf_token_rtr for flow control count

------------------------------------------------------------------------
r987 | sdake | 2006-04-15 00:41:45 -0700 (Sat, 15 Apr 2006) | 2 lines

Fix warning regarding unsigned int for node_id

------------------------------------------------------------------------
r986 | sdake | 2006-04-15 00:38:25 -0700 (Sat, 15 Apr 2006) | 2 lines

Fix object_priv_get to actually call object_priv_get instead of object_priv_set

------------------------------------------------------------------------
r985 | sdake | 2006-04-15 00:29:57 -0700 (Sat, 15 Apr 2006) | 3 lines

cleanup warning in service.c because unsigned char * is passed to atoi instead
of char *

------------------------------------------------------------------------
r984 | sdake | 2006-04-15 00:28:11 -0700 (Sat, 15 Apr 2006) | 2 lines

Add missing vsf.h from previous commit 

------------------------------------------------------------------------
r983 | sdake | 2006-04-13 16:20:03 -0700 (Thu, 13 Apr 2006) | 3 lines

fix fc5 segfault correctly by removing code that violates strict aliasing
rules.

------------------------------------------------------------------------
r982 | sdake | 2006-04-13 16:11:07 -0700 (Thu, 13 Apr 2006) | 3 lines

scale part 3
componentize YKD dynamic linear voting algorithm

------------------------------------------------------------------------
r981 | sdake | 2006-04-12 22:39:51 -0700 (Wed, 12 Apr 2006) | 3 lines

Improvement of the rrp_algo data structure to support only running totemnet
api calls on the appropriate totemnet interfaces.

------------------------------------------------------------------------
r980 | sdake | 2006-04-12 19:51:39 -0700 (Wed, 12 Apr 2006) | 3 lines

Workaround possible optimizer bug in gcc 4.1 by forcing a function not to
inline.  This would cause segfaults on fc4.

------------------------------------------------------------------------
r979 | sdake | 2006-04-12 19:50:51 -0700 (Wed, 12 Apr 2006) | 2 lines

move nodeid from interface section to totem section

------------------------------------------------------------------------
r978 | pcaulfie | 2006-04-10 02:40:30 -0700 (Mon, 10 Apr 2006) | 3 lines

- Fix BUILD_DYNAMIC=0 (add amfconfig.o to SERV_OBJS)
- add objdb->object_find_reset() before looking for user/group names.

------------------------------------------------------------------------
r977 | pcaulfie | 2006-04-10 01:24:34 -0700 (Mon, 10 Apr 2006) | 2 lines

Split the logging config options into three keys: to_file, to_stderr & to_syslog

------------------------------------------------------------------------
r976 | sdake | 2006-04-08 16:14:52 -0700 (Sat, 08 Apr 2006) | 3 lines

defect 1191
Add more support for the redundant ring protocol.

------------------------------------------------------------------------
r975 | sdake | 2006-04-08 15:25:14 -0700 (Sat, 08 Apr 2006) | 4 lines

defect 1190
scale to 128 nodes more effectively by dynamically sending partial structures
in the commit token ahd memb_join messages.

------------------------------------------------------------------------
r972 | sdake | 2006-04-08 15:05:51 -0700 (Sat, 08 Apr 2006) | 3 lines

defect 1139
reorg of code to better support creating external service handlers

------------------------------------------------------------------------
r971 | sdake | 2006-04-08 15:05:00 -0700 (Sat, 08 Apr 2006) | 3 lines

defect 1170
another fix for the assertion in memb_recovery_enter

------------------------------------------------------------------------
r970 | pcaulfie | 2006-04-07 08:05:24 -0700 (Fri, 07 Apr 2006) | 4 lines

Use the tmp variable in the right iterator loop !
With debug enabled, that's a guaranteed crash in cpg when a node leaves.


------------------------------------------------------------------------
r969 | pcaulfie | 2006-04-06 03:31:28 -0700 (Thu, 06 Apr 2006) | 9 lines

Use objdb for configuration. All components now get a reference to
the objdb rather than openais_config.

The default config object "aisparser" reads openais.conf as before, but can
be overridden by an environment variable.

Bug 1132


------------------------------------------------------------------------
r968 | sdake | 2006-04-06 00:37:08 -0700 (Thu, 06 Apr 2006) | 3 lines

defect 1170
remove extra debug exit(1

------------------------------------------------------------------------
r967 | sdake | 2006-04-06 00:32:21 -0700 (Thu, 06 Apr 2006) | 3 lines

defect 1170
Fix recovery protocol to avoid assertion in memb_state_recovery_enter

------------------------------------------------------------------------
r966 | sdake | 2006-04-03 15:45:13 -0700 (Mon, 03 Apr 2006) | 3 lines

defect 205
implement totem single ring protocol flow control algorithm

------------------------------------------------------------------------
r965 | pcaulfie | 2006-04-03 01:47:42 -0700 (Mon, 03 Apr 2006) | 2 lines

Set the object value length too.

------------------------------------------------------------------------
r963 | sdake | 2006-03-31 13:10:33 -0700 (Fri, 31 Mar 2006) | 2 lines

Fix typo is clc_cli_script

------------------------------------------------------------------------
r962 | sdake | 2006-03-31 12:55:52 -0700 (Fri, 31 Mar 2006) | 3 lines

defect 1172
checkpoint service asserts under load during configuration changes

------------------------------------------------------------------------
r961 | fthomas | 2006-03-31 01:14:55 -0700 (Fri, 31 Mar 2006) | 1 line

defect 1178: use synchronous lock structure on reply
------------------------------------------------------------------------
r960 | sdake | 2006-03-29 12:02:42 -0700 (Wed, 29 Mar 2006) | 3 lines

defect 1153
Fix segfault with sync service if syncronization is interrupted during recovery.

------------------------------------------------------------------------
r959 | muniba | 2006-03-28 14:49:49 -0700 (Tue, 28 Mar 2006) | 3 lines

defect 1192
Fixes the issue of ckpt sections getting reordered and also fixes the issue of synchronizing ckpt while under the retention timer.

------------------------------------------------------------------------
r958 | pcaulfie | 2006-03-28 05:32:45 -0700 (Tue, 28 Mar 2006) | 4 lines

Call a service's config_init_fn() as soon as it is loaded. 
Then call exec_init_fn() after other initialisation has happened.


------------------------------------------------------------------------
r957 | sdake | 2006-03-27 10:37:21 -0700 (Mon, 27 Mar 2006) | 2 lines

patch from Hans to support amf B types

------------------------------------------------------------------------
r956 | sdake | 2006-03-24 11:48:47 -0700 (Fri, 24 Mar 2006) | 4 lines

enhancement 1145
Patch from Lars to implement csi attribute setting in config file and delivered
via callback.

------------------------------------------------------------------------
r955 | sdake | 2006-03-24 11:25:55 -0700 (Fri, 24 Mar 2006) | 3 lines

Patch from Hans to fix up the configurable /var/run and /etc/ais directory 
support.

------------------------------------------------------------------------
r954 | fthomas | 2006-03-24 01:28:12 -0700 (Fri, 24 Mar 2006) | 1 line

Bug 1130: add totempg log; remove warnings; add DPRINT macro
------------------------------------------------------------------------
r953 | sdake | 2006-03-23 10:32:42 -0700 (Thu, 23 Mar 2006) | 4 lines

objdb merge
add missing service.c file


------------------------------------------------------------------------
r952 | sdake | 2006-03-18 14:00:19 -0700 (Sat, 18 Mar 2006) | 3 lines

defect 1139
merge object database and do a general refactor of the code

------------------------------------------------------------------------
r951 | sdake | 2006-03-17 02:36:13 -0700 (Fri, 17 Mar 2006) | 8 lines

Patch from Hans
This patch (against r950) makes it possible to change the directory
where aisexec searches for configuration files. Pretty much in line with
the possibility to specify user and group. Just do:

make OPENAIS_CONFDIR=/tmp/ais


------------------------------------------------------------------------
r950 | sdake | 2006-03-15 22:41:28 -0700 (Wed, 15 Mar 2006) | 17 lines

Patch from Hans Feldt
This small patch (against r948) adds variable CPPFLAGS to all make rules 
that compiles `.c' files into `.o' files.

This makes it possible to set CPPFLAGS on the command line as in:

$ make CPPFLAGS=-DAMFDEBUG

Editing the makefile when prototyping is then not needed.

Another reason is that some of the openais C files are built using the 
implicit rule for C files (which uses CPPFLAGS). The change makes rules 
consistent with the implicit rule.

It also adds a few missing files to the clean make target.


------------------------------------------------------------------------
r949 | muniba | 2006-03-15 13:46:08 -0700 (Wed, 15 Mar 2006) | 2 lines

Fix the innacurate dataSize in the Checkpoint Read response reported by Bjorn.

------------------------------------------------------------------------
r948 | sdake | 2006-03-08 00:29:27 -0700 (Wed, 08 Mar 2006) | 5 lines

defect 1113
Checkpoint iteration is totally broken.  This patch makes checkpoint iteration
work properly for multiple checkpoint iterators and now is compliant with the
specifications for the trunk version.

------------------------------------------------------------------------
r947 | sdake | 2006-03-08 00:16:28 -0700 (Wed, 08 Mar 2006) | 3 lines

defect 1117
binding to localhost doesn't work.  This patch reenables that functionality.

------------------------------------------------------------------------
r946 | sdake | 2006-03-08 00:13:27 -0700 (Wed, 08 Mar 2006) | 4 lines

defect 1120
The AMF code doesn't detect invalid healthcheck keys and crashes when an
invalid healthcheck key is specified.

------------------------------------------------------------------------
r945 | sdake | 2006-03-08 00:10:51 -0700 (Wed, 08 Mar 2006) | 6 lines

defect 1116
The IPC code spins in recvmsg in the library resulting in poor performance
and deadlock in the AMF service.



------------------------------------------------------------------------
r944 | fthomas | 2006-03-07 15:50:50 -0700 (Tue, 07 Mar 2006) | 1 line

repair OPENAIS_COVERAGE, OPENAIS_PROFILE
------------------------------------------------------------------------
r943 | fthomas | 2006-03-07 15:48:43 -0700 (Tue, 07 Mar 2006) | 1 line

use sched_get_priority_max to set the maximum priority
------------------------------------------------------------------------
r942 | muniba | 2006-03-07 12:40:23 -0700 (Tue, 07 Mar 2006) | 3 lines

defect 1115
added support for reinitializing synchrony to support ongoing sync during a re-configuration.

------------------------------------------------------------------------
r941 | muniba | 2006-03-06 15:02:47 -0700 (Mon, 06 Mar 2006) | 3 lines

defect 1115
fix faulty check.

------------------------------------------------------------------------
r940 | pcaulfie | 2006-03-06 05:11:21 -0700 (Mon, 06 Mar 2006) | 2 lines

Add man pages for the libcpg functions.

------------------------------------------------------------------------
r939 | pcaulfie | 2006-03-06 01:46:56 -0700 (Mon, 06 Mar 2006) | 6 lines

Fix testcpg.c so it actually works.

in exec/cpg: Don't regard a process as joined until all all nodes have
             received the message.
             Don't send other nodes' processes in a joinlist message!

------------------------------------------------------------------------
r938 | muniba | 2006-03-05 19:44:04 -0700 (Sun, 05 Mar 2006) | 2 lines

bug 1115. Fixes the synchronization algorithm which was skipping services.

------------------------------------------------------------------------
r937 | muniba | 2006-03-05 15:33:24 -0700 (Sun, 05 Mar 2006) | 2 lines

Bug Fix for memory leak in ckpt section management. Bug 1112

------------------------------------------------------------------------
r936 | pcaulfie | 2006-03-03 01:46:45 -0700 (Fri, 03 Mar 2006) | 2 lines

Add cpg (closed process groups) component.

------------------------------------------------------------------------
r935 | sdake | 2006-03-02 16:26:58 -0700 (Thu, 02 Mar 2006) | 4 lines

defect 981
This patch fixes a problem where the synchronization engine would not work
cross endian.

------------------------------------------------------------------------
r934 | sdake | 2006-03-02 16:26:35 -0700 (Thu, 02 Mar 2006) | 3 lines

defect 981
This patch fixes a problem where ykd would not work cross endian

------------------------------------------------------------------------
r933 | sdake | 2006-03-02 16:25:51 -0700 (Thu, 02 Mar 2006) | 3 lines

defect 981
This patch fixes a problem where totempg would not work cross-endian.

------------------------------------------------------------------------
r932 | muniba | 2006-03-01 18:05:10 -0700 (Wed, 01 Mar 2006) | 2 lines

reverting fix to man page as only 0.72 is broken with last byte zero in bindnetaddress

------------------------------------------------------------------------
r931 | muniba | 2006-03-01 14:45:00 -0700 (Wed, 01 Mar 2006) | 2 lines

Remove the reference to the use of 0 as last byte in the bindnetaddr

------------------------------------------------------------------------
r927 | sdake | 2006-02-21 00:46:14 -0700 (Tue, 21 Feb 2006) | 4 lines

defect 1099
move "ais" init script to mvlcge
add redhat init script from Bjorn

------------------------------------------------------------------------
r926 | sdake | 2006-02-21 00:32:00 -0700 (Tue, 21 Feb 2006) | 2 lines

Fabien's patch for the BSD/Darwin port.

------------------------------------------------------------------------
r925 | sdake | 2006-02-14 19:08:34 -0700 (Tue, 14 Feb 2006) | 5 lines

Patch from Patrick
This patch restores the functionality in previous versions where the node
address could be specified as a network address in openais.conf


------------------------------------------------------------------------
r924 | sdake | 2006-02-14 19:02:55 -0700 (Tue, 14 Feb 2006) | 6 lines

enhancement 1049
Patch from Patrick
This simple patch stops a potential DoS. If a library tries to access a
component that is not loaded into the exec then it will crash trying to deref
ais_service_handlers[ service ]

------------------------------------------------------------------------
r923 | sdake | 2006-02-11 15:29:29 -0700 (Sat, 11 Feb 2006) | 4 lines

enhancement 1088
This replaces MSG_DONTWAIT with an fcntl to O_NONBLOCK to be more portable
for the BSD port since BSD doesn't support MSG_DONTWAIT properly.

------------------------------------------------------------------------
r922 | sdake | 2006-02-11 15:25:54 -0700 (Sat, 11 Feb 2006) | 5 lines

defect 981
big endian and little endian in the same network causes infinite loop.  This
patch fixes that problem for the totem layer only.  Other components are not
resolved.

------------------------------------------------------------------------
r921 | sdake | 2006-02-10 15:58:31 -0700 (Fri, 10 Feb 2006) | 2 lines

Get rid of junk debug statement

------------------------------------------------------------------------
r920 | sdake | 2006-02-10 15:53:18 -0700 (Fri, 10 Feb 2006) | 6 lines

defect 1088
First patch for porting to BSD systems.  This patch removes the WAITALL
flag entirely from the library handlers, as it appears there may be some
portability problems with this flag.  The code already handles partial
reads anyway, so it was not necessary.

------------------------------------------------------------------------
r918 | sdake | 2006-02-10 15:38:43 -0700 (Fri, 10 Feb 2006) | 3 lines

defect 1066
original 1066 fix introduced new bug found with saftest

------------------------------------------------------------------------
r917 | sdake | 2006-02-10 14:05:57 -0700 (Fri, 10 Feb 2006) | 3 lines

Some versions of GCC were optimizing out the static ctor section.  This patch
makes the ctor non-static so it is not optimized out.

------------------------------------------------------------------------
r916 | sdake | 2006-02-09 17:30:29 -0700 (Thu, 09 Feb 2006) | 3 lines

Cleanup of dynamic loading to allow using the same interface factory code for
statically linked components.

------------------------------------------------------------------------
r915 | sdake | 2006-02-01 16:46:44 -0700 (Wed, 01 Feb 2006) | 3 lines

Patch from Patrick to enable configuring the list of dynamic service handlers
in the configuration file.

------------------------------------------------------------------------
r914 | sdake | 2006-02-01 14:17:47 -0700 (Wed, 01 Feb 2006) | 5 lines

1049
make all service handlers dynamically loadable or compilable statically
use the BUILD_DYNAMIC flag in the makefile to set dynamic loading or static
compile.

------------------------------------------------------------------------
r912 | sdake | 2006-02-01 14:01:24 -0700 (Wed, 01 Feb 2006) | 3 lines

defect 1066
memory leak in saCkptSectionIterationInitialize

------------------------------------------------------------------------
r910 | sdake | 2006-02-01 13:57:01 -0700 (Wed, 01 Feb 2006) | 4 lines

defect 1065
memory leak in checkpoint iteration when IterationNext has a failure condition
(like NO_MORE_SECTIONS)

------------------------------------------------------------------------
r909 | sdake | 2006-02-01 13:45:26 -0700 (Wed, 01 Feb 2006) | 3 lines

defect 1068
bug in saHandleDestroy could cause extra put on handle when the check is invalid

------------------------------------------------------------------------
r906 | markh | 2006-01-25 12:16:31 -0700 (Wed, 25 Jan 2006) | 4 lines

defect 1049
Fix compile error in testlck and testmsg.  Use SA_AIS_OK.


------------------------------------------------------------------------
r905 | sdake | 2006-01-24 23:27:09 -0700 (Tue, 24 Jan 2006) | 3 lines

enhancement 1049
enhance services so dynamic service handlers are more easily possible

------------------------------------------------------------------------
r903 | markh | 2006-01-24 14:55:45 -0700 (Tue, 24 Jan 2006) | 5 lines

defect 1048 - make_event uses wrong handle database

Correct calls to saHandleDestroy to use the correct handle database.


------------------------------------------------------------------------
r902 | sdake | 2006-01-24 00:19:11 -0700 (Tue, 24 Jan 2006) | 3 lines

defect 1046
SaErrorT in trunk branch, but only SaAisErrorT should be used

------------------------------------------------------------------------
r898 | sdake | 2006-01-21 16:23:45 -0700 (Sat, 21 Jan 2006) | 3 lines

defect 1045
totempg is not thread safe, and AMF requires threads to instantiate components

------------------------------------------------------------------------
r892 | sdake | 2006-01-20 13:40:21 -0700 (Fri, 20 Jan 2006) | 8 lines

This is a major rework of the service handling code.  Now service handlers
can be dynamically loaded via the live component replacement service.  Sync
handlers are also dynamically contributed.

It is possible to build using either dynamic loading via LCR or static
linking of the entire executive.  This is controlled by the BUILD_DYNAMIC 
configuration option in the Makefile.

------------------------------------------------------------------------
r891 | sdake | 2006-01-15 23:29:08 -0700 (Sun, 15 Jan 2006) | 2 lines

remove old files that are no longer needed.

------------------------------------------------------------------------
r890 | sdake | 2006-01-13 16:50:21 -0700 (Fri, 13 Jan 2006) | 2 lines

Small man page cleanup

------------------------------------------------------------------------
r887 | markh | 2006-01-11 14:26:39 -0700 (Wed, 11 Jan 2006) | 5 lines

defect 1030

Check return pointer from malloc for NULL.  Back out any previous malloc
to eliminate memory leaks.  Return proper status.

------------------------------------------------------------------------
r886 | markh | 2006-01-11 14:23:56 -0700 (Wed, 11 Jan 2006) | 6 lines

defect 1030
This fixes the event handle leak on failure, the malloc check for hl,
removes the redundant memset when creating a handle, and makes sure
that the put of the channel handle is a valid handle.


------------------------------------------------------------------------
r885 | sdake | 2006-01-06 17:26:16 -0700 (Fri, 06 Jan 2006) | 3 lines

defect 1024
YKD algorithm doesn't always work when new_message_queue is full.

------------------------------------------------------------------------
r883 | markh | 2006-01-05 15:40:47 -0700 (Thu, 05 Jan 2006) | 4 lines

Fix for bug 1023.
Fixes a problem where the dispatcher can lose track of available
events if it gets SA_ERR_TRY_AGAIN from the exec.

------------------------------------------------------------------------
r882 | sdake | 2006-01-03 15:12:09 -0700 (Tue, 03 Jan 2006) | 3 lines

Add information about the event and amf directive in the openais.conf.5 man
page.

------------------------------------------------------------------------
r881 | sdake | 2006-01-03 14:18:00 -0700 (Tue, 03 Jan 2006) | 2 lines

Delete empty files.

------------------------------------------------------------------------
r880 | sdake | 2006-01-02 22:52:57 -0700 (Mon, 02 Jan 2006) | 3 lines

enhancement 1020
adds missing file from commit

------------------------------------------------------------------------
r879 | sdake | 2006-01-02 22:51:38 -0700 (Mon, 02 Jan 2006) | 3 lines

enhancement 1020
Adds AMF B.01.01 support - still needs alot of work

------------------------------------------------------------------------
r878 | sdake | 2006-01-02 21:10:17 -0700 (Mon, 02 Jan 2006) | 6 lines

enhancement 1019
Modify YKD to select primary component and execute the synchronization
operation only in the main partition.  In the non-primary partition, no
new requests are allowed - they are all returned with the error code
SA_AIS_ERR_TRY_AGAIN.

------------------------------------------------------------------------
r876 | sdake | 2006-01-01 23:49:37 -0700 (Sun, 01 Jan 2006) | 3 lines

defect 1006
on 64 bit platforms, the timer is not properly cleared resulting in segfaults

------------------------------------------------------------------------
r874 | sdake | 2006-01-01 23:44:44 -0700 (Sun, 01 Jan 2006) | 3 lines

enhancement 1007
need way to install openais into user selectable directories

------------------------------------------------------------------------
r873 | sdake | 2006-01-01 23:40:29 -0700 (Sun, 01 Jan 2006) | 3 lines

enhancement 1018
Add YKD dynamic voting algorithm to executive code

------------------------------------------------------------------------
r870 | sdake | 2005-12-27 11:38:43 -0700 (Tue, 27 Dec 2005) | 3 lines

defect 999
clm library doesn't exit from poll when executive crashes

------------------------------------------------------------------------
r869 | sdake | 2005-12-27 11:36:38 -0700 (Tue, 27 Dec 2005) | 3 lines

enhancement 989
improve process group membership interface in totem_pg

------------------------------------------------------------------------
r868 | sdake | 2005-12-22 13:12:50 -0700 (Thu, 22 Dec 2005) | 4 lines

lock service locks up under certain conditions this patch fixes that problem
from Mark


------------------------------------------------------------------------
r866 | sdake | 2005-12-20 12:01:30 -0700 (Tue, 20 Dec 2005) | 3 lines

defect 993
ckpt-rd.c and ckpt-wr.c in the test directory don't run with the latest code.

------------------------------------------------------------------------
r864 | sdake | 2005-12-20 11:48:35 -0700 (Tue, 20 Dec 2005) | 3 lines

defect 998
Sometimes the default section isn't synchronized

------------------------------------------------------------------------
r862 | sdake | 2005-12-08 11:27:57 -0700 (Thu, 08 Dec 2005) | 3 lines

defect 982
Fixes ckpt list corruption on failure to allocate checkpoint replica

------------------------------------------------------------------------
r860 | sdake | 2005-12-06 11:42:29 -0700 (Tue, 06 Dec 2005) | 4 lines

defect 988
The totem SRP handle is passed up the entire stack is not needed past certain
functions.

------------------------------------------------------------------------
r859 | sdake | 2005-12-05 15:01:22 -0700 (Mon, 05 Dec 2005) | 6 lines

fix documentation error from specification which identifies
SaLckResourceLockAsync as the function name in some places but
saLckResourceLockAsync in other places.  We settled on saLck since it matches
the rest of the specifications.


------------------------------------------------------------------------
r858 | sdake | 2005-11-30 16:36:00 -0700 (Wed, 30 Nov 2005) | 4 lines

shared object name incorrectly set for the lock service to libSaLCK instead of
libSaLck.


------------------------------------------------------------------------
r857 | sdake | 2005-11-30 16:01:00 -0700 (Wed, 30 Nov 2005) | 5 lines

fix documentation error from specification which identifies
SaLckResourceLockAsync as the function name in some places but
saLckResourceLockAsync in other places.  We settled on saLck since it matches
the rest of the specifications.

------------------------------------------------------------------------
r856 | sdake | 2005-11-30 12:44:40 -0700 (Wed, 30 Nov 2005) | 3 lines

defect 979
This enhancement adds support for IPV6 to the trunk of openais.

------------------------------------------------------------------------
r854 | sdake | 2005-11-30 12:41:28 -0700 (Wed, 30 Nov 2005) | 3 lines

Fix defect 974
There was an infinite loop problem in the fix for defect 974

------------------------------------------------------------------------
r852 | sdake | 2005-11-25 15:01:00 -0700 (Fri, 25 Nov 2005) | 4 lines

defect 932
This patch adds token sequence number and global sequence number rollover
support.  A window is used to ensure comparisons are done properly.

------------------------------------------------------------------------
r850 | sdake | 2005-11-23 15:29:59 -0700 (Wed, 23 Nov 2005) | 4 lines

defect 974
checkpoint service segfaults during synchronization because iteration item
is deleted and iteration continues in unsafe fashion.

------------------------------------------------------------------------
r848 | sdake | 2005-11-23 15:25:04 -0700 (Wed, 23 Nov 2005) | 4 lines

defect 969
processor_count_set is called in the wrong place causing the protocol to
fail to receive.

------------------------------------------------------------------------
r846 | sdake | 2005-11-23 15:13:02 -0700 (Wed, 23 Nov 2005) | 3 lines

defect 968
Heartbeat failure detection man page updates

------------------------------------------------------------------------
r844 | markh | 2005-11-22 14:20:35 -0700 (Tue, 22 Nov 2005) | 4 lines

Fix for Bug 875.  
Cleans up a channel that actually opened but
the library request timed out.

------------------------------------------------------------------------
r842 | sdake | 2005-11-18 14:44:40 -0700 (Fri, 18 Nov 2005) | 3 lines

defect 965
Fix synchronization service lockup if the new_message_queue is full

------------------------------------------------------------------------
r839 | sdake | 2005-11-18 14:38:31 -0700 (Fri, 18 Nov 2005) | 4 lines

defect 956
fix assertion where new_message_queue is overflowed when a message is pending
in the fragmentation queue.

------------------------------------------------------------------------
r837 | markh | 2005-11-18 14:31:01 -0700 (Fri, 18 Nov 2005) | 5 lines

Fix for BUG 955.
The base event ID needed to be set to one.  event zero was being detected
as already delivered and thrown away.


------------------------------------------------------------------------
r836 | sdake | 2005-11-18 14:29:11 -0700 (Fri, 18 Nov 2005) | 3 lines

defect 968
Improve worst-case failure detection time using active healthchecking

------------------------------------------------------------------------
r834 | sdake | 2005-10-26 17:53:36 -0700 (Wed, 26 Oct 2005) | 3 lines

defect 914
fix gcc 4 specific compile warnings and compile errors

------------------------------------------------------------------------
r832 | sdake | 2005-10-03 17:10:11 -0700 (Mon, 03 Oct 2005) | 4 lines

defect 909
c++ keywords are used in the internal implementation of list.h


------------------------------------------------------------------------
r830 | markh | 2005-09-29 07:38:18 -0700 (Thu, 29 Sep 2005) | 3 lines

Fix compiler warnings when HZ is defined to be a long.
Bugzilla #904

------------------------------------------------------------------------
r829 | sdake | 2005-09-28 20:38:59 -0700 (Wed, 28 Sep 2005) | 3 lines

defect 903
First cut at a distributed locking service.

------------------------------------------------------------------------
r827 | sdake | 2005-09-26 14:31:25 -0700 (Mon, 26 Sep 2005) | 4 lines

defect 898
don't need to copy message to fragmentation data buffer if message can be
multicasted as is.

------------------------------------------------------------------------
r825 | sdake | 2005-09-26 14:27:57 -0700 (Mon, 26 Sep 2005) | 3 lines

defect 897
fix new_message_queue can be overwritten

------------------------------------------------------------------------
r822 | sdake | 2005-09-22 12:51:48 -0700 (Thu, 22 Sep 2005) | 3 lines

defect 896
Ruppert reported there was a missing typecast

------------------------------------------------------------------------
r821 | sdake | 2005-09-22 12:51:12 -0700 (Thu, 22 Sep 2005) | 4 lines

defect 895
Ruppert reported that there is code that doesn't do anything but should.


------------------------------------------------------------------------
r818 | sdake | 2005-09-20 16:05:55 -0700 (Tue, 20 Sep 2005) | 2 lines

reduce maximum message size since 253000 is beyond the max.

------------------------------------------------------------------------
r816 | sdake | 2005-09-20 15:42:32 -0700 (Tue, 20 Sep 2005) | 2 lines

remove extraneous debug printf

------------------------------------------------------------------------
r814 | sdake | 2005-09-20 11:34:15 -0700 (Tue, 20 Sep 2005) | 5 lines

defect 892
Fix performance degradation when sending 10-15 messages per second because
of a large seqno_unchanged_const.  Also, seqno_unchanged_const does not have
a configurable option and this patch adds that support.

------------------------------------------------------------------------
r812 | sdake | 2005-09-06 14:54:49 -0700 (Tue, 06 Sep 2005) | 2 lines

defect 856 - CHANGES and CHANGES_ONLY have identical effect with saClmClusterTrack()

------------------------------------------------------------------------
r811 | sdake | 2005-09-06 14:51:46 -0700 (Tue, 06 Sep 2005) | 2 lines

defect 855 - implement view numbers and report them correctly as per specs

------------------------------------------------------------------------
r810 | sdake | 2005-09-06 14:50:24 -0700 (Tue, 06 Sep 2005) | 2 lines

defect 854 - invalid return value displayed in test program

------------------------------------------------------------------------
r809 | sdake | 2005-08-30 13:29:13 -0700 (Tue, 30 Aug 2005) | 5 lines

defect 841
Rabbe reported that cluster track callback operations dont work properly.
This patch fixes that problem.


------------------------------------------------------------------------
r808 | sdake | 2005-08-29 12:55:34 -0700 (Mon, 29 Aug 2005) | 6 lines

defect 839
The timer interval can be set to less then the platform timing interval.  This
could result in negative timer values configured by the user which confuse
the totem protocol.


------------------------------------------------------------------------
r807 | sdake | 2005-08-29 12:50:53 -0700 (Mon, 29 Aug 2005) | 5 lines

defect 828
assert in totemsrp_avail occurs with certain test cases.  The code was rounding
down to zero when calculating the number of messages required.  This patch adds
one in all cases so no roundoff occurs.

------------------------------------------------------------------------
r806 | sdake | 2005-08-29 12:47:01 -0700 (Mon, 29 Aug 2005) | 5 lines

defect 840
J Seltzer reported that closed checkpoints in the TRY_AGAIN state are not
closed in the executive but are closed in the library.  This patch fixes
that problem.

------------------------------------------------------------------------
r805 | sdake | 2005-08-25 15:10:26 -0700 (Thu, 25 Aug 2005) | 4 lines

defect 837
Muni reported the token retransmission timer doesn't need to be reset when 
receiving a retransmission

------------------------------------------------------------------------
r804 | sdake | 2005-08-25 15:09:03 -0700 (Thu, 25 Aug 2005) | 3 lines

defect 833
Rabbe reported that the encoding of the ipv4 address in SaClmNodeAddressT is incorrect

------------------------------------------------------------------------
r803 | sdake | 2005-08-25 15:07:53 -0700 (Thu, 25 Aug 2005) | 3 lines

defect 824:
replace network directive with totem directive in default configuration file

------------------------------------------------------------------------
r802 | sdake | 2005-08-25 15:06:49 -0700 (Thu, 25 Aug 2005) | 3 lines

defect 823
Typo in openias conf manpage reported by Rabbe

------------------------------------------------------------------------
r800 | markh | 2005-08-19 12:40:56 -0700 (Fri, 19 Aug 2005) | 5 lines

Fix for bug 825.
SaEvtChannelClose needed to handle SA_AIS_ERR_TRY_AGAIN so that the
eci_closing would be cleared before returning.


------------------------------------------------------------------------
r799 | sdake | 2005-08-18 12:53:20 -0700 (Thu, 18 Aug 2005) | 3 lines

This sets the receive and send transmission buffers to a larger size to avoid overruns
of the multicast buffer.

------------------------------------------------------------------------
r798 | sdake | 2005-08-18 12:23:32 -0700 (Thu, 18 Aug 2005) | 2 lines

This fixes an off by one in queue_avail which resulted in an assertion during testing.

------------------------------------------------------------------------
r797 | sdake | 2005-08-17 12:37:24 -0700 (Wed, 17 Aug 2005) | 3 lines

defect 501
this patch fixes short reads and writes between the library and executive

------------------------------------------------------------------------
r796 | sdake | 2005-08-17 12:27:25 -0700 (Wed, 17 Aug 2005) | 3 lines

enhancement 813
Rename ais_types.h header file to be more compliant with sa forum

------------------------------------------------------------------------
r795 | sdake | 2005-08-17 12:21:16 -0700 (Wed, 17 Aug 2005) | 4 lines

defect 822
checkpoint synchronization has serious bug after saftest fixups


------------------------------------------------------------------------
r794 | sdake | 2005-08-17 12:17:45 -0700 (Wed, 17 Aug 2005) | 13 lines

enhancmement 821
Global reorganization of totem code and also many feature enhancments
These include:
need to specify whether authentication is enabled or dislabed in config file
need to specify frame size in config file
need redundant ring placeholder
need to specify version field of totem
need to support large frame sizes
need to break out threading code from totemsrp
need to break out network code from totemsrp
need to break out parser code from parse.c
and some others

------------------------------------------------------------------------
r793 | sdake | 2005-08-12 15:29:35 -0700 (Fri, 12 Aug 2005) | 3 lines

Patch from Russell Bryant to fix up gcc 4 warnings


------------------------------------------------------------------------
r792 | markh | 2005-08-11 12:22:50 -0700 (Thu, 11 Aug 2005) | 7 lines

The current event service code will start rejecting received events
after 4gig because it thinks that they are duplicates.  
This update fixes that problem.  Now I am keeping a full 64 bit id for
checking for duplicate/re-sends, etc.  separate from the event ID.  I
also check that a new event ID is not in use by a retained event.


------------------------------------------------------------------------
r791 | markh | 2005-08-05 11:34:53 -0700 (Fri, 05 Aug 2005) | 4 lines

Add a check field to the handle structure to make it less
likely to get a random valid handle.
Fix a couple bugs in the event service that this change exposed.

------------------------------------------------------------------------
r790 | markh | 2005-08-02 14:35:34 -0700 (Tue, 02 Aug 2005) | 4 lines

Fix for BUG 803.  We need to complete a library call even if the
channel requested for unlink has been deleted previous to processing
an unlink request.

------------------------------------------------------------------------
r789 | sdake | 2005-07-29 15:19:50 -0700 (Fri, 29 Jul 2005) | 2 lines

fixes segfault when ctrl-c pressed with new totemmrp code

------------------------------------------------------------------------
r788 | sdake | 2005-07-29 14:37:21 -0700 (Fri, 29 Jul 2005) | 2 lines

fixes a missed merge in the totemmrp mergeup

------------------------------------------------------------------------
r787 | sdake | 2005-07-29 14:21:43 -0700 (Fri, 29 Jul 2005) | 2 lines

Fix a few compile warnings.

------------------------------------------------------------------------
r786 | sdake | 2005-07-29 14:18:45 -0700 (Fri, 29 Jul 2005) | 3 lines

defect 796
fix saClmClusterTrack to operate according to specs.

------------------------------------------------------------------------
r785 | sdake | 2005-07-29 14:17:49 -0700 (Fri, 29 Jul 2005) | 3 lines

defect 793
dont return SA_AIS_ERR_NOT_EXIST when tracking started with SA_TRACK_CURRENT only

------------------------------------------------------------------------
r784 | sdake | 2005-07-29 14:17:12 -0700 (Fri, 29 Jul 2005) | 3 lines

defect 792
saClmTrackStop not returning SA_AIS_ERR_NOT_EXIST

------------------------------------------------------------------------
r783 | sdake | 2005-07-29 14:15:14 -0700 (Fri, 29 Jul 2005) | 3 lines

defect 790
if sectionDescriptor is null in iteration next call, segfault occurs

------------------------------------------------------------------------
r782 | sdake | 2005-07-29 13:55:25 -0700 (Fri, 29 Jul 2005) | 4 lines

Add infrastructure support for multiring to totem library
Make totemsrp support multiple instances of a running protocol within one app.
Rename libtotem to libtotem_pg because of a name conflict with some movie player

------------------------------------------------------------------------
r781 | markh | 2005-07-27 13:22:04 -0700 (Wed, 27 Jul 2005) | 4 lines

Move the check of subscription ID in lib_evt_event_subscribe before 
processing the filters.


------------------------------------------------------------------------
r780 | markh | 2005-07-27 13:19:39 -0700 (Wed, 27 Jul 2005) | 4 lines

Fix for bug 776.  Don't require retained events to expire 
before deleting the channel on unlink.


------------------------------------------------------------------------
r779 | sdake | 2005-07-27 13:07:35 -0700 (Wed, 27 Jul 2005) | 3 lines

defect 784
readSize is not properly set after return from checkpoint read operation.

------------------------------------------------------------------------
r778 | sdake | 2005-07-27 13:06:35 -0700 (Wed, 27 Jul 2005) | 3 lines

defect 785
ckptbenchth is completely broken.  This patch fixes it to operate properly.

------------------------------------------------------------------------
r777 | sdake | 2005-07-27 13:05:34 -0700 (Wed, 27 Jul 2005) | 4 lines

defect 788
ckptbench returns error 7 at 20000 byte size writes.  The benchmark program
improperly creates the checkpoint parameters.

------------------------------------------------------------------------
r776 | markh | 2005-07-26 15:48:31 -0700 (Tue, 26 Jul 2005) | 4 lines

Fix for bug 773.  Not quite the full fix, but the best we can do
for now.


------------------------------------------------------------------------
r775 | markh | 2005-07-26 15:47:27 -0700 (Tue, 26 Jul 2005) | 3 lines

Fix for bug 774.  Check malloc return before accessing pointer.


------------------------------------------------------------------------
r774 | markh | 2005-07-26 15:45:56 -0700 (Tue, 26 Jul 2005) | 3 lines

Fix for bug 782.  Receved events may not be modified.


------------------------------------------------------------------------
r773 | sdake | 2005-07-26 12:43:31 -0700 (Tue, 26 Jul 2005) | 3 lines

defect 777
fix reference counting bugs in aispoll

------------------------------------------------------------------------
r772 | markh | 2005-07-25 10:43:25 -0700 (Mon, 25 Jul 2005) | 3 lines

Update saEvtEventPublist to return the correct error code
when the event data size in too big.  Bug 768.

------------------------------------------------------------------------
r771 | sdake | 2005-07-15 10:06:12 -0700 (Fri, 15 Jul 2005) | 3 lines

defect 754
tests dont build because makefile damaged

------------------------------------------------------------------------
r770 | sdake | 2005-07-15 10:00:27 -0700 (Fri, 15 Jul 2005) | 3 lines

defect 752
fix reference counting in checkpoint library

------------------------------------------------------------------------
r769 | sdake | 2005-07-15 09:59:53 -0700 (Fri, 15 Jul 2005) | 4 lines

defect 751
when ckptSectionIterationNext iterates all sections, SA_AIS_ERR_NO_SECTIONS
not being returned.

------------------------------------------------------------------------
r768 | sdake | 2005-07-15 09:59:13 -0700 (Fri, 15 Jul 2005) | 3 lines

defect 750
in saCkptIterationFinalize if no active replica set, return error

------------------------------------------------------------------------
r767 | sdake | 2005-07-15 09:58:42 -0700 (Fri, 15 Jul 2005) | 3 lines

defect 749
Make handle put work properly for IterationFinalize

------------------------------------------------------------------------
r766 | sdake | 2005-07-15 09:58:02 -0700 (Fri, 15 Jul 2005) | 3 lines

defect 748
rename sectioniterator to sectioniteration in executive and library

------------------------------------------------------------------------
r765 | sdake | 2005-07-15 09:57:23 -0700 (Fri, 15 Jul 2005) | 4 lines

defecct 747
in saCkptSectionIterationInitialize if sectionsChosen invalid,
return INVALID_PARAM

------------------------------------------------------------------------
r764 | sdake | 2005-07-15 09:56:43 -0700 (Fri, 15 Jul 2005) | 3 lines

defect 746
return INVALID_PARAM in saCkptSectionIterationInitialize if address is NULL

------------------------------------------------------------------------
r763 | sdake | 2005-07-15 09:56:09 -0700 (Fri, 15 Jul 2005) | 3 lines

defect 745
in saCkptSectionCreate if initialData == NULL return INVALID_PARAM

------------------------------------------------------------------------
r762 | sdake | 2005-07-15 09:54:37 -0700 (Fri, 15 Jul 2005) | 3 lines

defect 744
return SA_AIS_ERR_EXIST in saCkptSectionCreate if maxSections == 1

------------------------------------------------------------------------
r761 | sdake | 2005-07-15 09:53:55 -0700 (Fri, 15 Jul 2005) | 4 lines

defect 743
in saCkptCheckpointSectionCreate return SA_AIS_ERR_NO_SPACE if
current sections == maxSections

------------------------------------------------------------------------
r760 | sdake | 2005-07-15 09:52:55 -0700 (Fri, 15 Jul 2005) | 3 lines

defect 742
error not returned in saCkptSectionCreate if sectionCreationAttributes == NULL

------------------------------------------------------------------------
r759 | sdake | 2005-07-15 09:52:15 -0700 (Fri, 15 Jul 2005) | 4 lines

defect 741
saCkptCheckpointOpenAsync doesn't return error when
checkpointSize > maxSections * maxSectionsSize

------------------------------------------------------------------------
r758 | sdake | 2005-07-15 09:51:37 -0700 (Fri, 15 Jul 2005) | 3 lines

defect 740
if open callback isn't set on saCkptCheckpointOpenAsync, return SA_AIS_ERR_INIT

------------------------------------------------------------------------
r757 | sdake | 2005-07-15 09:50:34 -0700 (Fri, 15 Jul 2005) | 3 lines

defect 739
saCkptCheckpointOpenAsync callback doesn't return error as per spec

------------------------------------------------------------------------
r756 | sdake | 2005-07-13 13:13:25 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 718
if no active replica is not set do not set expiration time and return error.

------------------------------------------------------------------------
r755 | sdake | 2005-07-13 13:12:49 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 717
if checkpoint is not writeable in durationset, return error

------------------------------------------------------------------------
r754 | sdake | 2005-07-13 13:12:23 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 716
in durationtimeset if sectionId is null, return error

------------------------------------------------------------------------
r753 | sdake | 2005-07-13 13:11:57 -0700 (Wed, 13 Jul 2005) | 4 lines

defect 715
synchronize open missing break in dispatch causing checkpointsyncasync callback
not to be called.

------------------------------------------------------------------------
r752 | sdake | 2005-07-13 13:11:22 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 714
if checkpoint doesn't have write permissions in section delete, return error

------------------------------------------------------------------------
r751 | sdake | 2005-07-13 13:10:56 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 713
if active replica not set in section delete, return error

------------------------------------------------------------------------
r750 | sdake | 2005-07-13 13:10:32 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 712
if sectionId is null in sectiondelete, return INVALID_PARAM

------------------------------------------------------------------------
r749 | sdake | 2005-07-13 13:10:02 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 711
if no active replica set in checkpoint write, error not returned

------------------------------------------------------------------------
r748 | sdake | 2005-07-13 13:09:39 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 710
if ioVector == NULL in checkpoint read error should be returned

------------------------------------------------------------------------
r747 | sdake | 2005-07-13 13:09:11 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 709
if synchronize async called, but no callback set, error not returned

------------------------------------------------------------------------
r746 | sdake | 2005-07-13 13:08:39 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 708
checkpoint synchronize async call not implemented

------------------------------------------------------------------------
r745 | sdake | 2005-07-13 13:08:13 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 707
if checkpoint synchronize executedd with timeout=0, TIMEOUT error not returned

------------------------------------------------------------------------
r744 | sdake | 2005-07-13 13:07:45 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 706
replica is not set based upon open flags as per specification

------------------------------------------------------------------------
r743 | sdake | 2005-07-13 13:07:20 -0700 (Wed, 13 Jul 2005) | 4 lines

defect 705
if synchronize executed on a checkpoint that was created WR_ALL_REPLICAS return
error.

------------------------------------------------------------------------
r742 | sdake | 2005-07-13 13:06:48 -0700 (Wed, 13 Jul 2005) | 4 lines

defect 704
if checkpoint is opened without read permissions, checkpoint synchronize
should return SA_AIS_ERR_ACCESS.

------------------------------------------------------------------------
r741 | sdake | 2005-07-13 13:06:04 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 703
checkpoint synchronize calls do not check if active replica set

------------------------------------------------------------------------
r740 | sdake | 2005-07-13 13:05:42 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 702
checkpoint synchronize missing executive handler

------------------------------------------------------------------------
r739 | sdake | 2005-07-13 13:05:15 -0700 (Wed, 13 Jul 2005) | 4 lines

defect 684
return INVALID_PARAM in checkpoint read if dataSize greater then
maxSections * maxsectionsSize.

------------------------------------------------------------------------
r738 | sdake | 2005-07-13 13:04:21 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 683
if active replica not set, checkpointread should return SA_AIS_ERR_NOT_EXIST

------------------------------------------------------------------------
r737 | sdake | 2005-07-13 13:03:41 -0700 (Wed, 13 Jul 2005) | 4 lines

defect 682
null iovector caues checkpointRead to segfault


------------------------------------------------------------------------
r736 | sdake | 2005-07-13 13:03:15 -0700 (Wed, 13 Jul 2005) | 4 lines

defect 681
if null paramter passed to checkpoint service as iovector element, allocate
the io vector element

------------------------------------------------------------------------
r735 | sdake | 2005-07-13 13:02:20 -0700 (Wed, 13 Jul 2005) | 4 lines

defect 680
ckptsectionoverwrite should return INVALID if dataSize greater then
maxSections * maxSectionsSize

------------------------------------------------------------------------
r734 | sdake | 2005-07-13 13:01:29 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 677
SectionOverwrite with null sectionId segfaults

------------------------------------------------------------------------
r733 | sdake | 2005-07-13 13:00:58 -0700 (Wed, 13 Jul 2005) | 4 lines

defect 676
sectionoverwrite doesn't return correct error when checkpoint section
doesn't exist

------------------------------------------------------------------------
r732 | sdake | 2005-07-13 13:00:15 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 675
section overwrite with null dataBuffer parameter locks up

------------------------------------------------------------------------
r731 | sdake | 2005-07-13 12:57:48 -0700 (Wed, 13 Jul 2005) | 4 lines

defect 734
cleanup include files and exports from libraries


------------------------------------------------------------------------
r730 | sdake | 2005-07-13 12:29:02 -0700 (Wed, 13 Jul 2005) | 4 lines

defect 732
req_amf_componentregister used instead of req_lib_amf_componentregister.  There
is no definition for req_amf_componentregister.

------------------------------------------------------------------------
r729 | sdake | 2005-07-13 12:22:13 -0700 (Wed, 13 Jul 2005) | 4 lines

defect 731
error - saSendReceiveReply instead of error = function


------------------------------------------------------------------------
r728 | markh | 2005-07-07 13:26:01 -0700 (Thu, 07 Jul 2005) | 3 lines

Check for reserved event ID and return SA_AIS_ERR_INVALID_PARAM.
Bug 694

------------------------------------------------------------------------
r727 | markh | 2005-06-30 15:36:10 -0700 (Thu, 30 Jun 2005) | 4 lines

Wait to return status to the library until the clear request
was received over the network so that the publish and receipt of the
event is in sync with the time clear request.

------------------------------------------------------------------------
r726 | sdake | 2005-06-30 13:32:55 -0700 (Thu, 30 Jun 2005) | 3 lines

defect 673
fix checkpoint unlink not cleaning up checkpoints.

------------------------------------------------------------------------
r725 | sdake | 2005-06-30 13:29:33 -0700 (Thu, 30 Jun 2005) | 3 lines

defect 502
fix assert when packet added in multicast message handler.

------------------------------------------------------------------------
r724 | sdake | 2005-06-29 16:10:37 -0700 (Wed, 29 Jun 2005) | 3 lines

Remove some warnings from the compile.


------------------------------------------------------------------------
r723 | markh | 2005-06-29 15:14:51 -0700 (Wed, 29 Jun 2005) | 3 lines

Error comparing unsigned to less than zero.


------------------------------------------------------------------------
r722 | sdake | 2005-06-29 14:36:51 -0700 (Wed, 29 Jun 2005) | 4 lines

Enables test caes in saftest to pass by returning failure return codes in both
callback and return function.  This may have to change later if a later errata
changes this functionality.

------------------------------------------------------------------------
r721 | sdake | 2005-06-29 14:34:08 -0700 (Wed, 29 Jun 2005) | 3 lines

defect 669
token retransmits dont work under heavy load.

------------------------------------------------------------------------
r720 | sdake | 2005-06-29 14:33:26 -0700 (Wed, 29 Jun 2005) | 3 lines

defect 656
libraries not built with position independent code.  This causes x86_64 not to build.

------------------------------------------------------------------------
r719 | sdake | 2005-06-29 14:32:43 -0700 (Wed, 29 Jun 2005) | 3 lines

defect 655
invalid checkpoint open flags should return ERR_BAD_FLAGS

------------------------------------------------------------------------
r718 | sdake | 2005-06-29 14:32:08 -0700 (Wed, 29 Jun 2005) | 4 lines

defect 654
wrong error code returned when checkpointSize > maxSections * maxSectionsSize in
checkpoint open.

------------------------------------------------------------------------
r717 | sdake | 2005-06-29 14:31:28 -0700 (Wed, 29 Jun 2005) | 3 lines

defect 653
saCkptCheckpointOpen segfaults if null parameter passed in checkpointName

------------------------------------------------------------------------
r716 | sdake | 2005-06-29 14:30:35 -0700 (Wed, 29 Jun 2005) | 3 lines

defect 652
saCkptCheckpointOpen segfaults if null parameter passed to checkpointHandle

------------------------------------------------------------------------
r715 | sdake | 2005-06-29 14:29:37 -0700 (Wed, 29 Jun 2005) | 2 lines

defect 651 - saCkptCheckpointUnlink segfaults if checkpointName attribute is null

------------------------------------------------------------------------
r714 | sdake | 2005-06-29 14:28:06 -0700 (Wed, 29 Jun 2005) | 2 lines

defect 646 - wrong return code in checkpoint open

------------------------------------------------------------------------
r713 | sdake | 2005-06-28 12:01:25 -0700 (Tue, 28 Jun 2005) | 3 lines

Patch from Muni Bajpai to improve synchronization after a merge.


------------------------------------------------------------------------
r712 | markh | 2005-06-27 14:33:30 -0700 (Mon, 27 Jun 2005) | 3 lines

saEvtEventAttributesSet needs to check that the priority value passed in
is valid.

------------------------------------------------------------------------
r711 | sdake | 2005-06-27 13:26:21 -0700 (Mon, 27 Jun 2005) | 3 lines

Patch from Szakacsits Szabolcs to improve error detection in parsing
configuration files.

------------------------------------------------------------------------
r710 | markh | 2005-06-24 14:20:17 -0700 (Fri, 24 Jun 2005) | 6 lines

The channel open functions need to check for bad flags.

I set the newly created event elements to the default 
values in the B spec.


------------------------------------------------------------------------
r709 | markh | 2005-06-24 14:19:02 -0700 (Fri, 24 Jun 2005) | 4 lines

I discovered that our SaAisErrorT is incorrect.  I have included a patch
to fix that.  The SA_AIS_ERR_BAD_CHECKPOINT code doesn't exist.  I
replaced it with SA_AIS_ERR_BAD_OPERATION.

------------------------------------------------------------------------
r708 | markh | 2005-06-23 07:44:29 -0700 (Thu, 23 Jun 2005) | 4 lines

The A spec required patterns to be set but the B
spec doesn't.  Fix lib/evt.c and test/testevt.c


------------------------------------------------------------------------
r707 | markh | 2005-06-21 15:22:02 -0700 (Tue, 21 Jun 2005) | 4 lines


This fixes some B spec related parameter checks


------------------------------------------------------------------------
r706 | markh | 2005-06-21 15:19:03 -0700 (Tue, 21 Jun 2005) | 20 lines

Some fixes to the event service based on the saftest event
tests results.  

The changes may affect applications currently using the event service. 

1. Timeout value to the saEvtChannelOpen call was updated to use
SA_TIME_MAX instead of 0 for infinite timeout.

2. added cleanup in the library to remove associated events when a
channel is closed, and remove associated channels when finalize is
called.

3. Added some new checking args for NULL and returning the correct error
code.

4. fixed dispatch to return correct status with SA_DISPATCH_ONE and no
available poll data.

5. Makefile had bad dependency for evt library build.

------------------------------------------------------------------------
r705 | mvista.com!sdake | 2005-06-17 11:52:55 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 643
saClmNodeGet timeout parameter of 0 should return SA_AIS_ERR_TIMEOUT

(Logical change 1.224)

------------------------------------------------------------------------
r704 | mvista.com!sdake | 2005-06-17 11:52:55 -0700 (Fri, 17 Jun 2005) | 6 lines

clm.c:
  defect 643
  saClmNodeGet timeout parameter of 0 should return SA_AIS_ERR_TIMEOUT

BKrev: 42b31c07wymW-ntnqdOvHrTrCDEEhA

------------------------------------------------------------------------
r703 | mvista.com!sdake | 2005-06-17 11:52:08 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 642
fix segfault when null clusterNode parameter passed to saClusterNodeGet

(Logical change 1.223)

------------------------------------------------------------------------
r702 | mvista.com!sdake | 2005-06-17 11:52:08 -0700 (Fri, 17 Jun 2005) | 6 lines

clm.c:
  defect 642
  fix segfault when null clusterNode parameter passed to saClusterNodeGet

BKrev: 42b31bd8J6eYpNHnpFWwHWc3waURXw

------------------------------------------------------------------------
r701 | mvista.com!sdake | 2005-06-17 11:51:15 -0700 (Fri, 17 Jun 2005) | 6 lines

clm.c:
  defect 641
  NodeGetAsync called with no nodeget callback should return SA_AIS_ERR_INIT

BKrev: 42b31ba3yncxyr2C6XoRwB_9yMdvRA

------------------------------------------------------------------------
r700 | mvista.com!sdake | 2005-06-17 11:51:15 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 641
NodeGetAsync called with no nodeget callback should return SA_AIS_ERR_INIT

(Logical change 1.222)

------------------------------------------------------------------------
r699 | mvista.com!sdake | 2005-06-17 11:50:27 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 640
fix wrong error code when null version parameter passed to saClmInitialize

(Logical change 1.221)

------------------------------------------------------------------------
r698 | mvista.com!sdake | 2005-06-17 11:50:27 -0700 (Fri, 17 Jun 2005) | 6 lines

clm.c:
  defect 640
  fix wrong error code when null version parameter passed to saClmInitialize

BKrev: 42b31b73Cok4gPBc42AbPIksg9Rw2w

------------------------------------------------------------------------
r697 | mvista.com!sdake | 2005-06-17 11:49:33 -0700 (Fri, 17 Jun 2005) | 6 lines

clm.c:
  defect 639
  fix segfault if null callback parameter passed to saClmInitialize

BKrev: 42b31b3dnxjnqS8cEzAPHPJmbMdVEw

------------------------------------------------------------------------
r696 | mvista.com!sdake | 2005-06-17 11:49:33 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 639
fix segfault if null callback parameter passed to saClmInitialize

(Logical change 1.220)

------------------------------------------------------------------------
r695 | mvista.com!sdake | 2005-06-17 11:48:50 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 638
fix segfault if clmHandle is null to saClmInitialize

(Logical change 1.219)

------------------------------------------------------------------------
r694 | mvista.com!sdake | 2005-06-17 11:48:50 -0700 (Fri, 17 Jun 2005) | 6 lines

clm.c:
  defect 638
  fix segfault if clmHandle is null to saClmInitialize

BKrev: 42b31b12gslEYBvbGYQJgGi6uFw8hg

------------------------------------------------------------------------
r693 | mvista.com!sdake | 2005-06-17 11:47:46 -0700 (Fri, 17 Jun 2005) | 6 lines

clm.c:
  defect 637
  Fix saClmFinalize will block with threads

BKrev: 42b31ad2mqut41t3GjnF-5BmQYDkOA

------------------------------------------------------------------------
r692 | mvista.com!sdake | 2005-06-17 11:47:46 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 637
Fix saClmFinalize will block with threads

(Logical change 1.218)

------------------------------------------------------------------------
r691 | mvista.com!sdake | 2005-06-17 11:47:03 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 636
fix saClmDispatch blocks on invalid dispatch flags

(Logical change 1.217)

------------------------------------------------------------------------
r690 | mvista.com!sdake | 2005-06-17 11:47:03 -0700 (Fri, 17 Jun 2005) | 6 lines

clm.c:
  defect 636
  fix saClmDispatch blocks on invalid dispatch flags

BKrev: 42b31aa7DNo7fwD1STjEtZQflKEaCw

------------------------------------------------------------------------
r689 | mvista.com!sdake | 2005-06-17 11:46:22 -0700 (Fri, 17 Jun 2005) | 6 lines

clm.c:
  defect 635
  saClmSelectionObjectGet crashes if selection object pointer is null

BKrev: 42b31a7e1tftUaCVpz36dDVxSI0wBA

------------------------------------------------------------------------
r688 | mvista.com!sdake | 2005-06-17 11:46:22 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 635
saClmSelectionObjectGet crashes if selection object pointer is null

(Logical change 1.216)

------------------------------------------------------------------------
r687 | mvista.com!sdake | 2005-06-17 11:45:25 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 634
saCkptDispatch blocks if invalid dispatch flag is set

(Logical change 1.215)

------------------------------------------------------------------------
r686 | mvista.com!sdake | 2005-06-17 11:45:25 -0700 (Fri, 17 Jun 2005) | 6 lines

ckpt.c:
  defect 634
  saCkptDispatch blocks if invalid dispatch flag is set

BKrev: 42b31a459dDwB00enI3nSeayQwFODA

------------------------------------------------------------------------
r685 | mvista.com!sdake | 2005-06-17 11:44:41 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 633
saCkptInitialize crashes if callbacks parameter is null

(Logical change 1.214)

------------------------------------------------------------------------
r684 | mvista.com!sdake | 2005-06-17 11:44:41 -0700 (Fri, 17 Jun 2005) | 6 lines

ckpt.c:
  defect 633
  saCkptInitialize crashes if callbacks parameter is null

BKrev: 42b31a19Ti58H5PxsI2NaDivhyz-fQ

------------------------------------------------------------------------
r683 | mvista.com!sdake | 2005-06-17 11:43:52 -0700 (Fri, 17 Jun 2005) | 5 lines

ckpt.c:
  Fix segfault when address of checkpoint handle is null to the initialize function

BKrev: 42b319e8cJKg9zY0XT9um2oqVst5Ug

------------------------------------------------------------------------
r682 | mvista.com!sdake | 2005-06-17 11:43:52 -0700 (Fri, 17 Jun 2005) | 4 lines

Fix segfault when address of checkpoint handle is null to the initialize function

(Logical change 1.213)

------------------------------------------------------------------------
r681 | mvista.com!sdake | 2005-06-17 11:42:52 -0700 (Fri, 17 Jun 2005) | 7 lines

ckpt.c:
  defect 631
  Fix segfault if null pointer passed to selection object address of
  saCkptSelectionObjectGet

BKrev: 42b319acUTulJHw99ALuUlMGTcgL1g

------------------------------------------------------------------------
r680 | mvista.com!sdake | 2005-06-17 11:42:52 -0700 (Fri, 17 Jun 2005) | 6 lines

defect 631
Fix segfault if null pointer passed to selection object address of
saCkptSelectionObjectGet

(Logical change 1.212)

------------------------------------------------------------------------
r679 | mvista.com!sdake | 2005-06-17 11:41:54 -0700 (Fri, 17 Jun 2005) | 7 lines

ckpt.c:
  defect 630
  if a checkpoint is unlinked then opened it should return
  SA_AIS_ERR_NOT_EXIST

BKrev: 42b31972GC0d7zd0Xw4yt4RcQrxcCg

------------------------------------------------------------------------
r678 | mvista.com!sdake | 2005-06-17 11:41:54 -0700 (Fri, 17 Jun 2005) | 6 lines

defect 630
if a checkpoint is unlinked then opened it should return
SA_AIS_ERR_NOT_EXIST

(Logical change 1.211)

------------------------------------------------------------------------
r677 | mvista.com!sdake | 2005-06-17 11:40:45 -0700 (Fri, 17 Jun 2005) | 6 lines

ckpt.c:
  defect 629
  Return error if checkpoint has been unlinked on retentation duration set

BKrev: 42b3192dcHnUOXNAKirryjp4WHDl9g

------------------------------------------------------------------------
r676 | mvista.com!sdake | 2005-06-17 11:40:45 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 629
Return error if checkpoint has been unlinked on retentation duration set

(Logical change 1.210)

------------------------------------------------------------------------
r675 | mvista.com!sdake | 2005-06-17 11:39:51 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 628
saCkptCheckpointStatusGet test case 13 from saftest fails

(Logical change 1.209)

------------------------------------------------------------------------
r674 | mvista.com!sdake | 2005-06-17 11:39:51 -0700 (Fri, 17 Jun 2005) | 6 lines

ckpt.c, ckpt.h:
  defect 628
  saCkptCheckpointStatusGet test case 13 from saftest fails

BKrev: 42b318f7gBulPAY6sscL0tMMMi9jMw

------------------------------------------------------------------------
r673 | mvista.com!sdake | 2005-06-17 11:38:53 -0700 (Fri, 17 Jun 2005) | 6 lines

Makefile, ckpt.c:
  defect 627
  Fix API crash when second parameter of saCkptCheckpointStatusGet is null

BKrev: 42b318bd2NjZ6GGEcjf0mUQr9yL1EA

------------------------------------------------------------------------
r672 | mvista.com!sdake | 2005-06-17 11:38:53 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 627
Fix API crash when second parameter of saCkptCheckpointStatusGet is null

(Logical change 1.208)

------------------------------------------------------------------------
r671 | mvista.com!sdake | 2005-06-17 11:36:36 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 611
add some manual pages to openais

(Logical change 1.207)

------------------------------------------------------------------------
r670 | mvista.com!sdake | 2005-06-17 11:36:36 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 577
Implement token holding mode

(Logical change 1.207)

------------------------------------------------------------------------
r669 | mvista.com!sdake | 2005-06-17 11:36:36 -0700 (Fri, 17 Jun 2005) | 11 lines

Makefile, index.html:
  defect 611
  add some manual pages to openais
openais_overview.8, openais.conf.5:
  new file
Many files:
  defect 577
  Implement token holding mode

BKrev: 42b31834M2cICKgskYf4EnywBr9Fiw

------------------------------------------------------------------------
r668 | mvista.com!sdake | 2005-06-17 11:36:36 -0700 (Fri, 17 Jun 2005) | 2 lines

(Logical change 1.207)

------------------------------------------------------------------------
r667 | mvista.com!sdake | 2005-06-17 11:36:35 -0700 (Fri, 17 Jun 2005) | 2 lines

Initial revision

------------------------------------------------------------------------
r666 | osdl.net!markh | 2005-06-15 14:09:42 -0700 (Wed, 15 Jun 2005) | 9 lines

Merge markh@bk.osdl.org:/var/bk/openais
into markh1.pdx.osdl.net:/home/localmarkh/views/BK/openais_work

2005/06/15 14:09:09-07:00 osdl.net!markh
Fix version handling code to be B spec compliant.
BUG 623.

BKrev: 42b09916lexB-dFgQMudnN6k_mmmkw

------------------------------------------------------------------------
r665 | osdl.net!markh | 2005-06-15 14:09:42 -0700 (Wed, 15 Jun 2005) | 5 lines

Fix version handling code to be B spec compliant.
BUG 623.

(Logical change 1.206)

------------------------------------------------------------------------
r664 | osdl.net!markh | 2005-06-15 14:09:42 -0700 (Wed, 15 Jun 2005) | 8 lines

Auto merged

2005/06/15 14:09:08-07:00 osdl.net!markh
Fix version handling code to be B spec compliant.
BUG 623.

(Logical change 1.206)

------------------------------------------------------------------------
r663 | osdl.net!markh | 2005-06-15 14:04:28 -0700 (Wed, 15 Jun 2005) | 6 lines

Move the closing of file descriptors from the destructor to
the finalize function.  This allows threads waiting on poll to
wake up and release handle references.

BKrev: 42b097dceYknwQw6iUHoWmtoiZRCAQ

------------------------------------------------------------------------
r662 | osdl.net!markh | 2005-06-15 14:04:28 -0700 (Wed, 15 Jun 2005) | 6 lines

Move the closing of file descriptors from the destructor to
the finalize function.  This allows threads waiting on poll to
wake up and release handle references.

(Logical change 1.205)

------------------------------------------------------------------------
r661 | osdl.net!markh | 2005-06-13 13:07:55 -0700 (Mon, 13 Jun 2005) | 4 lines

Fixes to patterns and filters for B API spec support.

(Logical change 1.204)

------------------------------------------------------------------------
r660 | osdl.net!markh | 2005-06-13 13:07:55 -0700 (Mon, 13 Jun 2005) | 4 lines

Fixes to patterns and filters for B API spec support.

BKrev: 42ade79b0MPjVuydg8XjvOCQs9MTkw

------------------------------------------------------------------------
r659 | mvista.com!sdake | 2005-06-07 14:23:48 -0700 (Tue, 07 Jun 2005) | 6 lines

totempg.c:
  defect 604
  report fragmentation messages missing.

BKrev: 42a61064-RatmX2Oh0W-yAQkVrhuLA

------------------------------------------------------------------------
r658 | mvista.com!sdake | 2005-06-07 14:23:48 -0700 (Tue, 07 Jun 2005) | 5 lines

defect 604
report fragmentation messages missing.

(Logical change 1.203)

------------------------------------------------------------------------
r657 | mvista.com!sdake | 2005-06-06 13:35:05 -0700 (Mon, 06 Jun 2005) | 6 lines

defect 600
Qian Zhang reported defect 599 which was a missing
pthread_mutex_unlock.  Patch attached to fix it.

(Logical change 1.202)

------------------------------------------------------------------------
r656 | mvista.com!sdake | 2005-06-06 13:35:05 -0700 (Mon, 06 Jun 2005) | 2 lines

(Logical change 1.202)

------------------------------------------------------------------------
r655 | mvista.com!sdake | 2005-06-06 13:35:05 -0700 (Mon, 06 Jun 2005) | 7 lines

clm.c:
  defect 600
  Qian Zhang reported defect 599 which was a missing
  pthread_mutex_unlock.  Patch attached to fix it.

BKrev: 42a4b379jtJP5rnRmyVL92o1PyIDDw

------------------------------------------------------------------------
r654 | mvista.com!sdake | 2005-06-06 13:33:59 -0700 (Mon, 06 Jun 2005) | 7 lines

clm.c:
  defect 599
  Qian Zhang reported defect 599 which was a missing
  pthread_mutex_unlock.  Patch attached to fix it.

BKrev: 42a4b337flt6FdzG6hqwbxOqSyl59w

------------------------------------------------------------------------
r653 | mvista.com!sdake | 2005-06-06 13:33:59 -0700 (Mon, 06 Jun 2005) | 6 lines

defect 599
Qian Zhang reported defect 599 which was a missing
pthread_mutex_unlock.  Patch attached to fix it.

(Logical change 1.201)

------------------------------------------------------------------------
r652 | mvista.com!sdake | 2005-06-06 13:19:36 -0700 (Mon, 06 Jun 2005) | 8 lines

ipc_ckpt.h, testckpt.c, ckptbench.c, util.c, ckpt.c:
  defect 595
  There are various bugs with saCkptCheckpointOpenAsync that result in it
  crashing the executive, library, or just failing the saftest conformance
  suite.

BKrev: 42a4afd8Fg5CFXDzyZ_v5qo_ad-Guw

------------------------------------------------------------------------
r651 | mvista.com!sdake | 2005-06-06 13:19:36 -0700 (Mon, 06 Jun 2005) | 7 lines

defect 595
There are various bugs with saCkptCheckpointOpenAsync that result in it
crashing the executive, library, or just failing the saftest conformance
suite..

(Logical change 1.200)

------------------------------------------------------------------------
r650 | mvista.com!sdake | 2005-06-06 13:19:36 -0700 (Mon, 06 Jun 2005) | 7 lines

defect 595
There are various bugs with saCkptCheckpointOpenAsync that result in it
crashing the executive, library, or just failing the saftest conformance
suite.

(Logical change 1.200)

------------------------------------------------------------------------
r649 | mvista.com!sdake | 2005-06-06 13:12:20 -0700 (Mon, 06 Jun 2005) | 5 lines

ckpt.c:
  The selection object get in sync with openAsync doesn't work.

BKrev: 42a4ae24bww-nX_J3YlTL9lMO3KZvQ

------------------------------------------------------------------------
r648 | mvista.com!sdake | 2005-06-06 13:12:20 -0700 (Mon, 06 Jun 2005) | 4 lines

The selection object get in sync with openAsync doesn't work.

(Logical change 1.199)

------------------------------------------------------------------------
r647 | mvista.com!sdake | 2005-06-06 13:11:20 -0700 (Mon, 06 Jun 2005) | 7 lines

ckpt.c, ipc_ckpt.h:
  defect 592
  If ActiveReplicaSet is called, the correct return values are not
  returned, causing failures in the saf test suite.

BKrev: 42a4ade8M7A9p_GJDKQGsWWbJxc41w

------------------------------------------------------------------------
r646 | mvista.com!sdake | 2005-06-06 13:11:20 -0700 (Mon, 06 Jun 2005) | 6 lines

defect 592
If ActiveReplicaSet is called, the correct return values are not
returned, causing failures in the saf test suite.

(Logical change 1.198)

------------------------------------------------------------------------
r645 | mvista.com!sdake | 2005-06-06 13:10:13 -0700 (Mon, 06 Jun 2005) | 7 lines

defect 591
If checkpoint open is called, but checkpoint close isn't called before
saCkptFinalize is called, the reference count of the checkpoints gets
out of kilter.

(Logical change 1.197)

------------------------------------------------------------------------
r644 | mvista.com!sdake | 2005-06-06 13:10:13 -0700 (Mon, 06 Jun 2005) | 8 lines

ckpt.c:
  defect 591
  If checkpoint open is called, but checkpoint close isn't called before
  saCkptFinalize is called, the reference count of the checkpoints gets
  out of kilter.

BKrev: 42a4ada5nUMOYQy74W2MQ1eTlNNC0g

------------------------------------------------------------------------
r643 | mvista.com!sdake | 2005-05-26 15:37:31 -0700 (Thu, 26 May 2005) | 2 lines

(Logical change 1.196)

------------------------------------------------------------------------
r642 | mvista.com!sdake | 2005-05-26 15:37:31 -0700 (Thu, 26 May 2005) | 4 lines

adds evs_membership_get api

(Logical change 1.196)

------------------------------------------------------------------------
r641 | mvista.com!sdake | 2005-05-26 15:37:31 -0700 (Thu, 26 May 2005) | 7 lines

Many files:
  adds evs_membership_get api
evs_membership_get.3:
  new file

BKrev: 42964fab28riN6pUGbG3uqbjbAjKcA

------------------------------------------------------------------------
r640 | mvista.com!sdake | 2005-05-26 15:37:30 -0700 (Thu, 26 May 2005) | 2 lines

Initial revision

------------------------------------------------------------------------
r639 | osdl.net!markh | 2005-05-26 15:19:26 -0700 (Thu, 26 May 2005) | 6 lines

Allow services to use the openais.conf file for setting custom options.
Evt now allows the maximum delivery queue size and the resume size to be
set in openais.conf

(Logical change 1.195)

------------------------------------------------------------------------
r638 | osdl.net!markh | 2005-05-26 15:19:26 -0700 (Thu, 26 May 2005) | 6 lines

Allow services to use the openais.conf file for setting custom options.
Evt now allows the maximum delivery queue size and the resume size to be
set in openais.conf

BKrev: 42964b6eDjhuwHSUD_2OVfOPwqZf3w

------------------------------------------------------------------------
r637 | osdl.net!markh | 2005-05-26 15:19:26 -0700 (Thu, 26 May 2005) | 4 lines

Allow services to use the openais.conf file for setting custom options.

(Logical change 1.195)

------------------------------------------------------------------------
r636 | sakai!sakai | 2005-05-25 13:47:14 -0700 (Wed, 25 May 2005) | 4 lines

Failover doesn't happen when CTL-Z and process kill

(Logical change 1.194)

------------------------------------------------------------------------
r635 | osdl.net!markh | 2005-05-25 13:47:14 -0700 (Wed, 25 May 2005) | 9 lines

Merge markh@bk.osdl.org:/var/bk/openais
into markh1.pdx.osdl.net:/home/localmarkh/views/BK/openais_work

2005/05/18 01:03:02+09:00 sakai!sakai
amf.c:
  Failover doesn't happen when CTL-Z and process kill

BKrev: 4294e4525GqfTV54xRLGWs-383Stsg

------------------------------------------------------------------------
r634 | osdl.net!markh | 2005-05-25 13:46:41 -0700 (Wed, 25 May 2005) | 4 lines

More updates to make event conform to B spec.

BKrev: 4294e431odUeu4s7HWbqMRrsByv4rQ

------------------------------------------------------------------------
r633 | osdl.net!markh | 2005-05-25 13:46:41 -0700 (Wed, 25 May 2005) | 4 lines

More updates to make event conform to B spec.

(Logical change 1.193)

------------------------------------------------------------------------
r632 | osdl.net!markh | 2005-05-25 13:42:45 -0700 (Wed, 25 May 2005) | 4 lines

Fix memory leak.

BKrev: 4294e345EM8L82mcgFGtNXNOOrANVg

------------------------------------------------------------------------
r631 | osdl.net!markh | 2005-05-25 13:42:45 -0700 (Wed, 25 May 2005) | 4 lines

Fix memory leak.

(Logical change 1.192)

------------------------------------------------------------------------
r630 | osdl.net!markh | 2005-05-04 10:08:55 -0700 (Wed, 04 May 2005) | 4 lines

Added a description of the timeout section of openais.conf

(Logical change 1.191)

------------------------------------------------------------------------
r629 | osdl.net!markh | 2005-05-04 10:08:55 -0700 (Wed, 04 May 2005) | 4 lines

Add support for user specified timeouts from openais.conf

BKrev: 427901a7TTHofqEBWm_tyZgxLVSn8g

------------------------------------------------------------------------
r628 | osdl.net!markh | 2005-05-04 10:08:55 -0700 (Wed, 04 May 2005) | 4 lines

Add support for user specified timeouts from openais.conf

(Logical change 1.191)

------------------------------------------------------------------------
r627 | mvista.com!sdake | 2005-04-29 14:10:39 -0700 (Fri, 29 Apr 2005) | 5 lines

defect 529
dont ignore commit token which was causing strange semantics.

(Logical change 1.190)

------------------------------------------------------------------------
r626 | mvista.com!sdake | 2005-04-29 14:10:39 -0700 (Fri, 29 Apr 2005) | 6 lines

totemsrp.c:
  defect 529
  dont ignore commit token which was causing strange semantics.

BKrev: 4272a2cfQng6C3XBRPdeo8GZx7KIlQ

------------------------------------------------------------------------
r625 | mvista.com!sdake | 2005-04-22 11:46:23 -0700 (Fri, 22 Apr 2005) | 5 lines

Many files:
  defect 512 - some ais header file defines are wrong.

BKrev: 4269467fUqljxZ1cZm7rYtXJgozkZQ

------------------------------------------------------------------------
r624 | mvista.com!sdake | 2005-04-22 11:46:23 -0700 (Fri, 22 Apr 2005) | 4 lines

defect 512 - some ais header file defines are wrong.

(Logical change 1.189)

------------------------------------------------------------------------
r623 | mvista.com!sdake | 2005-04-22 11:44:20 -0700 (Fri, 22 Apr 2005) | 5 lines

totemsrp.c:
  defect 498 - reduce network traffic from merge detection

BKrev: 42694604csBxR35HgvFh1cX-WdsjPw

------------------------------------------------------------------------
r622 | mvista.com!sdake | 2005-04-22 11:44:20 -0700 (Fri, 22 Apr 2005) | 4 lines

defect 498 - reduce network traffic from merge detection

(Logical change 1.188)

------------------------------------------------------------------------
r621 | mvista.com!sdake | 2005-04-21 11:32:17 -0700 (Thu, 21 Apr 2005) | 5 lines

testckpt.c, ckpt.c, ipc_ckpt.h:
  defect 323 - defect 410 - CheckpointOpenAsync and Dispatch not working

BKrev: 4267f1b1iKpaZFwASGi0Hpg6NPVlvA

------------------------------------------------------------------------
r620 | mvista.com!sdake | 2005-04-21 11:32:17 -0700 (Thu, 21 Apr 2005) | 4 lines

defect 323 - defect 410 - CheckpointOpenAsync and Dispatch not working

(Logical change 1.187)

------------------------------------------------------------------------
r619 | mvista.com!sdake | 2005-04-20 17:57:34 -0700 (Wed, 20 Apr 2005) | 4 lines

defect 505 - fix uncompilable with gcc 2.95

(Logical change 1.186)

------------------------------------------------------------------------
r618 | mvista.com!sdake | 2005-04-20 17:57:34 -0700 (Wed, 20 Apr 2005) | 5 lines

ckpt-wr.c, evt.c, ckpt.c, amf.c:
  defect 505 - fix uncompilable with gcc 2.95

BKrev: 4266fa7e2AAxpdYH2FJH4NEZ75Hc9w

------------------------------------------------------------------------
r617 | osdl.net!markh | 2005-04-20 15:13:34 -0700 (Wed, 20 Apr 2005) | 6 lines

Defect 501.

Fix some mutex and error return problems.

(Logical change 1.185)

------------------------------------------------------------------------
r616 | osdl.net!markh | 2005-04-20 15:13:34 -0700 (Wed, 20 Apr 2005) | 6 lines

Defect 501.

Fix some mutex and error return problems.

BKrev: 4266d40eIENsfJQEvDM6MjMDhFcqLA

------------------------------------------------------------------------
r615 | osdl.net!markh | 2005-04-20 14:46:14 -0700 (Wed, 20 Apr 2005) | 6 lines

For defect 501.
Fix possible stale pointers in async lists if an application
disconnects before its command has been fully processed.

(Logical change 1.184)

------------------------------------------------------------------------
r614 | osdl.net!markh | 2005-04-20 14:46:14 -0700 (Wed, 20 Apr 2005) | 10 lines

Merge markh@bk.osdl.org:/var/bk/openais
into markh1.pdx.osdl.net:/home/localmarkh/views/BK/openais_work

2005/04/20 14:43:05-07:00 osdl.net!markh
For defect 501.
Fix possible stale pointers in async lists if an application
disconnects before its command has been fully processed.

BKrev: 4266cda65e-fXv0kW4Qe-4Fr4Sbrww

------------------------------------------------------------------------
r613 | mvista.com!sdake | 2005-04-18 14:27:27 -0700 (Mon, 18 Apr 2005) | 5 lines

evs.c:
  defect 42 - evs service doesn't send config change on evs_initialize

BKrev: 4264263fzzgV2yL8rAEqgs69wjGnZA

------------------------------------------------------------------------
r612 | mvista.com!sdake | 2005-04-18 14:27:27 -0700 (Mon, 18 Apr 2005) | 4 lines

defect 42 - evs service doesn't send config change on evs_initialize

(Logical change 1.183)

------------------------------------------------------------------------
r611 | mvista.com!sdake | 2005-04-18 12:53:25 -0700 (Mon, 18 Apr 2005) | 5 lines

totemsrp.c:
  Fix assert when recovery fails and messages are accepted in the gather state.

BKrev: 42641035MxBKYwCZ1zOkFr_h-WES3Q

------------------------------------------------------------------------
r610 | mvista.com!sdake | 2005-04-18 12:53:25 -0700 (Mon, 18 Apr 2005) | 4 lines

Fix assert when recovery fails and messages are accepted in the gather state.

(Logical change 1.182)

------------------------------------------------------------------------
r609 | mvista.com!sdake | 2005-04-15 16:30:39 -0700 (Fri, 15 Apr 2005) | 7 lines

totemsrp.c:
  Fixes a condition which would result in a proc set and failed set
  being equal which would force the algorithm to never reach
  consensus in the membership algorithm.

BKrev: 42604e9fCBYactncuQuguPZ_IEfQsQ

------------------------------------------------------------------------
r608 | mvista.com!sdake | 2005-04-15 16:30:39 -0700 (Fri, 15 Apr 2005) | 6 lines

Fixes a condition which would result in a proc set and failed set
being equal which would force the algorithm to never reach
consensus in the membership algorithm.

(Logical change 1.181)

------------------------------------------------------------------------
r607 | mvista.com!sdake | 2005-04-15 16:29:31 -0700 (Fri, 15 Apr 2005) | 5 lines

totem packet size changed from 1408 to 1404 because a field was
added to the mcast header.

(Logical change 1.180)

------------------------------------------------------------------------
r606 | mvista.com!sdake | 2005-04-15 16:29:31 -0700 (Fri, 15 Apr 2005) | 4 lines

add some sort queue functions.

(Logical change 1.180)

------------------------------------------------------------------------
r605 | mvista.com!sdake | 2005-04-15 16:29:31 -0700 (Fri, 15 Apr 2005) | 11 lines

turn off random dropping of packets by default.

2005/04/15 16:27:14-07:00 mvista.com!sdake
Major fixes to the recovery phase of the totem protocol.  The
remainder of the protocol remains unchanged.
The protocol now properly adds the right messages to the right
queues during recovery.  The protocol properly handles failures
in the recovery state.

(Logical change 1.180)

------------------------------------------------------------------------
r604 | mvista.com!sdake | 2005-04-15 16:29:31 -0700 (Fri, 15 Apr 2005) | 18 lines

totemsrp.c:
  turn off random dropping of packets by default.
totemsrp.h:
  totem packet size changed from 1408 to 1404 because a field was
  added to the mcast header.
sq.h:
  add some sort queue functions.
totemsrp.c:
  Major fixes to the recovery phase of the totem protocol.  The
  remainder of the protocol remains unchanged.
  The protocol now properly adds the right messages to the right
  queues during recovery.  The protocol properly handles failures
  in the recovery state.
totempg.c:
  add an assert to catch a weird case.

BKrev: 42604e5bSfwCdUnySrgU1nlV7yDYNQ

------------------------------------------------------------------------
r603 | mvista.com!sdake | 2005-04-15 16:29:31 -0700 (Fri, 15 Apr 2005) | 4 lines

add an assert to catch a weird case.

(Logical change 1.180)

------------------------------------------------------------------------
r602 | mvista.com!sdake | 2005-04-15 14:15:41 -0700 (Fri, 15 Apr 2005) | 5 lines

crypto.c:
  autodetect endian and wordsize with gnuisms

BKrev: 42602efdZ8LfQwIHBFrdtsjrK3BtCg

------------------------------------------------------------------------
r601 | mvista.com!sdake | 2005-04-15 14:15:41 -0700 (Fri, 15 Apr 2005) | 4 lines

autodetect endian and wordsize with gnuisms

(Logical change 1.179)

------------------------------------------------------------------------
r600 | mvista.com!sdake | 2005-04-15 14:07:01 -0700 (Fri, 15 Apr 2005) | 5 lines

evs.c:
  fix defect 477 - header size calculated incorrectly results in assert

BKrev: 42602cf5j6Zi2RZtyz9xB83lZW9R6g

------------------------------------------------------------------------
r599 | mvista.com!sdake | 2005-04-15 14:07:01 -0700 (Fri, 15 Apr 2005) | 4 lines

fix defect 477 - header size calculated incorrectly results in assert

(Logical change 1.178)

------------------------------------------------------------------------
r598 | mvista.com!sdake | 2005-04-15 13:48:57 -0700 (Fri, 15 Apr 2005) | 9 lines

Merge sdake@bk.osdl.org:/var/bk/openais
into persist.az.mvista.com:/home/sdake/openais

2005/04/15 13:48:35-07:00 mvista.com!sdake
Makefile, util.h, util.c, evt.c, evs.c, clm.c, ckpt.c, amf.c:
  defect 188 missed initial checkin

BKrev: 426028b9DQDC6BgUEBBsQmVJmhyxOg

------------------------------------------------------------------------
r597 | mvista.com!sdake | 2005-04-15 13:48:57 -0700 (Fri, 15 Apr 2005) | 4 lines

defect 188 missed initial checkin

(Logical change 1.177)

------------------------------------------------------------------------
r596 | osdl.net!markh | 2005-04-15 13:05:46 -0700 (Fri, 15 Apr 2005) | 4 lines

Test updates to handle SA_AIS_ERR_TRY_AGAIN return codes.

(Logical change 1.176)

------------------------------------------------------------------------
r595 | osdl.net!markh | 2005-04-15 13:05:46 -0700 (Fri, 15 Apr 2005) | 8 lines

Merge markh@bk.osdl.org:/var/bk/openais
into markh1.pdx.osdl.net:/home/localmarkh/views/BK/openais_work

2005/04/15 13:01:00-07:00 osdl.net!markh
Test updates to handle SA_AIS_ERR_TRY_AGAIN return codes.

BKrev: 42601e9aBWGIREypBcTjO5NC8bK8uA

------------------------------------------------------------------------
r594 | mvista.com!sdake | 2005-04-15 12:08:20 -0700 (Fri, 15 Apr 2005) | 4 lines

defect 188 - use two fds instead of one fd for I/Os to executive

(Logical change 1.175)

------------------------------------------------------------------------
r593 | mvista.com!sdake | 2005-04-15 12:08:20 -0700 (Fri, 15 Apr 2005) | 7 lines

Many files:
  defect 188 - use two fds instead of one fd for I/Os to executive
testevsth.c:
  test evs threading

BKrev: 42601124xiPxCobiccGpS7CZ62Ol7w

------------------------------------------------------------------------
r592 | mvista.com!sdake | 2005-04-15 12:08:20 -0700 (Fri, 15 Apr 2005) | 2 lines

(Logical change 1.175)

------------------------------------------------------------------------
r591 | mvista.com!sdake | 2005-04-15 12:08:19 -0700 (Fri, 15 Apr 2005) | 2 lines

Initial revision

------------------------------------------------------------------------
r590 | mvista.com!sdake | 2005-04-15 12:03:18 -0700 (Fri, 15 Apr 2005) | 4 lines

defect 478 - remove extra parameter to config change.

(Logical change 1.174)

------------------------------------------------------------------------
r589 | mvista.com!sdake | 2005-04-15 12:03:18 -0700 (Fri, 15 Apr 2005) | 5 lines

Many files:
  defect 478 - remove extra parameter to config change.

BKrev: 42600ff6Tg7hfUjwYnckeK8uBxBGrg

------------------------------------------------------------------------
r588 | mvista.com!sdake | 2005-04-11 14:33:33 -0700 (Mon, 11 Apr 2005) | 5 lines

Fix defect 456
when checkpoint expirse, the executive crashes if no bind address was specified

(Logical change 1.173)

------------------------------------------------------------------------
r587 | mvista.com!sdake | 2005-04-11 14:33:33 -0700 (Mon, 11 Apr 2005) | 6 lines

main.c:
  Fix defect 456
  when checkpoint expirse, the executive crashes if no bind address was specified

BKrev: 425aed2d6P3dBt_7UO1Cv6d5kt4haQ

------------------------------------------------------------------------
r586 | mvista.com!sdake | 2005-04-11 14:25:27 -0700 (Mon, 11 Apr 2005) | 4 lines

add default section to testcase

(Logical change 1.172)

------------------------------------------------------------------------
r585 | mvista.com!sdake | 2005-04-11 14:25:27 -0700 (Mon, 11 Apr 2005) | 4 lines

add default section to testcase.

(Logical change 1.172)

------------------------------------------------------------------------
r584 | mvista.com!sdake | 2005-04-11 14:25:27 -0700 (Mon, 11 Apr 2005) | 4 lines

Add default section support to checkpoints.

(Logical change 1.172)

------------------------------------------------------------------------
r583 | mvista.com!sdake | 2005-04-11 14:25:27 -0700 (Mon, 11 Apr 2005) | 2 lines

(Logical change 1.172)

------------------------------------------------------------------------
r582 | mvista.com!sdake | 2005-04-11 14:25:27 -0700 (Mon, 11 Apr 2005) | 7 lines

testckpt.c, ckpt-rd.c, ckpt-wr:
  add default section to testcase.
ckpt.c:
  Add default section support to checkpoints.

BKrev: 425aeb47Mb_N8HKGtX_BdmRGaLP-Jg

------------------------------------------------------------------------
r581 | mvista.com!sdake | 2005-04-08 14:12:48 -0700 (Fri, 08 Apr 2005) | 7 lines

ckpt.c:
  Patch from Muni and Mark to properly calculate the header size
  field so that the totem delivery assertion doesn't assert when
  using ckpt services.

BKrev: 4256f3d0FFsh6CwpsXs-w4_225C4Wg

------------------------------------------------------------------------
r580 | mvista.com!sdake | 2005-04-08 14:12:48 -0700 (Fri, 08 Apr 2005) | 6 lines

Patch from Muni and Mark to properly calculate the header size
field so that the totem delivery assertion doesn't assert when
using ckpt services.

(Logical change 1.171)

------------------------------------------------------------------------
r579 | osdl.net!markh | 2005-04-06 12:37:30 -0700 (Wed, 06 Apr 2005) | 5 lines

Make sure that the message count in the message matches the actual length
of the message.

BKrev: 42543a7aj_fChUtiZ_ZWH0wdZ6JN3Q

------------------------------------------------------------------------
r578 | osdl.net!markh | 2005-04-06 12:37:30 -0700 (Wed, 06 Apr 2005) | 5 lines

Make sure that the message count in the message matches the actual length
of the message.

(Logical change 1.170)

------------------------------------------------------------------------
r577 | osdl.net!markh | 2005-04-05 08:56:49 -0700 (Tue, 05 Apr 2005) | 10 lines

Merge markh@bk.osdl.org:/var/bk/openais
into markh1.pdx.osdl.net:/home/localmarkh/views/BK/openais_work

2005/04/05 08:56:39-07:00 osdl.net!markh
Replace assert with a return.  This will allow the custer to continue
to run.  This happens when a joining node receives a message from a node
that it doesn't know about yet.  This is a temporary fix for now.

BKrev: 4252b541e1CWSNFoD816nTIzzKKPDg

------------------------------------------------------------------------
r576 | osdl.net!markh | 2005-04-05 08:56:49 -0700 (Tue, 05 Apr 2005) | 6 lines

Replace assert with a return.  This will allow the custer to continue
to run.  This happens when a joining node receives a message from a node
that it doesn't know about yet.  This is a temporary fix for now.

(Logical change 1.169)

------------------------------------------------------------------------
r575 | mvista.com!sdake | 2005-04-04 18:51:09 -0700 (Mon, 04 Apr 2005) | 4 lines

Patch from Miyotaka Sakai to fix access to free area defect 426.

(Logical change 1.168)

------------------------------------------------------------------------
r574 | mvista.com!sdake | 2005-04-04 18:51:09 -0700 (Mon, 04 Apr 2005) | 5 lines

totemsrp.c:
  Patch from Miyotaka Sakai to fix access to free area defect 426.

BKrev: 4251ef0dubnPmmnqD-elKTQ_vgpq9Q

------------------------------------------------------------------------
r573 | mvista.com!sdake | 2005-04-01 14:20:11 -0700 (Fri, 01 Apr 2005) | 4 lines

change around this_ip to better support ifup/ifdown

(Logical change 1.167)

------------------------------------------------------------------------
r572 | mvista.com!sdake | 2005-04-01 14:20:11 -0700 (Fri, 01 Apr 2005) | 4 lines

add some support functions relating to this_ip

(Logical change 1.167)

------------------------------------------------------------------------
r571 | mvista.com!sdake | 2005-04-01 14:20:11 -0700 (Fri, 01 Apr 2005) | 4 lines

add ifup/ifdown binding to totem single ring protocol

(Logical change 1.167)

------------------------------------------------------------------------
r570 | mvista.com!sdake | 2005-04-01 14:20:11 -0700 (Fri, 01 Apr 2005) | 4 lines

minor improvements to the ckpt tests

(Logical change 1.167)

------------------------------------------------------------------------
r569 | mvista.com!sdake | 2005-04-01 14:20:11 -0700 (Fri, 01 Apr 2005) | 11 lines

testckpt.c:
  minor improvements to the ckpt tests
totemsrp.h, totemsrp.c:
  add ifup/ifdown binding to totem single ring protocol
main.h, main.c:
  add some support functions relating to this_ip
clm.c, ckpt.c, amf.c:
  change around this_ip to better support ifup/ifdown

BKrev: 424dbb0bUeDXpnbGn8TxJlPYWRvT6A

------------------------------------------------------------------------
r568 | sakai!sakai | 2005-03-30 15:29:58 -0700 (Wed, 30 Mar 2005) | 4 lines

fix not to transit state when process terminate

(Logical change 1.166)

------------------------------------------------------------------------
r567 | sakai!sakai | 2005-03-30 15:29:58 -0700 (Wed, 30 Mar 2005) | 5 lines

amf.c:
  fix not to transit state when process terminate

BKrev: 424b286648uPUwF_B-hMgKOF5Mgwzw

------------------------------------------------------------------------
r566 | mvista.com!sdake | 2005-03-30 14:26:35 -0700 (Wed, 30 Mar 2005) | 7 lines

Updated with comments from Michael Howard
added evt and evs service tests to quickstart information
added text about running as root
removed default route setup instructions since they are no longer needed.

(Logical change 1.165)

------------------------------------------------------------------------
r565 | mvista.com!sdake | 2005-03-30 14:26:35 -0700 (Wed, 30 Mar 2005) | 8 lines

QUICKSTART:
  Updated with comments from Michael Howard
  added evt and evs service tests to quickstart information
  added text about running as root
  removed default route setup instructions since they are no longer needed.

BKrev: 424b198bYLqB2blTRdYtgLgjFmHjIA

------------------------------------------------------------------------
r564 | mvista.com!sdake | 2005-03-29 15:43:15 -0700 (Tue, 29 Mar 2005) | 13 lines

Merge sdake@bk.osdl.org:/var/bk/openais
into persist.az.mvista.com:/home/sdake/openais

2005/03/29 15:03:30-07:00 mvista.com!sdake
testckpt.c:
  Create section after section is unlinked in test code.
ckpt.c:
  Patch from Muni Bajpai to not setup a cleanup handler for a
  checkpoint when a checkpoint open fails.  Patch also fixes up
  checkpoint iterators so they do not crash on process exit.

BKrev: 4249da03fKPlzZG0QP8eZriaAtoM-w

------------------------------------------------------------------------
r563 | mvista.com!sdake | 2005-03-29 15:43:15 -0700 (Tue, 29 Mar 2005) | 6 lines

Patch from Muni Bajpai to not setup a cleanup handler for a
checkpoint when a checkpoint open fails.  Patch also fixes up
checkpoint iterators so they do not crash on process exit.

(Logical change 1.164)

------------------------------------------------------------------------
r562 | mvista.com!sdake | 2005-03-29 15:43:15 -0700 (Tue, 29 Mar 2005) | 4 lines

Create section after section is unlinked in test code.

(Logical change 1.164)

------------------------------------------------------------------------
r561 | sakai!sakai | 2005-03-28 15:49:18 -0700 (Mon, 28 Mar 2005) | 4 lines

fix configuration change

(Logical change 1.163)

------------------------------------------------------------------------
r560 | sakai!sakai | 2005-03-28 15:49:18 -0700 (Mon, 28 Mar 2005) | 5 lines

amf.c:
  fix configuration change

BKrev: 424889eehbHC-A5YNtbXzaEzVMhcVQ

------------------------------------------------------------------------
r559 | mvista.com!sdake | 2005-03-28 11:57:21 -0700 (Mon, 28 Mar 2005) | 4 lines

Remove extra debug printf.

(Logical change 1.162)

------------------------------------------------------------------------
r558 | mvista.com!sdake | 2005-03-28 11:57:21 -0700 (Mon, 28 Mar 2005) | 5 lines

totemsrp.c:
  Remove extra debug printf.

BKrev: 42485391qM7HG2et7RcmNIHInqXxTA

------------------------------------------------------------------------
r557 | mvista.com!sdake | 2005-03-28 11:39:16 -0700 (Mon, 28 Mar 2005) | 17 lines

defect 368
A report of totemsrp not merging configurations led to this
enhancement.

totemsrp.c:
  The totem protocol would not previously merge a configuration
  until a multicast message was sent.  This change sends a special
  "merge detect" message if no message has been multicast in some
  time from the representative.  This merge detect message will
  trigger other processors to enter the gather state and form
  a new configuration if they were not previously part of the
  current configuration.
Makefile:
  Build aisexec when libtotem.a changes.

BKrev: 42484f5453Wf6HN2Gbyg9dznFaQGtw

------------------------------------------------------------------------
r556 | mvista.com!sdake | 2005-03-28 11:39:16 -0700 (Mon, 28 Mar 2005) | 10 lines

The totem protocol would not previously merge a configuration
until a multicast message was sent.  This change sends a special
"merge detect" message if no message has been multicast in some
time from the representative.  This merge detect message will
trigger other processors to enter the gather state and form
a new configuration if they were not previously part of the
current configuration.

(Logical change 1.161)

------------------------------------------------------------------------
r555 | mvista.com!sdake | 2005-03-28 11:39:16 -0700 (Mon, 28 Mar 2005) | 4 lines

Build aisexec when libtotem.a changes.

(Logical change 1.161)

------------------------------------------------------------------------
r554 | osdl.net!markh | 2005-03-28 11:22:39 -0700 (Mon, 28 Mar 2005) | 6 lines

This update allows retained events from a merging partition to
be delivered to applications with the associated channels already
open at the time of the merge.

BKrev: 42484b6f0IXKK1Bql-GCaHwTbXg0dQ

------------------------------------------------------------------------
r553 | osdl.net!markh | 2005-03-28 11:22:39 -0700 (Mon, 28 Mar 2005) | 6 lines

This update allows retained events from a merging partition to
be delivered to applications with the associated channels already
open at the time of the merge.

(Logical change 1.160)

------------------------------------------------------------------------
r552 | osdl.net!markh | 2005-03-28 10:26:27 -0700 (Mon, 28 Mar 2005) | 5 lines

Async open and subscribe needed to check for registered call back
functions and retrun an error if there were no assocated callbacks.

BKrev: 42483e43sOS_W8zCqoAZNHTy43FhkA

------------------------------------------------------------------------
r551 | osdl.net!markh | 2005-03-28 10:26:27 -0700 (Mon, 28 Mar 2005) | 5 lines

Async open and subscribe needed to check for registered call back
functions and retrun an error if there were no assocated callbacks.

(Logical change 1.159)

------------------------------------------------------------------------
r550 | osdl.net!markh | 2005-03-23 13:12:44 -0700 (Wed, 23 Mar 2005) | 4 lines

Only dispatch a callback if it is non-null.

(Logical change 1.158)

------------------------------------------------------------------------
r549 | osdl.net!markh | 2005-03-23 13:12:44 -0700 (Wed, 23 Mar 2005) | 4 lines

Only dispatch a callback if it is non-null.

BKrev: 4241cdbcbgCCwsZLJEXicZZTvGpuGQ

------------------------------------------------------------------------
r548 | mvista.com!sdake | 2005-03-22 16:37:45 -0700 (Tue, 22 Mar 2005) | 4 lines

defect325 - rename saCkptActiveCheckpointSet to saCkptActiveReplicaSet

(Logical change 1.157)

------------------------------------------------------------------------
r547 | mvista.com!sdake | 2005-03-22 16:37:45 -0700 (Tue, 22 Mar 2005) | 5 lines

ckpt.c:
  defect325 - rename saCkptActiveCheckpointSet to saCkptActiveReplicaSet

BKrev: 4240ac49svEd0Uoaf0zn8-6YXK5akw

------------------------------------------------------------------------
r546 | mvista.com!sdake | 2005-03-22 16:36:53 -0700 (Tue, 22 Mar 2005) | 6 lines

Makefile:
  Link to seperate libraries.
  Provide seperate libraries per service as well as the consolidated libais library.

BKrev: 4240ac15wtabDEmO2ooaShdbFZP-wg

------------------------------------------------------------------------
r545 | mvista.com!sdake | 2005-03-22 16:36:53 -0700 (Tue, 22 Mar 2005) | 4 lines

Link to seperate libraries.

(Logical change 1.156)

------------------------------------------------------------------------
r544 | mvista.com!sdake | 2005-03-22 16:36:53 -0700 (Tue, 22 Mar 2005) | 4 lines

Provide seperate libraries per service as well as the consolidated libais library.

(Logical change 1.156)

------------------------------------------------------------------------
r543 | osdl.net!markh | 2005-03-22 16:22:34 -0700 (Tue, 22 Mar 2005) | 5 lines

Fix an off by one error causing a bad event ID to be sent after
a recovery in some cases.

BKrev: 4240a8ba6cGIAgqLoTZNAUZJJOgyrg

------------------------------------------------------------------------
r542 | osdl.net!markh | 2005-03-22 16:22:34 -0700 (Tue, 22 Mar 2005) | 5 lines

Fix an off by one error causing a bad event ID to be sent after
a recovery in some cases.

(Logical change 1.155)

------------------------------------------------------------------------
r541 | osdl.net!markh | 2005-03-17 15:44:28 -0700 (Thu, 17 Mar 2005) | 5 lines

Event service now reconciles open channels and retained events between active
merging partitions.

(Logical change 1.154)

------------------------------------------------------------------------
r540 | osdl.net!markh | 2005-03-17 15:44:28 -0700 (Thu, 17 Mar 2005) | 9 lines

Merge markh@bk.osdl.org:/var/bk/openais
into markh1.pdx.osdl.net:/home/localmarkh/views/BK/openais_work

2005/03/17 14:44:09-08:00 osdl.net!markh
Event service now reconciles open channels and retained events between active
merging partitions.

BKrev: 423a084c-3ULQ_tcgSf5isGBiqzUWA

------------------------------------------------------------------------
r539 | mvista.com!sdake | 2005-03-17 14:25:31 -0700 (Thu, 17 Mar 2005) | 9 lines

Merge sdake@bk.osdl.org:/var/bk/openais
into persist.az.mvista.com:/home/sdake/openais

2005/03/17 14:25:22-07:00 mvista.com!sdake
ckpt.c:
  Change few ERROR loggings to DEBUG loggings from Muni Bajpai.

BKrev: 4239f5cbSrwx6_k9jxG2_GjW1OoVHQ

------------------------------------------------------------------------
r538 | mvista.com!sdake | 2005-03-17 14:25:31 -0700 (Thu, 17 Mar 2005) | 4 lines

Change few ERROR loggings to DEBUG loggings from Muni Bajpai.

(Logical change 1.153)

------------------------------------------------------------------------
r537 | osdl.net!markh | 2005-03-17 11:12:22 -0700 (Thu, 17 Mar 2005) | 4 lines

Handle possible SA_AIS_ERR_TRY_AGAIN status.

BKrev: 4239c886n6J6MzMfIVjaN1QvFnsfzg

------------------------------------------------------------------------
r536 | osdl.net!markh | 2005-03-17 11:12:22 -0700 (Thu, 17 Mar 2005) | 4 lines

Handle possible SA_AIS_ERR_TRY_AGAIN status.

(Logical change 1.152)

------------------------------------------------------------------------
r535 | mvista.com!sdake | 2005-03-16 16:41:41 -0700 (Wed, 16 Mar 2005) | 4 lines

Block multicast messages during synchronization.

(Logical change 1.151)

------------------------------------------------------------------------
r534 | mvista.com!sdake | 2005-03-16 16:41:41 -0700 (Wed, 16 Mar 2005) | 7 lines

ckptbench.c:
  retry writes when it appears the system is blocked, perhaps during a resynchronization.
Many files:
  Block multicast messages during synchronization.

BKrev: 4238c435y6ZGwBr-M4xFHDUJ7HhLaQ

------------------------------------------------------------------------
r533 | mvista.com!sdake | 2005-03-16 16:41:41 -0700 (Wed, 16 Mar 2005) | 4 lines

retry writes when it appears the system is blocked, perhaps during a resynchronization.

(Logical change 1.151)

------------------------------------------------------------------------
r532 | mvista.com!sdake | 2005-03-16 11:23:54 -0700 (Wed, 16 Mar 2005) | 4 lines

cleanup some shared datatypes.

(Logical change 1.150)

------------------------------------------------------------------------
r531 | mvista.com!sdake | 2005-03-16 11:23:54 -0700 (Wed, 16 Mar 2005) | 4 lines

cleanup some shared datatypes

(Logical change 1.150)

------------------------------------------------------------------------
r530 | mvista.com!sdake | 2005-03-16 11:23:54 -0700 (Wed, 16 Mar 2005) | 2 lines

(Logical change 1.150)

------------------------------------------------------------------------
r529 | mvista.com!sdake | 2005-03-16 11:23:54 -0700 (Wed, 16 Mar 2005) | 11 lines

Mark Haverkamp reported some compile warnings with his compiler.  Cleanup
those warnings by unifying the datatypes used in totempg and totemsrp into
one set of datatypes.

Many files:
  cleanup some shared datatypes for the totem protocol.
totem.h:
  new file

BKrev: 423879baJvLZpm8nNaRfQHRfWB2fOA

------------------------------------------------------------------------
r528 | mvista.com!sdake | 2005-03-16 11:23:53 -0700 (Wed, 16 Mar 2005) | 2 lines

Initial revision

------------------------------------------------------------------------
r527 | mvista.com!sdake | 2005-03-16 11:17:48 -0700 (Wed, 16 Mar 2005) | 4 lines

Improved synchronization test code from Muni Bajpai.

(Logical change 1.149)

------------------------------------------------------------------------
r526 | mvista.com!sdake | 2005-03-16 11:17:48 -0700 (Wed, 16 Mar 2005) | 5 lines

ckpt-wr.c, ckpt-rd.c:
  Improved synchronization test code from Muni Bajpai.

BKrev: 4238784c5RBxBXc3aHA68KOVGhAEWw

------------------------------------------------------------------------
r525 | mvista.com!sdake | 2005-03-15 10:29:25 -0700 (Tue, 15 Mar 2005) | 4 lines

Fix bug in sync which caused segfault.

(Logical change 1.148)

------------------------------------------------------------------------
r524 | mvista.com!sdake | 2005-03-15 10:29:25 -0700 (Tue, 15 Mar 2005) | 7 lines

totemsrp.h, totemsrp.c:
  Allow totemsrp to remove the reference information for a token callback.
sync.c:
  Fix bug in sync which caused segfault.

BKrev: 42371b753plEvd2J96qRpg6mRxki1Q

------------------------------------------------------------------------
r523 | mvista.com!sdake | 2005-03-15 10:29:25 -0700 (Tue, 15 Mar 2005) | 4 lines

Allow totemsrp to remove the reference information for a token callback.

(Logical change 1.148)

------------------------------------------------------------------------
r522 | mvista.com!sdake | 2005-03-14 17:46:57 -0700 (Mon, 14 Mar 2005) | 4 lines

Add checkpoint reader and writer to test synchronization

(Logical change 1.147)

------------------------------------------------------------------------
r521 | mvista.com!sdake | 2005-03-14 17:46:57 -0700 (Mon, 14 Mar 2005) | 7 lines

Makefile:
  Add checkpoint reader and writer to test synchronization
ckpt-wr.c, ckpt-rd.c:
  new file

BKrev: 42363081enPpMuQpdvw2e1uqFAqD0A

------------------------------------------------------------------------
r520 | mvista.com!sdake | 2005-03-14 17:46:57 -0700 (Mon, 14 Mar 2005) | 2 lines

(Logical change 1.147)

------------------------------------------------------------------------
r519 | mvista.com!sdake | 2005-03-14 17:46:56 -0700 (Mon, 14 Mar 2005) | 2 lines

Initial revision

------------------------------------------------------------------------
r518 | mvista.com!sdake | 2005-03-14 15:39:56 -0700 (Mon, 14 Mar 2005) | 9 lines

Merge sdake@bk.osdl.org:/var/bk/openais
into persist.az.mvista.com:/home/sdake/openais

2005/03/14 15:39:42-07:00 mvista.com!sdake
ipc_gen.h, ipc_ckpt.h, ckpt.c:
  Checkpoint synchronization patch from Muni Bajpai.

BKrev: 423612bc5lRZOqj0qi_o6zXGw1bAwg

------------------------------------------------------------------------
r517 | mvista.com!sdake | 2005-03-14 15:39:56 -0700 (Mon, 14 Mar 2005) | 4 lines

Checkpoint synchronization patch from Muni Bajpai.

(Logical change 1.146)

------------------------------------------------------------------------
r516 | osdl.net!markh | 2005-03-11 12:03:05 -0700 (Fri, 11 Mar 2005) | 5 lines

Update the publish API to return SA_AIS_ERR_TRY_AGAIN to the application
instead of handling it in the library.

(Logical change 1.145)

------------------------------------------------------------------------
r515 | osdl.net!markh | 2005-03-11 12:03:05 -0700 (Fri, 11 Mar 2005) | 5 lines

Update the publish API to return SA_AIS_ERR_TRY_AGAIN to the application
instead of handling it in the library.

BKrev: 4231eb69MvlifP_ykH0Nfj693tUWMA

------------------------------------------------------------------------
r514 | osdl.net!markh | 2005-03-09 15:08:07 -0700 (Wed, 09 Mar 2005) | 5 lines

New event service recovery code implementation for totem and the new
sync services.

(Logical change 1.144)

------------------------------------------------------------------------
r513 | osdl.net!markh | 2005-03-09 15:08:07 -0700 (Wed, 09 Mar 2005) | 5 lines

New event service recovery code implementation for totem and the new
sync services.

BKrev: 422f73c7NkihQaud_tc4WYQOjavwhg

------------------------------------------------------------------------
r512 | mvista.com!sdake | 2005-03-09 12:46:11 -0700 (Wed, 09 Mar 2005) | 4 lines

Cluster membership synchronization support

(Logical change 1.143)

------------------------------------------------------------------------
r511 | mvista.com!sdake | 2005-03-09 12:46:11 -0700 (Wed, 09 Mar 2005) | 5 lines

clm.c:
  Cluster membership synchronization support

BKrev: 422f5283JgT5AkInLBoHrZMu0wx2rQ

------------------------------------------------------------------------
r510 | mvista.com!sdake | 2005-03-02 15:10:45 -0700 (Wed, 02 Mar 2005) | 13 lines

Added synchronization base code.  Four new APIs are required for a service
to support synchronization.  sync_init, sync_process, sync_activate, and
sync_abort provide the calls into the recovery mechanism.

sync.h, sync.c:
  new file
totemsrp.h, totemsrp.c, print.h, print.c, Makefile, main.c, handlers.h:
  Synchronization base code added.
ipc_gen.h:
  Synchronization base code.

BKrev: 422639e5L_FEDTWgRgI-w8vKm8zhMQ

------------------------------------------------------------------------
r509 | mvista.com!sdake | 2005-03-02 15:10:45 -0700 (Wed, 02 Mar 2005) | 4 lines

Synchronization base code.

(Logical change 1.142)

------------------------------------------------------------------------
r508 | mvista.com!sdake | 2005-03-02 15:10:45 -0700 (Wed, 02 Mar 2005) | 4 lines

Synchronization base code added.

(Logical change 1.142)

------------------------------------------------------------------------
r507 | mvista.com!sdake | 2005-03-02 15:10:45 -0700 (Wed, 02 Mar 2005) | 2 lines

(Logical change 1.142)

------------------------------------------------------------------------
r506 | mvista.com!sdake | 2005-03-02 15:10:44 -0700 (Wed, 02 Mar 2005) | 2 lines

Initial revision

------------------------------------------------------------------------
r505 | broked.org!sdake | 2005-02-26 23:27:31 -0700 (Sat, 26 Feb 2005) | 4 lines

em64t support

(Logical change 1.141)

------------------------------------------------------------------------
r504 | broked.org!sdake | 2005-02-26 23:27:31 -0700 (Sat, 26 Feb 2005) | 5 lines

Many files:
  em64t support

BKrev: 42216853DGp9Hwgh8mvnixFj_QMRUQ

------------------------------------------------------------------------
r503 | mvista.com!sdake | 2005-02-18 12:56:58 -0700 (Fri, 18 Feb 2005) | 5 lines

Many files:
  Pass handle by value instead of address.

BKrev: 4216488aoAf2Eu5qvs7qGxx8rO9zXw

------------------------------------------------------------------------
r502 | mvista.com!sdake | 2005-02-18 12:56:58 -0700 (Fri, 18 Feb 2005) | 4 lines

Pass handle by value instead of address.

(Logical change 1.140)

------------------------------------------------------------------------
r501 | mvista.com!sdake | 2005-02-16 17:25:01 -0700 (Wed, 16 Feb 2005) | 7 lines

Auto merged

2005/02/16 17:24:12-07:00 mvista.com!sdake
send ring_id through configuration changes patch from Muni Bajpai.

(Logical change 1.139)

------------------------------------------------------------------------
r500 | mvista.com!sdake | 2005-02-16 17:25:01 -0700 (Wed, 16 Feb 2005) | 11 lines

Merge sdake@bk.osdl.org:/var/bk/openais
into persist.az.mvista.com:/home/sdake/openais

2005/02/16 17:24:48-07:00 mvista.com!sdake
Many files:
  send ring_id through configuration changes patch from Muni Bajpai.
clm.c:
  mutex bug fixes as reported by Kristen Smith.

BKrev: 4213e45dnMl87bYQKSfi4_98X352Lg

------------------------------------------------------------------------
r499 | mvista.com!sdake | 2005-02-16 17:25:01 -0700 (Wed, 16 Feb 2005) | 4 lines

send ring_id through configuration changes patch from Muni Bajpai.

(Logical change 1.139)

------------------------------------------------------------------------
r498 | mvista.com!sdake | 2005-02-16 17:25:01 -0700 (Wed, 16 Feb 2005) | 4 lines

mutex bug fixes as reported by Kristen Smith.

(Logical change 1.139)

------------------------------------------------------------------------
r497 | osdl.net!markh | 2005-02-15 16:10:40 -0700 (Tue, 15 Feb 2005) | 4 lines

Look for SA_EVT_EVENTID_LOST when receiving an event.

(Logical change 1.138)

------------------------------------------------------------------------
r496 | osdl.net!markh | 2005-02-15 16:10:40 -0700 (Tue, 15 Feb 2005) | 4 lines

Set default event ID.

(Logical change 1.138)

------------------------------------------------------------------------
r495 | osdl.net!markh | 2005-02-15 16:10:40 -0700 (Tue, 15 Feb 2005) | 4 lines

Set lost event ID on dropped events.

(Logical change 1.138)

------------------------------------------------------------------------
r494 | osdl.net!markh | 2005-02-15 16:10:40 -0700 (Tue, 15 Feb 2005) | 5 lines

Use special event ID for setting the default in a new event and to indicate
a lost event.  Update subscription test to look for the "lost" event ID.

BKrev: 42128170Q5DcNymwbx8NushEykXwmg

------------------------------------------------------------------------
r493 | osdl.net!markh | 2005-02-15 09:54:46 -0700 (Tue, 15 Feb 2005) | 4 lines

Add unlink function.

(Logical change 1.137)

------------------------------------------------------------------------
r492 | osdl.net!markh | 2005-02-15 09:54:46 -0700 (Tue, 15 Feb 2005) | 8 lines

Merge markh@bk.osdl.org:/var/bk/openais
into markh1.pdx.osdl.net:/home/localmarkh/views/BK/openais_work

2005/02/15 08:54:34-08:00 osdl.net!markh
Add unlink function.

BKrev: 42122956O-InvJqb6K70vMTy4gl8yQ

------------------------------------------------------------------------
r491 | mvista.com!sdake | 2005-02-08 17:34:16 -0700 (Tue, 08 Feb 2005) | 4 lines

Increase code coverage by calling more API functions.

(Logical change 1.136)

------------------------------------------------------------------------
r490 | mvista.com!sdake | 2005-02-08 17:34:16 -0700 (Tue, 08 Feb 2005) | 10 lines

testevs.c, testckpt.c:
  Increase code coverage by calling more API functions.
testamf.c:
  Fix bug in test script which was causing test not to run.
  Increase code coverage by allowing few more apis to be called.
totemsrp.c:
  Increase code coverage by removing some debug code

BKrev: 42095a88Q0lU2eqEirC1FAZ05pxlmg

------------------------------------------------------------------------
r489 | mvista.com!sdake | 2005-02-08 17:34:16 -0700 (Tue, 08 Feb 2005) | 5 lines

Fix bug in test script which was causing test not to run.
Increase code coverage by allowing few more apis to be called.

(Logical change 1.136)

------------------------------------------------------------------------
r488 | mvista.com!sdake | 2005-02-08 17:34:16 -0700 (Tue, 08 Feb 2005) | 4 lines

Increase code coverage by removing some debug code

(Logical change 1.136)

------------------------------------------------------------------------
r487 | mvista.com!sdake | 2005-02-08 13:56:38 -0700 (Tue, 08 Feb 2005) | 2 lines

(Logical change 1.135)

------------------------------------------------------------------------
r486 | mvista.com!sdake | 2005-02-08 13:56:38 -0700 (Tue, 08 Feb 2005) | 11 lines

Many files:
  defect 245 - revise checkpoint service to B.01.01.
saCkpt.h, ipc_ckpt.h, sa_error.h:
  new file
.del-ais_clm.h~ed02cd4c7506e43:
  Delete: include/ais_clm.h
.del-ais_ckpt.h~b3c15abf536a6fbc:
  Delete: include/ais_ckpt.h

BKrev: 42092786pSJQ8uC11PWAhWTC1Hwjqw

------------------------------------------------------------------------
r485 | mvista.com!sdake | 2005-02-08 13:56:38 -0700 (Tue, 08 Feb 2005) | 4 lines

defect 245 - revise checkpoint service to B.01.01.

(Logical change 1.135)

------------------------------------------------------------------------
r484 | mvista.com!sdake | 2005-02-08 13:56:38 -0700 (Tue, 08 Feb 2005) | 4 lines

Delete: include/ais_ckpt.h

}(Logical change 1.135)

------------------------------------------------------------------------
r483 | mvista.com!sdake | 2005-02-08 13:56:38 -0700 (Tue, 08 Feb 2005) | 4 lines

Delete: include/ais_clm.h

}(Logical change 1.135)

------------------------------------------------------------------------
r482 | mvista.com!sdake | 2005-02-08 13:56:37 -0700 (Tue, 08 Feb 2005) | 2 lines

Initial revision

------------------------------------------------------------------------
r481 | mvista.com!sdake | 2005-02-08 13:51:46 -0700 (Tue, 08 Feb 2005) | 9 lines

totemsrp.c:
  Add more text output to display what occurs during recovery.
  Fix recovery bug which results in segfault.
  fix defect 228 - ring id file deleted causes assert.
  Fix recovery bug where recovery doesn't complete.
  Fix assert on commit phase.

BKrev: 42092662LEVSqJlhbISw-Hweb4Cbfg

------------------------------------------------------------------------
r480 | mvista.com!sdake | 2005-02-08 13:51:46 -0700 (Tue, 08 Feb 2005) | 8 lines

Add more text output to display what occurs during recovery.
Fix recovery bug which results in segfault.
fix defect 228 - ring id file deleted causes assert.
Fix recovery bug where recovery doesn't complete.
Fix assert on commit phase.

(Logical change 1.134)

------------------------------------------------------------------------
r479 | osdl.net!markh | 2005-02-08 10:16:52 -0700 (Tue, 08 Feb 2005) | 4 lines

Add test for channel open async

(Logical change 1.133)

------------------------------------------------------------------------
r478 | osdl.net!markh | 2005-02-08 10:16:52 -0700 (Tue, 08 Feb 2005) | 4 lines

Add handler for channel open async

(Logical change 1.133)

------------------------------------------------------------------------
r477 | osdl.net!markh | 2005-02-08 10:16:52 -0700 (Tue, 08 Feb 2005) | 7 lines

Add handler for channel open async and add a test to
testevt for the async channel open function.
Bug fix for event retention time clear exec code and added comments
when converting nanoseconds to milliseconds.

BKrev: 4208f4048DxJP7FLwfqHo7TfAoEJlA

------------------------------------------------------------------------
r476 | osdl.net!markh | 2005-02-04 14:33:20 -0700 (Fri, 04 Feb 2005) | 7 lines

This fixes a potential problem where, because of a config change, a joining
node may not have a previous fragment of a message.  It now discards
continuations of that message until it is complete and a new message
arrives.

(Logical change 1.132)

------------------------------------------------------------------------
r475 | osdl.net!markh | 2005-02-04 14:33:20 -0700 (Fri, 04 Feb 2005) | 7 lines

This fixes a potential problem where, because of a config change, a joining
node may not have a previous fragment of a message.  It now discards
continuations of that message until it is complete and a new message
arrives.

BKrev: 4203ea20pYSrD8ZyY3pxIHSXFSooeg

------------------------------------------------------------------------
r474 | osdl.net!markh | 2005-02-04 14:22:13 -0700 (Fri, 04 Feb 2005) | 4 lines

Remove ais_evt.h since its content has been moved.

BKrev: 4203e785HE6cQ-KCAgc-CHHOiZ0tEg

------------------------------------------------------------------------
r473 | osdl.net!markh | 2005-02-04 14:22:13 -0700 (Fri, 04 Feb 2005) | 4 lines

Delete: include/ais_evt.h

}(Logical change 1.131)

------------------------------------------------------------------------
r472 | osdl.net!markh | 2005-02-04 14:19:20 -0700 (Fri, 04 Feb 2005) | 4 lines

Update to B spec API

(Logical change 1.130)

------------------------------------------------------------------------
r471 | osdl.net!markh | 2005-02-04 14:19:20 -0700 (Fri, 04 Feb 2005) | 4 lines

Update event service to B spec API.

BKrev: 4203e6d8nLXD7EMTNFZNfFwMnzt8mA

------------------------------------------------------------------------
r470 | osdl.net!markh | 2005-02-04 14:19:20 -0700 (Fri, 04 Feb 2005) | 4 lines

Conver to B spec API.

(Logical change 1.130)

------------------------------------------------------------------------
r469 | osdl.net!markh | 2005-02-04 14:19:20 -0700 (Fri, 04 Feb 2005) | 4 lines

update dependencies.

(Logical change 1.130)

------------------------------------------------------------------------
r468 | osdl.net!markh | 2005-02-04 14:19:20 -0700 (Fri, 04 Feb 2005) | 2 lines

(Logical change 1.130)

------------------------------------------------------------------------
r467 | osdl.net!markh | 2005-02-04 14:19:20 -0700 (Fri, 04 Feb 2005) | 5 lines

Update evt to B spec
remove event related code and move to ipc_evt.h and saEvt.h

(Logical change 1.130)

------------------------------------------------------------------------
r466 | osdl.net!markh | 2005-02-04 14:19:20 -0700 (Fri, 04 Feb 2005) | 4 lines

Use B spec include files

(Logical change 1.130)

------------------------------------------------------------------------
r465 | osdl.net!markh | 2005-02-04 14:19:20 -0700 (Fri, 04 Feb 2005) | 5 lines

Convert to B spec.
Add in endian conversion functions.

(Logical change 1.130)

------------------------------------------------------------------------
r464 | osdl.net!markh | 2005-02-04 14:19:20 -0700 (Fri, 04 Feb 2005) | 4 lines

Moved from ais_msg.h so ais_msg.h doesn't need to be included by evt.

(Logical change 1.130)

------------------------------------------------------------------------
r463 | osdl.net!markh | 2005-02-04 14:19:20 -0700 (Fri, 04 Feb 2005) | 5 lines

update evt to B spec.
remove evt related code and move to ipc_evt.h and saEvt.h

(Logical change 1.130)

------------------------------------------------------------------------
r462 | osdl.net!markh | 2005-02-04 14:19:20 -0700 (Fri, 04 Feb 2005) | 4 lines

update dependencies

(Logical change 1.130)

------------------------------------------------------------------------
r461 | osdl.net!markh | 2005-02-04 14:19:19 -0700 (Fri, 04 Feb 2005) | 2 lines

Initial revision

------------------------------------------------------------------------
r460 | mvista.com!sdake | 2005-02-04 12:56:15 -0700 (Fri, 04 Feb 2005) | 5 lines

util.c:
  Fix merge error in util.c file

BKrev: 4203d35fqEwtXJ4ZtIAnGz5HWpHsEQ

------------------------------------------------------------------------
r459 | mvista.com!sdake | 2005-02-04 12:56:15 -0700 (Fri, 04 Feb 2005) | 4 lines

Fix merge error in util.c file

(Logical change 1.129)

------------------------------------------------------------------------
r458 | mvista.com!sdake | 2005-02-04 12:54:01 -0700 (Fri, 04 Feb 2005) | 4 lines

Small fix for data types.

(Logical change 1.128)

------------------------------------------------------------------------
r457 | mvista.com!sdake | 2005-02-04 12:54:01 -0700 (Fri, 04 Feb 2005) | 5 lines

util.c:
  Small fix for data types.

BKrev: 4203d2d97z9HmoblaHq8etKUqRGF0w

------------------------------------------------------------------------
r456 | mvista.com!sdake | 2005-02-04 12:35:14 -0700 (Fri, 04 Feb 2005) | 4 lines

Update to use 64 bit data types for handles.

(Logical change 1.127)

------------------------------------------------------------------------
r455 | mvista.com!sdake | 2005-02-04 12:35:14 -0700 (Fri, 04 Feb 2005) | 23 lines

testamf1.c, testamf2.c:
  64 bit handles.
testevs.c, testclm.c, testamfth.c, testamf6.c, testamf4.c, testamf3.c:
  64 bit handles
evs.h:
  change data type of handle to 64 bits for evs_handle_t.
ais_types.h:
  remove cluster membership types and put in saClm.h file.
ais_msg.h:
  remove cluster membership code and put in ipc file.
util.h, util.c:
  Update to use 64 bit data types for handles.
clm.c:
  Update cluster membership to B.01.01.
print.h:
  Update print data to new node structure.
clm.h, clm.c:
  Update cluster membership service to B.01.01.
saClm.h, ipc_gen.h, ipc_clm.h:
  new file

BKrev: 4203ce72I415G1q4yQQNjFfAxSJVOA

------------------------------------------------------------------------
r454 | mvista.com!sdake | 2005-02-04 12:35:14 -0700 (Fri, 04 Feb 2005) | 4 lines

64 bit handles

(Logical change 1.127)

------------------------------------------------------------------------
r453 | mvista.com!sdake | 2005-02-04 12:35:14 -0700 (Fri, 04 Feb 2005) | 4 lines

remove cluster membership code and put in ipc file.

(Logical change 1.127)

------------------------------------------------------------------------
r452 | mvista.com!sdake | 2005-02-04 12:35:14 -0700 (Fri, 04 Feb 2005) | 4 lines

Update cluster membership service to B.01.01.

(Logical change 1.127)

------------------------------------------------------------------------
r451 | mvista.com!sdake | 2005-02-04 12:35:14 -0700 (Fri, 04 Feb 2005) | 2 lines

(Logical change 1.127)

------------------------------------------------------------------------
r450 | mvista.com!sdake | 2005-02-04 12:35:14 -0700 (Fri, 04 Feb 2005) | 4 lines

64 bit handles.

(Logical change 1.127)

------------------------------------------------------------------------
r449 | mvista.com!sdake | 2005-02-04 12:35:14 -0700 (Fri, 04 Feb 2005) | 4 lines

Update print data to new node structure.

(Logical change 1.127)

------------------------------------------------------------------------
r448 | mvista.com!sdake | 2005-02-04 12:35:14 -0700 (Fri, 04 Feb 2005) | 4 lines

remove cluster membership types and put in saClm.h file.

(Logical change 1.127)

------------------------------------------------------------------------
r447 | mvista.com!sdake | 2005-02-04 12:35:14 -0700 (Fri, 04 Feb 2005) | 4 lines

change data type of handle to 64 bits for evs_handle_t.

(Logical change 1.127)

------------------------------------------------------------------------
r446 | mvista.com!sdake | 2005-02-04 12:35:14 -0700 (Fri, 04 Feb 2005) | 4 lines

Update cluster membership to B.01.01.

(Logical change 1.127)

------------------------------------------------------------------------
r445 | mvista.com!sdake | 2005-02-04 12:35:13 -0700 (Fri, 04 Feb 2005) | 2 lines

Initial revision

------------------------------------------------------------------------
r444 | mvista.com!sdake | 2005-02-01 13:40:07 -0700 (Tue, 01 Feb 2005) | 4 lines

fix defect 131 - member element not set in cluster membership service

(Logical change 1.126)

------------------------------------------------------------------------
r443 | mvista.com!sdake | 2005-02-01 13:40:07 -0700 (Tue, 01 Feb 2005) | 9 lines

More fixes for defect 204.  From Mark Haverkamp:
|Looking at the totempg config change function, I think that leaving
|members should have their assembly area reset.  I assume that any data
|that is there is now invalid, and we wouldn't want it hanging around if
|they return.  Also, I think that the wrong index was being used to
|initialize the assembly area index.

(Logical change 1.126)

------------------------------------------------------------------------
r442 | mvista.com!sdake | 2005-02-01 13:40:07 -0700 (Tue, 01 Feb 2005) | 12 lines

totempg.c:
  More fixes for defect 204.  From Mark Haverkamp:
  |Looking at the totempg config change function, I think that leaving
  |members should have their assembly area reset.  I assume that any data
  |that is there is now invalid, and we wouldn't want it hanging around if
  |they return.  Also, I think that the wrong index was being used to
  |initialize the assembly area index.
clm.c:
  fix defect 131 - member element not set in cluster membership service

BKrev: 41ffe9278sM8ZyWmj_3tmUK0YiqgSQ

------------------------------------------------------------------------
r441 | mvista.com!sdake | 2005-01-31 15:07:48 -0700 (Mon, 31 Jan 2005) | 5 lines

Fix from mark and daniel for small packet sizes in totempg resulting
in segfault.

(Logical change 1.125)

------------------------------------------------------------------------
r440 | mvista.com!sdake | 2005-01-31 15:07:48 -0700 (Mon, 31 Jan 2005) | 4 lines

random drop defined to on..  turning off.

(Logical change 1.125)

------------------------------------------------------------------------
r439 | mvista.com!sdake | 2005-01-31 15:07:48 -0700 (Mon, 31 Jan 2005) | 8 lines

totemsrp.c:
  random drop defined to on..  turning off.
totempg.c:
  Fix from mark and daniel for small packet sizes in totempg resulting
  in segfault.

BKrev: 41feac34ILMg8MsBZNAXgHefIA22zw

------------------------------------------------------------------------
r438 | mvista.com!sdake | 2005-01-31 12:53:30 -0700 (Mon, 31 Jan 2005) | 6 lines

totempg.c:
  Fixes defect 204 : messages not delivered correctly
  Patch from Mark Haverkamp.

BKrev: 41fe8cbaM4eR7_3dP91qFSahtT23dA

------------------------------------------------------------------------
r437 | mvista.com!sdake | 2005-01-31 12:53:30 -0700 (Mon, 31 Jan 2005) | 5 lines

Fixes defect 204 : messages not delivered correctly
Patch from Mark Haverkamp.

(Logical change 1.124)

------------------------------------------------------------------------
r436 | mvista.com!sdake | 2005-01-31 12:52:36 -0700 (Mon, 31 Jan 2005) | 4 lines

Fix bug in implementation that deviates from specification.

(Logical change 1.123)

------------------------------------------------------------------------
r435 | mvista.com!sdake | 2005-01-31 12:52:36 -0700 (Mon, 31 Jan 2005) | 5 lines

totemsrp.c:
  Fix bug in implementation that deviates from specification.

BKrev: 41fe8c84mIHGgf3brH_kZTiOR_ACvQ

------------------------------------------------------------------------
r434 | mvista.com!sdake | 2005-01-29 11:30:56 -0700 (Sat, 29 Jan 2005) | 5 lines

bug 214
Fix pthread mutex not unlocked in error path

(Logical change 1.122)

------------------------------------------------------------------------
r433 | mvista.com!sdake | 2005-01-29 11:30:56 -0700 (Sat, 29 Jan 2005) | 5 lines

remove priority fields from evs service.
..

(Logical change 1.122)

------------------------------------------------------------------------
r432 | mvista.com!sdake | 2005-01-29 11:30:56 -0700 (Sat, 29 Jan 2005) | 4 lines

remove priority fields from evs service.

(Logical change 1.122)

------------------------------------------------------------------------
r431 | mvista.com!sdake | 2005-01-29 11:30:56 -0700 (Sat, 29 Jan 2005) | 11 lines

evs_mcast_joined.3:
  remove priority fields from evs service.
  ..
evs_mcast_groups.3, evs.h, ais_msg.h:
  remove priority fields from evs service.
util.c:
  bug 214
  Fix pthread mutex not unlocked in error path

BKrev: 41fbd660W-BROulgsZt4S6LYD_pcvw

------------------------------------------------------------------------
r430 | mvista.com!sdake | 2005-01-27 12:37:39 -0700 (Thu, 27 Jan 2005) | 9 lines

testevs.c, evsbench.c:
  Remove priorities from interfaces.
evs.c:
  Remove priorities from evs interfaces.
totempg.h, totempg.c, main.c, handlers.h, evt.c, evs.c, clm.c, ckpt.c, amf.c:
  Remove priorities from all interfaces.

BKrev: 41f943030jN3Y5g5v10371Hgb2007A

------------------------------------------------------------------------
r429 | mvista.com!sdake | 2005-01-27 12:37:39 -0700 (Thu, 27 Jan 2005) | 4 lines

Remove priorities from evs interfaces.

(Logical change 1.121)

------------------------------------------------------------------------
r428 | mvista.com!sdake | 2005-01-27 12:37:39 -0700 (Thu, 27 Jan 2005) | 4 lines

Remove priorities from interfaces.

(Logical change 1.121)

------------------------------------------------------------------------
r427 | mvista.com!sdake | 2005-01-27 12:37:39 -0700 (Thu, 27 Jan 2005) | 4 lines

Remove priorities from all interfaces.

(Logical change 1.121)

------------------------------------------------------------------------
r426 | mvista.com!sdake | 2005-01-24 12:44:07 -0700 (Mon, 24 Jan 2005) | 4 lines

Fix defect 203 commit token asserts

(Logical change 1.120)

------------------------------------------------------------------------
r425 | mvista.com!sdake | 2005-01-24 12:44:07 -0700 (Mon, 24 Jan 2005) | 5 lines

totemsrp.c:
  Fix defect 203 commit token asserts

BKrev: 41f55007suViMhWrhOICprHxyacUwg

------------------------------------------------------------------------
r424 | osdl.net!markh | 2005-01-24 12:04:45 -0700 (Mon, 24 Jan 2005) | 6 lines

Small fixes.
evt: fix member count until recovery code is done.
totempg: remove dbug print.

BKrev: 41f546cd0Fq27HJzalqHeE69x99WKg

------------------------------------------------------------------------
r423 | osdl.net!markh | 2005-01-24 12:04:45 -0700 (Mon, 24 Jan 2005) | 4 lines

Temp config change code

(Logical change 1.119)

------------------------------------------------------------------------
r422 | osdl.net!markh | 2005-01-24 12:04:45 -0700 (Mon, 24 Jan 2005) | 4 lines

remove debug print

(Logical change 1.119)

------------------------------------------------------------------------
r421 | broked.org!sdake | 2005-01-22 14:28:45 -0700 (Sat, 22 Jan 2005) | 4 lines

Remove random dropping of packets in released version.

(Logical change 1.118)

------------------------------------------------------------------------
r420 | broked.org!sdake | 2005-01-22 14:28:45 -0700 (Sat, 22 Jan 2005) | 5 lines

totemsrp.c:
  Remove random dropping of packets in released version.

BKrev: 41f2c58dbLMQ6YcKCJxEwIKRUk7lxw

------------------------------------------------------------------------
r419 | mvista.com!sdake | 2005-01-22 13:55:47 -0700 (Sat, 22 Jan 2005) | 4 lines

update to new totem code

(Logical change 1.117)

------------------------------------------------------------------------
r418 | mvista.com!sdake | 2005-01-22 13:55:47 -0700 (Sat, 22 Jan 2005) | 4 lines

enable some testing code.

(Logical change 1.117)

------------------------------------------------------------------------
r417 | mvista.com!sdake | 2005-01-22 13:55:47 -0700 (Sat, 22 Jan 2005) | 4 lines

Add test.cpp to makefile

(Logical change 1.117)

------------------------------------------------------------------------
r416 | mvista.com!sdake | 2005-01-22 13:55:47 -0700 (Sat, 22 Jan 2005) | 4 lines

Delete: exec/gmi.c

}(Logical change 1.117)

------------------------------------------------------------------------
r415 | mvista.com!sdake | 2005-01-22 13:55:47 -0700 (Sat, 22 Jan 2005) | 4 lines

new benchmark runs for 10 seconds.

(Logical change 1.117)

------------------------------------------------------------------------
r414 | mvista.com!sdake | 2005-01-22 13:55:47 -0700 (Sat, 22 Jan 2005) | 4 lines

update to new crypto code

(Logical change 1.117)

------------------------------------------------------------------------
r413 | mvista.com!sdake | 2005-01-22 13:55:47 -0700 (Sat, 22 Jan 2005) | 4 lines

update to new crypto code.

(Logical change 1.117)

------------------------------------------------------------------------
r412 | mvista.com!sdake | 2005-01-22 13:55:47 -0700 (Sat, 22 Jan 2005) | 2 lines

(Logical change 1.117)

------------------------------------------------------------------------
r411 | mvista.com!sdake | 2005-01-22 13:55:47 -0700 (Sat, 22 Jan 2005) | 23 lines

Makefile:
  Add test.cpp to makefile
testckpt.c:
  enable some testing code.
evsbench.c, ckptbench.c:
  new benchmark runs for 10 seconds.
test.cpp, rmd.h, totemsrp.h, totemsrp.c, totempg.h, totempg.c, swab.h:
  new file
sq.h, Makefile, evt.c, evs.c, clm.c, amf.c, crypto.c, ckpt.c, aispoll.c:
  update to new totem code.
queue.h, ais_msg.h:
  update to new totem code
parse.h, parse.c, Makefile, main.h:
  update to new crypto code
main.c, handlers.h:
  update to new crypto code.
.del-gmi.h~7d81bcdb10af22b3:
  Delete: exec/gmi.h
.del-gmi.c~df0f77a7b91ff206:
  Delete: exec/gmi.c

BKrev: 41f2bdd3a_mEhs2wkBZHsD4_aft9vA

------------------------------------------------------------------------
r410 | mvista.com!sdake | 2005-01-22 13:55:47 -0700 (Sat, 22 Jan 2005) | 4 lines

update to new totem code.

(Logical change 1.117)

------------------------------------------------------------------------
r409 | mvista.com!sdake | 2005-01-22 13:55:47 -0700 (Sat, 22 Jan 2005) | 4 lines

Delete: exec/gmi.h

}(Logical change 1.117)

------------------------------------------------------------------------
r408 | mvista.com!sdake | 2005-01-22 13:55:46 -0700 (Sat, 22 Jan 2005) | 2 lines

Initial revision

------------------------------------------------------------------------
r407 | osdl.net!markh | 2005-01-11 09:59:10 -0700 (Tue, 11 Jan 2005) | 4 lines

add in missing mutex unlock

BKrev: 41e405deOyfzWPCaxv7_aIpgxL5C5g

------------------------------------------------------------------------
r406 | osdl.net!markh | 2005-01-11 09:59:10 -0700 (Tue, 11 Jan 2005) | 4 lines

add in missing mutex unlock

(Logical change 1.116)

------------------------------------------------------------------------
r405 | osdl.net!markh | 2005-01-11 09:35:28 -0700 (Tue, 11 Jan 2005) | 4 lines

Need to specify create because the channel probably doesn't exist anymore.

BKrev: 41e40050NKYAEN3N5kB1-R-klUXqUQ

------------------------------------------------------------------------
r404 | osdl.net!markh | 2005-01-11 09:35:28 -0700 (Tue, 11 Jan 2005) | 4 lines

Need to specify create because the channel probably doesn't exist anymore.

(Logical change 1.115)

------------------------------------------------------------------------
r403 | sakai!sakai | 2005-01-10 08:28:00 -0700 (Mon, 10 Jan 2005) | 5 lines

amf.c:
  For Protection Group Tracking Bug

BKrev: 41e29f00Yz2GqTwTyBhpW_zo6WjI1Q

------------------------------------------------------------------------
r402 | sakai!sakai | 2005-01-10 08:28:00 -0700 (Mon, 10 Jan 2005) | 4 lines

For Protection Group Tracking Bug

(Logical change 1.114)

------------------------------------------------------------------------
r401 | mvista.com!sdake | 2005-01-08 10:53:32 -0700 (Sat, 08 Jan 2005) | 5 lines

tlist.h:
  Fix required for previous tlist.c commit.

BKrev: 41e01e1cFsurlTBuApZjiZ3l9RFdBw

------------------------------------------------------------------------
r400 | mvista.com!sdake | 2005-01-08 10:53:32 -0700 (Sat, 08 Jan 2005) | 4 lines

Fix required for previous tlist.c commit.

(Logical change 1.113)

------------------------------------------------------------------------
r399 | mvista.com!sdake | 2005-01-08 02:16:42 -0700 (Sat, 08 Jan 2005) | 13 lines

Merge sdake@bk.osdl.org:/var/bk/openais
into persist.az.mvista.com:/home/sdake/openais

2005/01/08 02:16:10-07:00 mvista.com!sdake
tlist.c:
  Fix use of memory area after free when timer_fn deletes a timer.
  The 3 cases are:
  1. timer_fn deletes its own timer
  2. timer_fn deletes next timer after its own timer
  3. timer_fn deletes any other timer

BKrev: 41dfa4faNWgA_s0fcyzlj-jhOFNKAA

------------------------------------------------------------------------
r398 | mvista.com!sdake | 2005-01-08 02:16:42 -0700 (Sat, 08 Jan 2005) | 8 lines

Fix use of memory area after free when timer_fn deletes a timer.
The 3 cases are:
1. timer_fn deletes its own timer
2. timer_fn deletes next timer after its own timer
3. timer_fn deletes any other timer

(Logical change 1.112)

------------------------------------------------------------------------
r397 | broked.org!sdake | 2005-01-07 13:21:11 -0700 (Fri, 07 Jan 2005) | 5 lines

evs.c, clm.c, amf.c:
  Fix missing unlock in error conditions reported by Kristen Smith

BKrev: 41deef37lfq4PXPbgolOpenG8xUJYg

------------------------------------------------------------------------
r396 | broked.org!sdake | 2005-01-07 13:21:11 -0700 (Fri, 07 Jan 2005) | 4 lines

Fix missing unlock in error conditions reported by Kristen Smith

(Logical change 1.111)

------------------------------------------------------------------------
r395 | nortelnetworks.com!kjsmith | 2005-01-07 10:28:29 -0700 (Fri, 07 Jan 2005) | 4 lines

Add missing mutex unlocks in evt dispatch function.

BKrev: 41dec6bdm_JzS8aFCPMDziJhBZprSw

------------------------------------------------------------------------
r394 | nortelnetworks.com!kjsmith | 2005-01-07 10:28:29 -0700 (Fri, 07 Jan 2005) | 28 lines

I was running into a problem where the evt api appeared to be getting into a
deadlock situtation. The problem would occur when I would kill aisexec
while my program was running (using EVT and CLM apis). My program is
multi-threaded where 1 thread is calling evtDispatch and other threads
can be calling evtPublish at various times. The problem I ran into is when I
killed aisexec, the evtDispatch would take a lock, but never give it back.
At the same time, my sending thread would call evtPublish which would take
the lock and hang since evtDispatch never gave up the lock it took.

The fix was to add a few unlocks in evt.c where they appeared to be missing.
Here is the info:

1) line 504 in evt.c (lib dir) calls

pthread_mutex_unlock(&evti->ei_mutex);
goto error_unlock;

2) There are subsequent calls to goto error_unlock in later error statements
that do not unlock the mutex before the goto call - the lines are 534 and 541

Adding the unlock right before the goto @ 534 and @ 541 fixes the deadlock
for my scenario.

Kristen Smith
Nortel Networks

(Logical change 1.110)

------------------------------------------------------------------------
r393 | mvista.com!sdake | 2004-11-29 13:10:07 -0700 (Mon, 29 Nov 2004) | 4 lines

Improve code coverage by testing a few more APIs in the AMF.

(Logical change 1.109)

------------------------------------------------------------------------
r392 | mvista.com!sdake | 2004-11-29 13:10:07 -0700 (Mon, 29 Nov 2004) | 5 lines

testamf.c:
  Improve code coverage by testing a few more APIs in the AMF.

BKrev: 41ab821fPmG01mXBZYuPJWKuOLHj5A

------------------------------------------------------------------------
r391 | mvista.com!sdake | 2004-11-24 16:48:25 -0700 (Wed, 24 Nov 2004) | 4 lines

code coverage work cleanup

(Logical change 1.108)

------------------------------------------------------------------------
r390 | mvista.com!sdake | 2004-11-24 16:48:25 -0700 (Wed, 24 Nov 2004) | 4 lines

fix double ;; which causes gcc 2.95 to fail to compile

(Logical change 1.108)

------------------------------------------------------------------------
r389 | mvista.com!sdake | 2004-11-24 16:48:25 -0700 (Wed, 24 Nov 2004) | 7 lines

testparse.c:
  code coverage work cleanup
evt.c:
  fix double ;; which causes gcc 2.95 to fail to compile

BKrev: 41a51dc9RLGeGsr9z5GLjSGzFovoKQ

------------------------------------------------------------------------
r388 | mvista.com!sdake | 2004-11-24 16:28:48 -0700 (Wed, 24 Nov 2004) | 4 lines

correct stack corruption when logging data.

(Logical change 1.107)

------------------------------------------------------------------------
r387 | mvista.com!sdake | 2004-11-24 16:28:48 -0700 (Wed, 24 Nov 2004) | 4 lines

remove extra printf from gmi.

(Logical change 1.107)

------------------------------------------------------------------------
r386 | mvista.com!sdake | 2004-11-24 16:28:48 -0700 (Wed, 24 Nov 2004) | 7 lines

parse.c:
  correct stack corruption when logging data.
gmi.c:
  remove extra printf from gmi.

BKrev: 41a51930u36bUFf2s34EDiXBXWb-1Q

------------------------------------------------------------------------
r385 | mvista.com!sdake | 2004-11-24 15:32:21 -0700 (Wed, 24 Nov 2004) | 4 lines

Fix compile with gcc 2.95.

(Logical change 1.106)

------------------------------------------------------------------------
r384 | mvista.com!sdake | 2004-11-24 15:32:21 -0700 (Wed, 24 Nov 2004) | 5 lines

gmi.c, amf.c:
  Fix compile with gcc 2.95.

BKrev: 41a50bf5bDdOboBSLlLamrDIChW6LQ

------------------------------------------------------------------------
r383 | mvista.com!sdake | 2004-11-12 12:17:34 -0700 (Fri, 12 Nov 2004) | 6 lines

evs.c:
  Kristen Smith reported a bug where evs would return 0.0.0.0 in the
  source address.  This patch fixes that defect 182.

BKrev: 41950c4eWm2WAOmtw1VmnIPUzCirKw

------------------------------------------------------------------------
r382 | mvista.com!sdake | 2004-11-12 12:17:34 -0700 (Fri, 12 Nov 2004) | 5 lines

Kristen Smith reported a bug where evs would return 0.0.0.0 in the
source address.  This patch fixes that defect 182.

(Logical change 1.105)

------------------------------------------------------------------------
r381 | somacoma.net!dns | 2004-11-07 16:33:57 -0700 (Sun, 07 Nov 2004) | 8 lines

Merge

2004/10/29 00:13:35+02:00 somacoma.net!dns
evt.c:
  Fix type-punning warnings with gcc-3.3 and later.

BKrev: 418eb0e5AwiqPJ0GA8LlrTmNOv1pVQ

------------------------------------------------------------------------
r380 | somacoma.net!dns | 2004-11-07 16:33:57 -0700 (Sun, 07 Nov 2004) | 4 lines

Fix type-punning warnings with gcc-3.3 and later.

(Logical change 1.104)

------------------------------------------------------------------------
r379 | mvista.com!sdake | 2004-11-06 10:42:26 -0700 (Sat, 06 Nov 2004) | 5 lines

Commit timeout wasn't stopped when entering gather state.  This patch stops
the commit timeout when the gather state is entered.

(Logical change 1.103)

------------------------------------------------------------------------
r378 | mvista.com!sdake | 2004-11-06 10:42:26 -0700 (Sat, 06 Nov 2004) | 10 lines

Merge sdake@bk.osdl.org:/var/bk/openais
into persist.az.mvista.com:/home/sdake/openais

2004/11/06 10:42:19-07:00 mvista.com!sdake
gmi.c:
  Commit timeout wasn't stopped when entering gather state.  This patch stops
  the commit timeout when the gather state is entered.

BKrev: 418d0d02UJqL-86F2zLxnkruJk2Z7Q

------------------------------------------------------------------------
r377 | sakai!sakai | 2004-11-05 09:29:29 -0700 (Fri, 05 Nov 2004) | 7 lines

Makefile:
  append keygen.o to clean target
amf.c:
  match function name to coding style

BKrev: 418baa69pjW8OB2yd60kweHMtHG5Fg

------------------------------------------------------------------------
r376 | sakai!sakai | 2004-11-05 09:29:29 -0700 (Fri, 05 Nov 2004) | 4 lines

match function name to coding style

(Logical change 1.102)

------------------------------------------------------------------------
r375 | sakai!sakai | 2004-11-05 09:29:29 -0700 (Fri, 05 Nov 2004) | 4 lines

append keygen.o to clean target

(Logical change 1.102)

------------------------------------------------------------------------
r374 | sakai!sakai | 2004-11-04 15:37:03 -0700 (Thu, 04 Nov 2004) | 4 lines

implement gmi_token_callback in amf.c

(Logical change 1.101)

------------------------------------------------------------------------
r373 | sakai!sakai | 2004-11-04 15:37:03 -0700 (Thu, 04 Nov 2004) | 7 lines

Makefile:
  get rid of make error
amf.c:
  implement gmi_token_callback in amf.c

BKrev: 418aaf0fKs_99rjhstkG78ZR02mT9g

------------------------------------------------------------------------
r372 | sakai!sakai | 2004-11-04 15:37:03 -0700 (Thu, 04 Nov 2004) | 4 lines

get rid of make error

(Logical change 1.101)

------------------------------------------------------------------------
r371 | sakai!sakai | 2004-11-02 14:02:49 -0700 (Tue, 02 Nov 2004) | 4 lines

fix wrong Hastat after node join

(Logical change 1.100)

------------------------------------------------------------------------
r370 | sakai!sakai | 2004-11-02 14:02:49 -0700 (Tue, 02 Nov 2004) | 4 lines

fix wrong HaStat after node join

(Logical change 1.100)

------------------------------------------------------------------------
r369 | mvista.com!sdake | 2004-11-02 14:02:49 -0700 (Tue, 02 Nov 2004) | 11 lines

Merge persist.az.mvista.com:/home/sdake/openais
into persist.az.mvista.com:/export/hadev/openais/defect-174

2004/10/31 00:48:17+09:00 sakai!sakai
ais_msg.h:
  fix wrong Hastat after node join
amf.c:
  fix wrong HaStat after node join

BKrev: 4187f5f99iXw5l-V34v_kR2YTLDpgg

------------------------------------------------------------------------
r368 | mvista.com!sdake | 2004-10-29 17:07:11 -0700 (Fri, 29 Oct 2004) | 4 lines

Add rlimit code to allow openais to work with linux kernel 2.6.9 or later

(Logical change 1.99)

------------------------------------------------------------------------
r367 | mvista.com!sdake | 2004-10-29 17:07:11 -0700 (Fri, 29 Oct 2004) | 4 lines

Add rlimit code to allow openais to work with linux kernel 2.6.9 or later

BKrev: 4182db2fMpOhxCxRnyhHxC5YOCUhvg

------------------------------------------------------------------------
r366 | mvista.com!sdake | 2004-10-27 15:24:15 -0700 (Wed, 27 Oct 2004) | 4 lines

64bit safe ais types

(Logical change 1.98)

------------------------------------------------------------------------
r365 | mvista.com!sdake | 2004-10-27 15:24:15 -0700 (Wed, 27 Oct 2004) | 4 lines

Remove specific o files instead of all objects.

(Logical change 1.98)

------------------------------------------------------------------------
r364 | mvista.com!sdake | 2004-10-27 15:24:15 -0700 (Wed, 27 Oct 2004) | 4 lines

Type checking changes for printf's

(Logical change 1.98)

------------------------------------------------------------------------
r363 | mvista.com!sdake | 2004-10-27 15:24:15 -0700 (Wed, 27 Oct 2004) | 4 lines

Fix off by one which oculd cause invalid handle to be used.

(Logical change 1.98)

------------------------------------------------------------------------
r362 | mvista.com!sdake | 2004-10-27 15:24:15 -0700 (Wed, 27 Oct 2004) | 4 lines

Fix off by one which could cause invalid handle to be used.

(Logical change 1.98)

------------------------------------------------------------------------
r361 | mvista.com!sdake | 2004-10-27 15:24:15 -0700 (Wed, 27 Oct 2004) | 4 lines

type safeness printing.

(Logical change 1.98)

------------------------------------------------------------------------
r360 | mvista.com!sdake | 2004-10-27 15:24:15 -0700 (Wed, 27 Oct 2004) | 24 lines

Several fixes by Daniel Stodden.  Possible crash on invalid handle fixed in library
and executive.  Also parser could crash when out of memory occurs.

util.c:
  Fix off by one which oculd cause invalid handle to be used.
testevt.c, testckpt.c, subscription.c, evtbench.c:
  type safeness printing.
publish.c:
  type safeness prnting.
ais_types.h:
  64bit safe ais types
Makefile:
  Remove specific o files instead of all objects.
parse.c:
  Fix crash in parser.
hdb.c:
  Fix off by one which could cause invalid handle to be used.
gmi.c:
  remove type-punned pointer warning
ckpt.c, amf.c:
  Type checking changes for printf's

BKrev: 4180200fVk1m035hXoENX87UgLUrKg

------------------------------------------------------------------------
r359 | mvista.com!sdake | 2004-10-27 15:24:15 -0700 (Wed, 27 Oct 2004) | 4 lines

type safeness prnting.

(Logical change 1.98)

------------------------------------------------------------------------
r358 | mvista.com!sdake | 2004-10-27 15:24:15 -0700 (Wed, 27 Oct 2004) | 4 lines

remove type-punned pointer warning

(Logical change 1.98)

------------------------------------------------------------------------
r357 | mvista.com!sdake | 2004-10-27 15:24:15 -0700 (Wed, 27 Oct 2004) | 4 lines

Fix crash in parser.

(Logical change 1.98)

------------------------------------------------------------------------
r356 | osdl.net!markh | 2004-10-22 14:16:53 -0700 (Fri, 22 Oct 2004) | 5 lines

I added some cases to test multiple channel and subscriptions as well
as some retained event tests.

(Logical change 1.97)

------------------------------------------------------------------------
r355 | osdl.net!markh | 2004-10-22 14:16:53 -0700 (Fri, 22 Oct 2004) | 13 lines

Here some updates to the event code.  The first are changes to
exec/evt.c:
1. manage the base event ID a little better.
2. I also added some private log levels to allow me to selectively turn
on debug output in some sections of the code without turning on
everything.
3. Remove (EVT) from all the printf calls.

The next is an update to the testevt program. I added some cases to test
multiple channel and subscriptions as well as some retained event tests.

BKrev: 417978c5I2I15AFzIQ0zITa5_ESuZQ

------------------------------------------------------------------------
r354 | osdl.net!markh | 2004-10-22 14:16:53 -0700 (Fri, 22 Oct 2004) | 8 lines

1. manage the base event ID a little better.
2. I also added some private log levels to allow me to selectively turn
on debug output in some sections of the code without turning on
everything.
3. Remove (EVT) from all the printf calls.

(Logical change 1.97)

------------------------------------------------------------------------
r353 | mvista.com!sdake | 2004-10-18 11:41:10 -0700 (Mon, 18 Oct 2004) | 4 lines

Change logging to include service and description.

(Logical change 1.96)

------------------------------------------------------------------------
r352 | mvista.com!sdake | 2004-10-18 11:41:10 -0700 (Mon, 18 Oct 2004) | 4 lines

Change loggint o include service and description.

(Logical change 1.96)

------------------------------------------------------------------------
r351 | mvista.com!sdake | 2004-10-18 11:41:10 -0700 (Mon, 18 Oct 2004) | 4 lines

Add log print service.

(Logical change 1.96)

------------------------------------------------------------------------
r350 | mvista.com!sdake | 2004-10-18 11:41:10 -0700 (Mon, 18 Oct 2004) | 4 lines

Delete: exec/log/print.c

}(Logical change 1.96)

------------------------------------------------------------------------
r349 | mvista.com!sdake | 2004-10-18 11:41:10 -0700 (Mon, 18 Oct 2004) | 4 lines

Add log service level.

(Logical change 1.96)

------------------------------------------------------------------------
r348 | mvista.com!sdake | 2004-10-18 11:41:10 -0700 (Mon, 18 Oct 2004) | 27 lines

Big update for better logging to file, syslog, or stderr.

print.h:
  Change loggint o include service and description.
print.c:
  Change logging to include service and description.
parse.h, parse.c:
  Change parser to read new configuration file format.
main.c:
  Some changes for log services.
gmi.c, evt.c, evs.c, clm.c, ckpt.c:
  Add log service level.
amf.c:
  Add log print service.
openais.conf:
  new file
.del-network.conf~b38a0f011c4341a7:
  Delete: conf/network.conf
QUICKSTART:
  Updates that explains new configuration file options.
.del-print.h~e83281cecec7f02d:
  Delete: exec/log/print.h
.del-print.c~53000a4a22b4cd:
  Delete: exec/log/print.c

BKrev: 41740e46Y1NJgmUMM6WceFwxBVXOVg

------------------------------------------------------------------------
r347 | mvista.com!sdake | 2004-10-18 11:41:10 -0700 (Mon, 18 Oct 2004) | 2 lines

(Logical change 1.96)

------------------------------------------------------------------------
r346 | mvista.com!sdake | 2004-10-18 11:41:10 -0700 (Mon, 18 Oct 2004) | 4 lines

Updates that explains new configuration file options.

(Logical change 1.96)

------------------------------------------------------------------------
r345 | mvista.com!sdake | 2004-10-18 11:41:10 -0700 (Mon, 18 Oct 2004) | 4 lines

Change parser to read new configuration file format.

(Logical change 1.96)

------------------------------------------------------------------------
r344 | mvista.com!sdake | 2004-10-18 11:41:10 -0700 (Mon, 18 Oct 2004) | 4 lines

Delete: conf/network.conf

}(Logical change 1.96)

------------------------------------------------------------------------
r343 | mvista.com!sdake | 2004-10-18 11:41:10 -0700 (Mon, 18 Oct 2004) | 4 lines

Delete: exec/log/print.h

}(Logical change 1.96)

------------------------------------------------------------------------
r342 | mvista.com!sdake | 2004-10-18 11:41:10 -0700 (Mon, 18 Oct 2004) | 4 lines

Some changes for log services.

(Logical change 1.96)

------------------------------------------------------------------------
r341 | mvista.com!sdake | 2004-10-18 11:41:09 -0700 (Mon, 18 Oct 2004) | 2 lines

Initial revision

------------------------------------------------------------------------
r340 | osdl.net!markh | 2004-10-15 07:35:37 -0700 (Fri, 15 Oct 2004) | 10 lines

Merge markh@bk.osdl.org:/var/bk/openais
into markh1.pdx.osdl.net:/home/localmarkh/views/BK/openais_event

2004/10/15 07:34:46-07:00 osdl.net!markh
Fix some problems in the open channel recovery code that could cause
remaining nodes to have an incorrect count when a node left the
membership.

BKrev: 416fe0393RmyVFqRVwmPFENov-OyGw

------------------------------------------------------------------------
r339 | osdl.net!markh | 2004-10-15 07:35:37 -0700 (Fri, 15 Oct 2004) | 6 lines

Fix some problems in the open channel recovery code that could cause
remaining nodes to have an incorrect count when a node left the
membership.

(Logical change 1.95)

------------------------------------------------------------------------
r338 | mvista.com!sdake | 2004-10-14 17:37:47 -0700 (Thu, 14 Oct 2004) | 4 lines

Make testevs exit on evs_initialize if the return code is not EVS_OK.

(Logical change 1.94)

------------------------------------------------------------------------
r337 | mvista.com!sdake | 2004-10-14 17:37:47 -0700 (Thu, 14 Oct 2004) | 5 lines

Add handle instance destructor code.  Previously it was set to
null and was being called which caused a null jump.

(Logical change 1.94)

------------------------------------------------------------------------
r336 | mvista.com!sdake | 2004-10-14 17:37:47 -0700 (Thu, 14 Oct 2004) | 8 lines

testevs.c:
  Make testevs exit on evs_initialize if the return code is not EVS_OK.
evs.c:
  Add handle instance destructor code.  Previously it was set to
  null and was being called which caused a null jump.

BKrev: 416f1bdbIKOv0YEK2JzYcGImsLWrsA

------------------------------------------------------------------------
r335 | osdl.net!markh | 2004-10-12 14:59:46 -0700 (Tue, 12 Oct 2004) | 4 lines

Fix some compiler warnings with gcc 3.4

(Logical change 1.93)

------------------------------------------------------------------------
r334 | osdl.net!markh | 2004-10-12 14:59:46 -0700 (Tue, 12 Oct 2004) | 7 lines

Auto merged

2004/10/12 14:57:45-07:00 osdl.net!markh
Message type support for tracking open channels

(Logical change 1.93)

------------------------------------------------------------------------
r333 | osdl.net!markh | 2004-10-12 14:59:46 -0700 (Tue, 12 Oct 2004) | 10 lines

Auto merged

2004/10/12 14:57:45-07:00 osdl.net!markh
This takes care of tracking open channels through configuration
changes.  The channel structures and data are maintained until the last
instance is closed and there are no unexpired retained events.  Then the
data is freed up.

(Logical change 1.93)

------------------------------------------------------------------------
r332 | osdl.net!markh | 2004-10-12 14:59:46 -0700 (Tue, 12 Oct 2004) | 11 lines

Merge markh@bk.osdl.org:/var/bk/openais
into markh1.pdx.osdl.net:/home/localmarkh/views/BK/openais_event

2004/10/12 14:57:46-07:00 osdl.net!markh
Handle open channels cluster wide and track opens.  Free up channel
data when there are no more references.

Also, fix some compiler warnings in lib/evt.c

BKrev: 416c53d279cT2JNVM_jQ5qBjLGe6EQ

------------------------------------------------------------------------
r331 | sakai!sakai | 2004-10-11 02:12:20 -0700 (Mon, 11 Oct 2004) | 4 lines

correct defalut component name

(Logical change 1.92)

------------------------------------------------------------------------
r330 | sakai!sakai | 2004-10-11 02:12:20 -0700 (Mon, 11 Oct 2004) | 7 lines

testamf5.c, testamf3.c:
  correct defalut component name
testamf4.c:
   correct defalut component name

BKrev: 416a4e740QCv2KoVOb0lbFRJYINodA

------------------------------------------------------------------------
r329 | sakai!sakai | 2004-10-11 02:12:20 -0700 (Mon, 11 Oct 2004) | 4 lines

 correct defalut component name

(Logical change 1.92)

------------------------------------------------------------------------
r328 | sakai!sakai | 2004-10-11 00:50:26 -0700 (Mon, 11 Oct 2004) | 5 lines

main.c, handlers.h, evt.c, evs.c, clm.c, ckpt.c, amf.c:
  exec_dump_fn support as SIGUSR2 handler to easy to debug

BKrev: 416a3b42053878SDRpbH_G7EUB4rAQ

------------------------------------------------------------------------
r327 | sakai!sakai | 2004-10-11 00:50:26 -0700 (Mon, 11 Oct 2004) | 4 lines

exec_dump_fn support as SIGUSR2 handler to easy to debug

(Logical change 1.91)

------------------------------------------------------------------------
r326 | mvista.com!sdake | 2004-10-05 13:20:12 -0700 (Tue, 05 Oct 2004) | 7 lines

Auto merged

2004/10/04 16:08:46-07:00 mvista.com!sdake
Remove unneeded debug printf

(Logical change 1.90)

------------------------------------------------------------------------
r325 | mvista.com!sdake | 2004-10-05 13:20:12 -0700 (Tue, 05 Oct 2004) | 5 lines

Change req_header to res_header to match rest of
library, especially for out of order queued messages.

(Logical change 1.90)

------------------------------------------------------------------------
r324 | mvista.com!sdake | 2004-10-05 13:20:12 -0700 (Tue, 05 Oct 2004) | 14 lines

Merge sdake@bk.osdl.org:/var/bk/openais
into persist.az.mvista.com:/home/sdake/openais

2004/10/04 16:10:02-07:00 mvista.com!sdake
testamf.c:
  Change testamf to just test protection group tracking
  and componentcapabilitymodelget.
amf.c:
  Change req_header to res_header to match rest of
  library, especially for out of order queued messages.
  Remove unneeded debug printf

BKrev: 416301fc-l-UbKOcLV0FMuNqzCEQIw

------------------------------------------------------------------------
r323 | mvista.com!sdake | 2004-10-05 13:20:12 -0700 (Tue, 05 Oct 2004) | 8 lines

Auto merged

2004/10/04 16:09:33-07:00 mvista.com!sdake
Change testamf to just test protection group tracking
and componentcapabilitymodelget.

(Logical change 1.90)

------------------------------------------------------------------------
r322 | sakai!sakai | 2004-10-05 09:01:06 -0700 (Tue, 05 Oct 2004) | 5 lines

amf.h, main.c, amf.c:
  add Amfcomponent state dump mechanism

BKrev: 4162c542Q_AtRTLkaWtprRi7H3ew7w

------------------------------------------------------------------------
r321 | sakai!sakai | 2004-10-05 09:01:06 -0700 (Tue, 05 Oct 2004) | 4 lines

add Amfcomponent state dump mechanism

(Logical change 1.89)

------------------------------------------------------------------------
r320 | sakai!sakai | 2004-10-02 02:30:26 -0700 (Sat, 02 Oct 2004) | 4 lines

add surpressing health check printf message

(Logical change 1.88)

------------------------------------------------------------------------
r319 | sakai!sakai | 2004-10-02 02:30:26 -0700 (Sat, 02 Oct 2004) | 7 lines

testamf.c:
  add to reduce health check printf message
testamf6.c, testamf5.c, testamf4.c, testamf3.c, testamf2.c, testamf1.c:
  add to reduce health check printf message

BKrev: 415e7532j5RNbHSwQl4tF2HzMJjayQ

------------------------------------------------------------------------
r318 | sakai!sakai | 2004-10-02 02:30:26 -0700 (Sat, 02 Oct 2004) | 4 lines

add suppressing healthcheck pritf message

(Logical change 1.88)

------------------------------------------------------------------------
r317 | mvista.com!sdake | 2004-10-01 18:23:54 -0700 (Fri, 01 Oct 2004) | 4 lines

Fix a bunch of errors in node get and async node get.

(Logical change 1.87)

------------------------------------------------------------------------
r316 | mvista.com!sdake | 2004-10-01 18:23:54 -0700 (Fri, 01 Oct 2004) | 4 lines

Increase code coverage of clm code.

(Logical change 1.87)

------------------------------------------------------------------------
r315 | mvista.com!sdake | 2004-10-01 18:23:54 -0700 (Fri, 01 Oct 2004) | 7 lines

testclm.c:
  Increase code coverage of clm code.
clm.c, ais_msg.h:
  Fix a bunch of errors in node get and async node get.

BKrev: 415e032aF1mVsl5HqRqEZTGL5S90VA

------------------------------------------------------------------------
r314 | sakai!sakai | 2004-09-28 18:22:03 -0700 (Tue, 28 Sep 2004) | 4 lines

get rid of compile warning

(Logical change 1.86)

------------------------------------------------------------------------
r313 | sakai!sakai | 2004-09-28 18:22:03 -0700 (Tue, 28 Sep 2004) | 5 lines

testckpt.c:
  get rid of compile warning

BKrev: 415a0e3b7pcmfNPh8_SQDhuaxhArpQ

------------------------------------------------------------------------
r312 | osdl.net!markh | 2004-09-28 12:28:57 -0700 (Tue, 28 Sep 2004) | 7 lines

Auto merged

2004/09/28 11:29:35-07:00 mvista.com!sdake
Configuration change support from Miyotaka Sakai.

(Logical change 1.85)

------------------------------------------------------------------------
r311 | osdl.net!markh | 2004-09-28 12:28:57 -0700 (Tue, 28 Sep 2004) | 9 lines

Merge markh@bk.osdl.org:/var/bk/openais
into markh1.pdx.osdl.net:/home/localmarkh/views/BK/openais_event

2004/09/28 11:29:45-07:00 mvista.com!sdake
parse.h, amf.c:
  Configuration change support from Miyotaka Sakai.

BKrev: 4159bb79gTMIV1ezWSXqMb61zwoXkg

------------------------------------------------------------------------
r310 | osdl.net!markh | 2004-09-28 12:28:57 -0700 (Tue, 28 Sep 2004) | 7 lines

Auto merged

2004/09/28 11:29:17-07:00 mvista.com!sdake
Configuration change support from Miyotaka Sakai.

(Logical change 1.85)

------------------------------------------------------------------------
r309 | osdl.net!markh | 2004-09-28 11:29:14 -0700 (Tue, 28 Sep 2004) | 4 lines

Moved the SaNameTisNNameT function to util.c and called it name_match.

(Logical change 1.84)

------------------------------------------------------------------------
r308 | osdl.net!markh | 2004-09-28 11:29:14 -0700 (Tue, 28 Sep 2004) | 4 lines

Replace SaNameTisNameT with name_match from util.[ch]

(Logical change 1.84)

------------------------------------------------------------------------
r307 | osdl.net!markh | 2004-09-28 11:29:14 -0700 (Tue, 28 Sep 2004) | 9 lines

evt code updated to handle cluster config changes better.  Now,
when a node joins, it is sent any retained events that have time
left on them. Also, if the joining node had been a part of the cluster
in the past, it is sent the next event ID that it should use so as to
not generate duplicate event IDs. Channel open requests are now
completed in the exec handler, with channel close code to follow later.

(Logical change 1.84)

------------------------------------------------------------------------
r306 | osdl.net!markh | 2004-09-28 11:29:14 -0700 (Tue, 28 Sep 2004) | 6 lines

Mostly event service updates to handle recovery after a
configuration change. (Selecting next event ID and sending retained
events to the joiner).

BKrev: 4159ad7atHUdo0CF1QjlYHOM-fjAvQ

------------------------------------------------------------------------
r305 | osdl.net!markh | 2004-09-28 11:29:14 -0700 (Tue, 28 Sep 2004) | 4 lines

testparse.c needs util.o now.

(Logical change 1.84)

------------------------------------------------------------------------
r304 | osdl.net!markh | 2004-09-28 11:29:14 -0700 (Tue, 28 Sep 2004) | 2 lines

(Logical change 1.84)

------------------------------------------------------------------------
r303 | osdl.net!markh | 2004-09-28 11:29:14 -0700 (Tue, 28 Sep 2004) | 4 lines

Remove some old TODO comments.

(Logical change 1.84)

------------------------------------------------------------------------
r302 | osdl.net!markh | 2004-09-28 11:29:14 -0700 (Tue, 28 Sep 2004) | 5 lines

Added util.[ch] for time and SaNameT match functions.  Also updated
dependencies.

(Logical change 1.84)

------------------------------------------------------------------------
r301 | osdl.net!markh | 2004-09-28 11:29:14 -0700 (Tue, 28 Sep 2004) | 4 lines

Updates for evt to handle recovery after a config change.

(Logical change 1.84)

------------------------------------------------------------------------
r300 | osdl.net!markh | 2004-09-28 11:29:14 -0700 (Tue, 28 Sep 2004) | 4 lines

added a semi-quiet mode.

(Logical change 1.84)

------------------------------------------------------------------------
r299 | osdl.net!markh | 2004-09-28 11:29:13 -0700 (Tue, 28 Sep 2004) | 2 lines

Initial revision

------------------------------------------------------------------------
r298 | mvista.com!sdake | 2004-09-28 11:14:38 -0700 (Tue, 28 Sep 2004) | 4 lines

Add token callback for recovery routines.

(Logical change 1.83)

------------------------------------------------------------------------
r297 | mvista.com!sdake | 2004-09-28 11:14:38 -0700 (Tue, 28 Sep 2004) | 9 lines

Add token callback for recovery.

gmi.h:
  Add token callback functions to header.
gmi.c:
  Add token callback for recovery routines.

BKrev: 4159aa0ejs1nwJhT7hT1XL-gr9wv2Q

------------------------------------------------------------------------
r296 | mvista.com!sdake | 2004-09-28 11:14:38 -0700 (Tue, 28 Sep 2004) | 4 lines

Add token callback functions to header.

(Logical change 1.83)

------------------------------------------------------------------------
r295 | osdl.net!markh | 2004-09-24 12:44:28 -0700 (Fri, 24 Sep 2004) | 4 lines

Check to see that the message can be sent before proceeding.

(Logical change 1.82)

------------------------------------------------------------------------
r294 | osdl.net!markh | 2004-09-24 12:44:28 -0700 (Fri, 24 Sep 2004) | 5 lines

add assert around clmNodeJoinSend since the call to
gmi_mcast can return a failure now.

(Logical change 1.82)

------------------------------------------------------------------------
r293 | osdl.net!markh | 2004-09-24 12:44:28 -0700 (Fri, 24 Sep 2004) | 4 lines

add assert around gmi_mcast calls since it can return a failure now.

BKrev: 4154791ch3ag3FHVGxaUfrVFsvN3sQ

------------------------------------------------------------------------
r292 | osdl.net!markh | 2004-09-24 12:44:28 -0700 (Fri, 24 Sep 2004) | 4 lines

add assert around gmi_mcast since it can return a failure now.

(Logical change 1.82)

------------------------------------------------------------------------
r291 | mvista.com!sdake | 2004-09-23 15:14:08 -0700 (Thu, 23 Sep 2004) | 5 lines

testparse.c:
  Fix commit error in changeset 1.77.

BKrev: 41534ab0cY4dYHQw-qoPHLMpXQTAAQ

------------------------------------------------------------------------
r290 | mvista.com!sdake | 2004-09-23 15:14:08 -0700 (Thu, 23 Sep 2004) | 4 lines

Fix commit error in changeset 1.77.

(Logical change 1.81)

------------------------------------------------------------------------
r289 | mvista.com!sdake | 2004-09-23 15:12:13 -0700 (Thu, 23 Sep 2004) | 4 lines

Allow getSaNameT to be compiled in for application reporting.

(Logical change 1.80)

------------------------------------------------------------------------
r288 | mvista.com!sdake | 2004-09-23 15:12:13 -0700 (Thu, 23 Sep 2004) | 4 lines

Add sectione xpiration and get checkpoint durations working properly.

(Logical change 1.80)

------------------------------------------------------------------------
r287 | mvista.com!sdake | 2004-09-23 15:12:13 -0700 (Thu, 23 Sep 2004) | 4 lines

Clean up duration and expiration functions.

(Logical change 1.80)

------------------------------------------------------------------------
r286 | mvista.com!sdake | 2004-09-23 15:12:13 -0700 (Thu, 23 Sep 2004) | 4 lines

Finalize expiration of sections and checkpoints.

(Logical change 1.80)

------------------------------------------------------------------------
r285 | mvista.com!sdake | 2004-09-23 15:12:13 -0700 (Thu, 23 Sep 2004) | 4 lines

Test expiration timer.

(Logical change 1.80)

------------------------------------------------------------------------
r284 | mvista.com!sdake | 2004-09-23 15:12:13 -0700 (Thu, 23 Sep 2004) | 4 lines

Fix build error with -DDEBUG set.

(Logical change 1.80)

------------------------------------------------------------------------
r283 | mvista.com!sdake | 2004-09-23 15:12:13 -0700 (Thu, 23 Sep 2004) | 23 lines

Add final support for duration timers on checkpoints and expiration timers.
This cleans up memory leaks that could occur because checkpoints are expected to
cleanup with the expiration and duration timers.

testckpt.c:
  Test expiration timer.
ckptbenchth.c:
  Reduce number of threads so runs with valgrind operate faster.
ckpt.c:
  Clean up duration and expiration functions.
ais_types.h:
  Add sectione xpiration and get checkpoint durations working properly.
ais_msg.h:
  Add section expiration and get checkpoint durations working properly.
ckpt.h, ckpt.c:
  Finalize expiration of sections and checkpoints.
print.c:
  Allow getSaNameT to be compiled in for application reporting.
evs.c:
  Fix build error with -DDEBUG set.

BKrev: 41534a3dcm_0gpB32jNbsek3bGYwXQ

------------------------------------------------------------------------
r282 | mvista.com!sdake | 2004-09-23 15:12:13 -0700 (Thu, 23 Sep 2004) | 4 lines

Reduce number of threads so runs with valgrind operate faster.

(Logical change 1.80)

------------------------------------------------------------------------
r281 | mvista.com!sdake | 2004-09-23 15:12:13 -0700 (Thu, 23 Sep 2004) | 4 lines

Add section expiration and get checkpoint durations working properly.

(Logical change 1.80)

------------------------------------------------------------------------
r280 | mvista.com!sdake | 2004-09-22 18:27:22 -0700 (Wed, 22 Sep 2004) | 9 lines

Store handle address in timer structure.  When timer expires, wipe
out the handle address's value, since the timer is no longer valid.
This allows double frees, or frees on handles that haven't been
added.
One note of caution: a handle cannot be moved into another variable
and be expected to work properly for double frees.

(Logical change 1.79)

------------------------------------------------------------------------
r279 | mvista.com!sdake | 2004-09-22 18:27:22 -0700 (Wed, 22 Sep 2004) | 4 lines

Change define for timer handle.

(Logical change 1.79)

------------------------------------------------------------------------
r278 | mvista.com!sdake | 2004-09-22 18:27:22 -0700 (Wed, 22 Sep 2004) | 14 lines

tlist.h:
  Change interface to allow storing of handle address in timer structure.
aispoll.h, aispoll.c:
  Change define for timer handle.
tlist.c:
  Store handle address in timer structure.  When timer expires, wipe
  out the handle address's value, since the timer is no longer valid.
  This allows double frees, or frees on handles that haven't been
  added.
  One note of caution: a handle cannot be moved into another variable
  and be expected to work properly for double frees.

BKrev: 4152267afe09VjiyO_78GrWKiND_oQ

------------------------------------------------------------------------
r277 | mvista.com!sdake | 2004-09-22 18:27:22 -0700 (Wed, 22 Sep 2004) | 4 lines

Change interface to allow storing of handle address in timer structure.

(Logical change 1.79)

------------------------------------------------------------------------
r276 | mvista.com!sdake | 2004-09-22 12:57:18 -0700 (Wed, 22 Sep 2004) | 4 lines

Fix annoying build failure because of code coverage increases.

(Logical change 1.78)

------------------------------------------------------------------------
r275 | mvista.com!sdake | 2004-09-22 12:57:18 -0700 (Wed, 22 Sep 2004) | 5 lines

testparse.c:
  Fix annoying build failure because of code coverage increases.

BKrev: 4151d91edCQRlmhK78LajPaUV35NyQ

------------------------------------------------------------------------
r274 | mvista.com!sdake | 2004-09-20 18:00:16 -0700 (Mon, 20 Sep 2004) | 5 lines

Add retainined events while also cleaning up memory leakage that occurs
because of a lack of retained events.

(Logical change 1.77)

------------------------------------------------------------------------
r273 | mvista.com!sdake | 2004-09-20 18:00:16 -0700 (Mon, 20 Sep 2004) | 9 lines

Add duration timer support.
ckpt.h:
  Add retained checkpoints timer to checkpoint structure.
ckpt.c:
  Add retained checkpoints while also cleaning up memory leakage that occurs
  because of a lack of retained events.

BKrev: 414f7d20vmWMyWW9eWJST5Ew5sw_yw

------------------------------------------------------------------------
r272 | mvista.com!sdake | 2004-09-20 18:00:16 -0700 (Mon, 20 Sep 2004) | 4 lines

Add retained events timer to checkpoint structure.

(Logical change 1.77)

------------------------------------------------------------------------
r271 | mvista.com!sdake | 2004-09-20 17:57:00 -0700 (Mon, 20 Sep 2004) | 4 lines

Get rid of valgrind warning and possible segfault.

(Logical change 1.76)

------------------------------------------------------------------------
r270 | mvista.com!sdake | 2004-09-20 17:57:00 -0700 (Mon, 20 Sep 2004) | 5 lines

gmi.c:
  Get rid of valgrind warning and possible segfault.

BKrev: 414f7c5cf4HwWODMiTAI2PCkLX1fnw

------------------------------------------------------------------------
r269 | mvista.com!sdake | 2004-09-20 15:18:37 -0700 (Mon, 20 Sep 2004) | 4 lines

Missed merge of these two files from last changeset.

(Logical change 1.75)

------------------------------------------------------------------------
r268 | mvista.com!sdake | 2004-09-20 15:18:37 -0700 (Mon, 20 Sep 2004) | 5 lines

handlers.h, gmi.h:
  Missed merge of these two files from last changeset.

BKrev: 414f573d4f7iW8ZMEKLNAImK24Vn3g

------------------------------------------------------------------------
r267 | mvista.com!sdake | 2004-09-18 00:03:51 -0700 (Sat, 18 Sep 2004) | 5 lines

Add recovery plug support to evs.
l

(Logical change 1.74)

------------------------------------------------------------------------
r266 | mvista.com!sdake | 2004-09-18 00:03:51 -0700 (Sat, 18 Sep 2004) | 4 lines

Add recovery plug support to amf.

(Logical change 1.74)

------------------------------------------------------------------------
r265 | mvista.com!sdake | 2004-09-18 00:03:51 -0700 (Sat, 18 Sep 2004) | 26 lines

Add recovery plug support to openais.  This allows messages that are recovery
messages to be blocked until recovery completes.  All low/medium/high messages
cannot be transmitted until all processors have unplugged themselves.  If a
configuration change occurs, the plugs are invalidated and the recovery starts
again.

Makefile:
  Remove two build errors with extra object file included that is not needed.
main.c:
  Add recovery plug support.
gmi.c:
  Add recovery plug support to group messaging.
evt.c:
  Add recovery plug support to evt.
evs.c:
  Add recovery plug support to evs.
  l
clm.c:
  Add recovery plug support to clm.
ckpt.c:
  Add recovery plug support to ckpt.
amf.c:
  Add recovery plug support to amf.

BKrev: 414bddd7HCsNs1rz-sJV92mB6fupCw

------------------------------------------------------------------------
r264 | mvista.com!sdake | 2004-09-18 00:03:51 -0700 (Sat, 18 Sep 2004) | 4 lines

Add recovery plug support to clm.

(Logical change 1.74)

------------------------------------------------------------------------
r263 | mvista.com!sdake | 2004-09-18 00:03:51 -0700 (Sat, 18 Sep 2004) | 4 lines

Add recovery plug support to group messaging.

(Logical change 1.74)

------------------------------------------------------------------------
r262 | mvista.com!sdake | 2004-09-18 00:03:51 -0700 (Sat, 18 Sep 2004) | 4 lines

Add recovery plug support to evt.

(Logical change 1.74)

------------------------------------------------------------------------
r261 | mvista.com!sdake | 2004-09-18 00:03:51 -0700 (Sat, 18 Sep 2004) | 4 lines

Add recovery plug support.

(Logical change 1.74)

------------------------------------------------------------------------
r260 | mvista.com!sdake | 2004-09-18 00:03:51 -0700 (Sat, 18 Sep 2004) | 4 lines

Remove two build errors with extra object file included that is not needed.

(Logical change 1.74)

------------------------------------------------------------------------
r259 | mvista.com!sdake | 2004-09-18 00:03:51 -0700 (Sat, 18 Sep 2004) | 4 lines

Add recovery plug support to ckpt.

(Logical change 1.74)

------------------------------------------------------------------------
r258 | mvista.com!sdake | 2004-09-15 17:20:18 -0700 (Wed, 15 Sep 2004) | 6 lines

gmi.c:
  Bug 44.
  Fixes assertion in executive when running ckptbenchth.

BKrev: 4148dc42NSqyi9F4s6exhsVarsF10Q

------------------------------------------------------------------------
r257 | mvista.com!sdake | 2004-09-15 17:20:18 -0700 (Wed, 15 Sep 2004) | 5 lines

Bug 44.
Fixes assertion in executive when running ckptbenchth.

(Logical change 1.73)

------------------------------------------------------------------------
r256 | mvista.com!sdake | 2004-09-15 13:54:42 -0700 (Wed, 15 Sep 2004) | 6 lines

main.c:
  Call poll_destroy when executing ais_done.  This increases code
  coverage from 66.9% to 82.3%.

BKrev: 4148ac12oFAraidHBF8lhdpMgBXc1w

------------------------------------------------------------------------
r255 | mvista.com!sdake | 2004-09-15 13:54:42 -0700 (Wed, 15 Sep 2004) | 5 lines

Call poll_destroy when executing ais_done.  This increases code
coverage from 66.9% to 82.3%.

(Logical change 1.72)

------------------------------------------------------------------------
r254 | mvista.com!sdake | 2004-09-15 13:37:39 -0700 (Wed, 15 Sep 2004) | 6 lines

Increase code coverage from 19.4% to 100% by adding defines
to remove debug print code in production builds.  Also removed
function by ifdef that is never used in the project.

(Logical change 1.71)

------------------------------------------------------------------------
r253 | mvista.com!sdake | 2004-09-15 13:37:39 -0700 (Wed, 15 Sep 2004) | 7 lines

print.c:
  Increase code coverage from 19.4% to 100% by adding defines
  to remove debug print code in production builds.  Also removed
  function by ifdef that is never used in the project.

BKrev: 4148a813APgP44Mw4XR-P--e0qYzTw

------------------------------------------------------------------------
r252 | mvista.com!sdake | 2004-09-15 13:30:02 -0700 (Wed, 15 Sep 2004) | 4 lines

Increased code coverage of tlist.c from 74.5% to 95.9%.

(Logical change 1.70)

------------------------------------------------------------------------
r251 | mvista.com!sdake | 2004-09-15 13:30:02 -0700 (Wed, 15 Sep 2004) | 5 lines

tlist.c:
  Increased code coverage of tlist.c from 74.5% to 95.9%.

BKrev: 4148a64akC3-Hr8RMOSHHChVWBYM5Q

------------------------------------------------------------------------
r250 | mvista.com!sdake | 2004-09-15 13:20:07 -0700 (Wed, 15 Sep 2004) | 4 lines

Remove unused code.

(Logical change 1.69)

------------------------------------------------------------------------
r249 | mvista.com!sdake | 2004-09-15 13:20:07 -0700 (Wed, 15 Sep 2004) | 9 lines

crypto.h:
  Remove unused code.
crypto.c:
  Remove unused code and change some error detection to assertions.
  This increases code covergae from 80.2% to 92.7% with no change
  in functionality.

BKrev: 4148a3f73A3zw2reb3HkDh6RWIrcag

------------------------------------------------------------------------
r248 | mvista.com!sdake | 2004-09-15 13:20:07 -0700 (Wed, 15 Sep 2004) | 6 lines

Remove unused code and change some error detection to assertions.
This increases code covergae from 80.2% to 92.7% with no change
in functionality.

(Logical change 1.69)

------------------------------------------------------------------------
r247 | mvista.com!sdake | 2004-09-09 18:04:29 -0700 (Thu, 09 Sep 2004) | 6 lines

BUG 37.  Fix several leaks during configuration changes.  Also fixes
a possible assert with many large messages being sent from multiple
processors at the same time.

(Logical change 1.68)

------------------------------------------------------------------------
r246 | mvista.com!sdake | 2004-09-09 18:04:29 -0700 (Thu, 09 Sep 2004) | 7 lines

gmi.c:
  BUG 37.  Fix several leaks during configuration changes.  Also fixes
  a possible assert with many large messages being sent from multiple
  processors at the same time.

BKrev: 4140fd9dwjk3xOLpFw3Ivhp0_f_oYw

------------------------------------------------------------------------
r245 | mvista.com!sdake | 2004-09-08 01:11:56 -0700 (Wed, 08 Sep 2004) | 13 lines

Merge sdake@bk.osdl.org:/var/bk/openais
into persist.az.mvista.com:/home/sdake/openais

2004/09/08 01:11:43-07:00 mvista.com!sdake
Code coverage support in build environment and test programs.

Many files:
  Add signal handler so code coverage records coverage
Makefile:
  Add code coverage build options and make clean target

BKrev: 413ebecc_2LPT2fuaQZhw9BymLz6bQ

------------------------------------------------------------------------
r244 | mvista.com!sdake | 2004-09-08 01:11:56 -0700 (Wed, 08 Sep 2004) | 4 lines

Add signal handler so code coverage records coverage

(Logical change 1.67)

------------------------------------------------------------------------
r243 | mvista.com!sdake | 2004-09-08 01:11:56 -0700 (Wed, 08 Sep 2004) | 4 lines

Add code coverage build options and make clean target

(Logical change 1.67)

------------------------------------------------------------------------
r242 | broked.org!sdake | 2004-09-07 20:25:56 -0700 (Tue, 07 Sep 2004) | 6 lines

Get rid of magic number 1500 and replace with PACKET_SIZE_MAX.
Also fix a glaring memory overwrite bug in gmi_init which would
init 256k of memory instead of PACKET_SIZE_MAX memory.

(Logical change 1.66)

------------------------------------------------------------------------
r241 | broked.org!sdake | 2004-09-07 20:25:56 -0700 (Tue, 07 Sep 2004) | 7 lines

gmi.c:
  Get rid of magic number 1500 and replace with PACKET_SIZE_MAX.
  Also fix a glaring memory overwrite bug in gmi_init which would
  init 256k of memory instead of PACKET_SIZE_MAX memory.

BKrev: 413e7bc48wgkqG1E4wSbG9KQkBJMkg

------------------------------------------------------------------------
r240 | broked.org!sdake | 2004-09-07 08:18:12 -0700 (Tue, 07 Sep 2004) | 5 lines

EVS library makes compiler warning on some compilers.  Found and fixed by
Sakai Miyotaka.

(Logical change 1.65)

------------------------------------------------------------------------
r239 | osdl.net!markh | 2004-09-07 08:18:12 -0700 (Tue, 07 Sep 2004) | 7 lines

Merge

2004/09/04 16:52:55-07:00 broked.org!sdake
Makefile missing clean target for evs bench.  Found and fixed by Sakai Miyotaka.

(Logical change 1.65)

------------------------------------------------------------------------
r238 | broked.org!sdake | 2004-09-07 08:18:12 -0700 (Tue, 07 Sep 2004) | 2 lines

(Logical change 1.65)

------------------------------------------------------------------------
r237 | osdl.net!markh | 2004-09-07 08:18:12 -0700 (Tue, 07 Sep 2004) | 20 lines

Merge

2004/09/06 13:30:28-07:00 broked.org!sdake
Added man pages and html generation for the EVS interface.

2004/09/04 16:54:20-07:00 broked.org!sdake
One serious bug in AMF and a few minor nits fixed from patch
from Sakai Miyotaka.
Makefile:
  Makefile missing clean target for evs bench.  Found and fixed by Sakai Miyotaka.
evs.c:
  EVS library makes compiler warning on some compilers.  Found and fixed by
  Sakai Miyotaka.
amf.c:
  State change from standby-active to outofservice could
  result in invalid number of active units.  Found and fixed by
  Sakai Miyotaka.

BKrev: 413dd134zK97xpVttMuRVm6GdcbQlg

------------------------------------------------------------------------
r236 | broked.org!sdake | 2004-09-07 08:18:12 -0700 (Tue, 07 Sep 2004) | 6 lines

State change from standby-active to outofservice could
result in invalid number of active units.  Found and fixed by
Sakai Miyotaka.

(Logical change 1.65)

------------------------------------------------------------------------
r235 | broked.org!sdake | 2004-09-07 08:18:11 -0700 (Tue, 07 Sep 2004) | 2 lines

Initial revision

------------------------------------------------------------------------
r234 | osdl.net!markh | 2004-09-07 08:14:59 -0700 (Tue, 07 Sep 2004) | 4 lines

Clean up some comments code. (comments, old macro).

(Logical change 1.64)

------------------------------------------------------------------------
r233 | osdl.net!markh | 2004-09-07 08:14:59 -0700 (Tue, 07 Sep 2004) | 4 lines

Add return value to main.

(Logical change 1.64)

------------------------------------------------------------------------
r232 | osdl.net!markh | 2004-09-07 08:14:59 -0700 (Tue, 07 Sep 2004) | 4 lines

Some code cleanup.

BKrev: 413dd073MFU2gjJ72eQd8SOvDfpBwQ

------------------------------------------------------------------------
r231 | osdl.net!markh | 2004-09-02 10:16:25 -0700 (Thu, 02 Sep 2004) | 4 lines

Development, updates, and bug fixes to event service lib.

(Logical change 1.63)

------------------------------------------------------------------------
r230 | osdl.net!markh | 2004-09-02 10:16:25 -0700 (Thu, 02 Sep 2004) | 5 lines

Added special SA_CLM_LOCAL_NODE_ID case to receive your own
cluster node data.

(Logical change 1.63)

------------------------------------------------------------------------
r229 | osdl.net!markh | 2004-09-02 10:16:25 -0700 (Thu, 02 Sep 2004) | 2 lines

(Logical change 1.63)

------------------------------------------------------------------------
r228 | osdl.net!markh | 2004-09-02 10:16:25 -0700 (Thu, 02 Sep 2004) | 5 lines

Added event testing programs:
evtbench, subscription, publish

(Logical change 1.63)

------------------------------------------------------------------------
r227 | osdl.net!markh | 2004-09-02 10:16:25 -0700 (Thu, 02 Sep 2004) | 4 lines

Add in list_add_tail and list_empty functions

(Logical change 1.63)

------------------------------------------------------------------------
r226 | osdl.net!markh | 2004-09-02 10:16:25 -0700 (Thu, 02 Sep 2004) | 5 lines

Check to make sure that sequence ID passed into sq_item_inuse is
valid.

(Logical change 1.63)

------------------------------------------------------------------------
r225 | osdl.net!markh | 2004-09-02 10:16:25 -0700 (Thu, 02 Sep 2004) | 4 lines

Event Service Implementation and fixes.

BKrev: 41375569R3AaZBcK1LtaD9gt36SuLQ

------------------------------------------------------------------------
r224 | osdl.net!markh | 2004-09-02 10:16:25 -0700 (Thu, 02 Sep 2004) | 4 lines

Add event service message types.

(Logical change 1.63)

------------------------------------------------------------------------
r223 | osdl.net!markh | 2004-09-02 10:16:25 -0700 (Thu, 02 Sep 2004) | 4 lines

Completed most of the event service functionality.

(Logical change 1.63)

------------------------------------------------------------------------
r222 | osdl.net!markh | 2004-09-02 10:16:24 -0700 (Thu, 02 Sep 2004) | 2 lines

Initial revision

------------------------------------------------------------------------
r221 | broked.org!sdake | 2004-08-31 01:21:44 -0700 (Tue, 31 Aug 2004) | 4 lines

Mark a bug for later resolution

(Logical change 1.62)

------------------------------------------------------------------------
r220 | broked.org!sdake | 2004-08-31 01:21:44 -0700 (Tue, 31 Aug 2004) | 5 lines

Added the EVS service and changed the library queue
to 256 entries.

(Logical change 1.62)

------------------------------------------------------------------------
r219 | broked.org!sdake | 2004-08-31 01:21:44 -0700 (Tue, 31 Aug 2004) | 9 lines

Major rewrite of saRecvQueue.  Fixed is:
activate poll messages are not sent over and over
The message header is read into the return buffer
if the message doesn't match, a new message is allocated
This allows the message buffer for saRecvQueue to be
small, but allows receiving very large messages.

(Logical change 1.62)

------------------------------------------------------------------------
r218 | broked.org!sdake | 2004-08-31 01:21:44 -0700 (Tue, 31 Aug 2004) | 4 lines

Add the evs library

(Logical change 1.62)

------------------------------------------------------------------------
r217 | broked.org!sdake | 2004-08-31 01:21:44 -0700 (Tue, 31 Aug 2004) | 4 lines

Added the evs target.

(Logical change 1.62)

------------------------------------------------------------------------
r216 | broked.org!sdake | 2004-08-31 01:21:44 -0700 (Tue, 31 Aug 2004) | 49 lines

This changeset includes major fixes to the IPC from the executive
to the library.  Also included is an entirely new API called the
EVS api (Extended Virtual Synchrony).  This API provides EVS semantics
for those developers that require this model of programming.  The
API is defined in include/evs.h and is very simple.

The API provides:
group semantics with 32 byte group keys.
delivery callback
configuration change callback
join one or more groups
leave one or more groups
multicast a message to the instance's joined groups
multicast a message to any other group

Makefile:
  Add the testevs and evsbench targets.
evs.c, testevs.c, evsbench.c, evs.h:
  new file
Makefile:
  Add the evs library
util.c:
  Major rewrite of saRecvQueue.  Fixed is:
  activate poll messages are not sent over and over
  The message header is read into the return buffer
  if the message doesn't match, a new message is allocated
  This allows the message buffer for saRecvQueue to be
  small, but allows receiving very large messages.
amf.c:
  Mark a bug for later resolution
ais_msg.h:
  Add the evs messages and descriptors.
Makefile:
  Added the evs target.
main.h:
  Added the EVS service and changed the library queue
  to 256 entries.
main.c:
  major rewrite of the IPC code for sending messages
  to the library.  What was there previously was very
  broken.
gmi.c:
  Fix bug where transition from multiple members to
  single members would cause messages not to be sent.
  Also fixed an assertion in transition from multiple
  processors to one processor.

BKrev: 41343518pVUD6aQu4urTw6ClPiOl3w

------------------------------------------------------------------------
r215 | broked.org!sdake | 2004-08-31 01:21:44 -0700 (Tue, 31 Aug 2004) | 4 lines

Add the testevs and evsbench targets.

(Logical change 1.62)

------------------------------------------------------------------------
r214 | broked.org!sdake | 2004-08-31 01:21:44 -0700 (Tue, 31 Aug 2004) | 6 lines

major rewrite of the IPC code for sending messages
to the library.  What was there previously was very
broken.

(Logical change 1.62)

------------------------------------------------------------------------
r213 | broked.org!sdake | 2004-08-31 01:21:44 -0700 (Tue, 31 Aug 2004) | 4 lines

Add the evs messages and descriptors.

(Logical change 1.62)

------------------------------------------------------------------------
r212 | broked.org!sdake | 2004-08-31 01:21:44 -0700 (Tue, 31 Aug 2004) | 2 lines

(Logical change 1.62)

------------------------------------------------------------------------
r211 | broked.org!sdake | 2004-08-31 01:21:44 -0700 (Tue, 31 Aug 2004) | 7 lines

Fix bug where transition from multiple members to
single members would cause messages not to be sent.
Also fixed an assertion in transition from multiple
processors to one processor.

(Logical change 1.62)

------------------------------------------------------------------------
r210 | broked.org!sdake | 2004-08-31 01:21:43 -0700 (Tue, 31 Aug 2004) | 2 lines

Initial revision

------------------------------------------------------------------------
r209 | mvista.com!sdake | 2004-08-27 17:37:34 -0700 (Fri, 27 Aug 2004) | 7 lines

gmi.c:
  Flush all multicast messages by delivering them before
  processing the token.  This ensures that the mcast fd
  doesn't buffer too many old messages and avoids an assert.

BKrev: 412fd3cesE7M-pXl9OZs1X2CyK7Y4A

------------------------------------------------------------------------
r208 | mvista.com!sdake | 2004-08-27 17:37:34 -0700 (Fri, 27 Aug 2004) | 6 lines

Flush all multicast messages by delivering them before
processing the token.  This ensures that the mcast fd
doesn't buffer too many old messages and avoids an assert.

(Logical change 1.61)

------------------------------------------------------------------------
r207 | mvista.com!sdake | 2004-08-23 18:21:33 -0700 (Mon, 23 Aug 2004) | 4 lines

Add initial support for multipathing to group messaging.

(Logical change 1.60)

------------------------------------------------------------------------
r206 | mvista.com!sdake | 2004-08-23 18:21:33 -0700 (Mon, 23 Aug 2004) | 4 lines

Change gmi interface to support multipathing.

(Logical change 1.60)

------------------------------------------------------------------------
r205 | mvista.com!sdake | 2004-08-23 18:21:33 -0700 (Mon, 23 Aug 2004) | 5 lines

Change network configuration parser interface to support
multipathing.

(Logical change 1.60)

------------------------------------------------------------------------
r204 | mvista.com!sdake | 2004-08-23 18:21:33 -0700 (Mon, 23 Aug 2004) | 12 lines

parse.h:
  Change network configuration parser interface to support
  multipathing.
gmi.h, main.c:
  Change gmi interface to support multipathing.
parse.c:
  Change network configuration parser to read multiple interfaces.
gmi.c:
  Add initial support for multipathing to group messaging.

BKrev: 412a981dC8TjKSqUYOtAx6jKoO-UlA

------------------------------------------------------------------------
r203 | mvista.com!sdake | 2004-08-23 18:21:33 -0700 (Mon, 23 Aug 2004) | 4 lines

Change network configuration parser to read multiple interfaces.

(Logical change 1.60)

------------------------------------------------------------------------
r202 | osdl.net!markh | 2004-08-23 15:27:07 -0700 (Mon, 23 Aug 2004) | 4 lines

Need to check the size of the response header here.

(Logical change 1.59)

------------------------------------------------------------------------
r201 | osdl.net!markh | 2004-08-23 15:27:07 -0700 (Mon, 23 Aug 2004) | 5 lines

Need to check the size of the response header instead of the
request header in saRecvQueue.

BKrev: 412a6f3b4NlVb-n94TuM1jqiD4KUgA

------------------------------------------------------------------------
r200 | mvista.com!sdake | 2004-08-22 22:24:21 -0700 (Sun, 22 Aug 2004) | 8 lines

Clean up usage of ais_done.  This includes passing a
value for each done type.  Also, libais_disconnect cleaned up
so it doesn't ais_done when its queues are full.  Instead it
disconnects the library connection.  A new connection state
variable added to the conn_info structure in place of active.

(Logical change 1.58)

------------------------------------------------------------------------
r199 | mvista.com!sdake | 2004-08-22 22:24:21 -0700 (Sun, 22 Aug 2004) | 5 lines

Changed number of queueable messages to the library from 8192
to 128 messages.

(Logical change 1.58)

------------------------------------------------------------------------
r198 | mvista.com!sdake | 2004-08-22 22:24:21 -0700 (Sun, 22 Aug 2004) | 4 lines

Use new connection enumeration with AMF code.

(Logical change 1.58)

------------------------------------------------------------------------
r197 | mvista.com!sdake | 2004-08-22 22:24:21 -0700 (Sun, 22 Aug 2004) | 14 lines

main.h:
  Changed number of queueable messages to the library from 8192
  to 128 messages.
main.c:
  Clean up usage of ais_done.  This includes passing a
  value for each done type.  Also, libais_disconnect cleaned up
  so it doesn't ais_done when its queues are full.  Instead it
  disconnects the library connection.  A new connection state
  variable added to the conn_info structure in place of active.
amf.c:
  Use new connection enumeration with AMF code.

BKrev: 41297f85ZsPdr8oHUfjQ6v_A6b6ybw

------------------------------------------------------------------------
r196 | mvista.com!sdake | 2004-08-22 16:04:53 -0700 (Sun, 22 Aug 2004) | 4 lines

Missed commit to changes for queue.h.

(Logical change 1.57)

------------------------------------------------------------------------
r195 | mvista.com!sdake | 2004-08-22 16:04:53 -0700 (Sun, 22 Aug 2004) | 7 lines

queue.h:
  Missed commit to changes for queue.h.
ais_msg.h:
  Missed commit of changes to ais_msg.h.

BKrev: 41292695YG_qjNyfkNoFlMFaeiR7zg

------------------------------------------------------------------------
r194 | mvista.com!sdake | 2004-08-22 16:04:53 -0700 (Sun, 22 Aug 2004) | 4 lines

Missed commit of changes to ais_msg.h.

(Logical change 1.57)

------------------------------------------------------------------------
r193 | mvista.com!sdake | 2004-08-22 15:46:29 -0700 (Sun, 22 Aug 2004) | 8 lines

Add flow control documentation to devmap.
.l

2004/08/22 15:24:25-07:00 mvista.com!sdake
Add event service to devmap.

(Logical change 1.56)

------------------------------------------------------------------------
r192 | mvista.com!sdake | 2004-08-22 15:46:29 -0700 (Sun, 22 Aug 2004) | 6 lines

README.devmap:
  Add flow control documentation to devmap.
  Add event service to devmap.

BKrev: 412922454HMPjB41f5bgMaos4soalg

------------------------------------------------------------------------
r191 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Cleanup errors in Makefile.

(Logical change 1.55)

------------------------------------------------------------------------
r190 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Change interface so there is a new libais_handler structure.

(Logical change 1.55)

------------------------------------------------------------------------
r189 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Add support for flow control to amf library.

(Logical change 1.55)

------------------------------------------------------------------------
r188 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Add support to group messaging to get flow control information.

(Logical change 1.55)

------------------------------------------------------------------------
r187 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Add flow control support to the checkpoint benchmark program.

(Logical change 1.55)

------------------------------------------------------------------------
r186 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Flow control changes.

(Logical change 1.55)

------------------------------------------------------------------------
r185 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 40 lines

testamf3.c:
  misc flow control changes.
ckptbenchth.c:
  Retry checkpoint writes on threaded writes if SA_ERR_TRY_AGAIn
  received.
ckptbench.c:
  Add flow control support to the checkpoint benchmark program.
util.c:
  Add flow control to saRecvQueue function.
evt.c:
  Add flow control to eventing.
clm.c:
  Add flow control to cluster membership.
ckpt.c:
  Add flow control to checkpointing.
amf.c:
  Add flow control to amf.
Makefile:
  Cleanup errors in Makefile.
main.h:
  Flow control changes.
handlers.h:
  Change interface so there is a new libais_handler structure.
gmi.h:
  Add support to group messaging for another priority level.
main.c:
  Add support to disconnect and dispatch to utilize flow control.
gmi.c:
  Add support to group messaging to get flow control information.
evt.c:
  Add support to eventing for flow control.
clm.c:
  Add support to clm for flow control.
ckpt.c:
  Add support for flow control to ckpt library.
amf.c:
  Add support for flow control to amf library.

BKrev: 412678baBKkyszbWcphf0Vg85SpLXg

------------------------------------------------------------------------
r184 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 5 lines

Retry checkpoint writes on threaded writes if SA_ERR_TRY_AGAIn
received.

(Logical change 1.55)

------------------------------------------------------------------------
r183 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Add support to group messaging for another priority level.

(Logical change 1.55)

------------------------------------------------------------------------
r182 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Add flow control to eventing.

(Logical change 1.55)

------------------------------------------------------------------------
r181 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Add flow control to cluster membership.

(Logical change 1.55)

------------------------------------------------------------------------
r180 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Add support to eventing for flow control.

(Logical change 1.55)

------------------------------------------------------------------------
r179 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Add support to disconnect and dispatch to utilize flow control.

(Logical change 1.55)

------------------------------------------------------------------------
r178 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Add flow control to amf.

(Logical change 1.55)

------------------------------------------------------------------------
r177 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Add support for flow control to ckpt library.

(Logical change 1.55)

------------------------------------------------------------------------
r176 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

misc flow control changes.

(Logical change 1.55)

------------------------------------------------------------------------
r175 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Add flow control to saRecvQueue function.

(Logical change 1.55)

------------------------------------------------------------------------
r174 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Add flow control to checkpointing.

(Logical change 1.55)

------------------------------------------------------------------------
r173 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Add support to clm for flow control.

(Logical change 1.55)

------------------------------------------------------------------------
r172 | broked.org!sdake | 2004-08-14 02:25:33 -0700 (Sat, 14 Aug 2004) | 5 lines

Add priority to poll abstraction
Higher priority items will be serviced first

(Logical change 1.54)

------------------------------------------------------------------------
r171 | broked.org!sdake | 2004-08-14 02:25:33 -0700 (Sat, 14 Aug 2004) | 18 lines

Priorites added to dispatch function.  This is in prep for flow
control to allow dispatch functions that haven't been serviced
in awhile to be bumped up in priority when they are not serviced.

The priority of the dispatch handler is passed to the dispatch
function which can modify it in place.  The new priority will be
used the next time the poll system call is executed.

main.c:
  Add library accept handler at lowest priority
gmi.c:
  Make gmi highest priority when adding dispatch functions
aispoll.h, aispoll.c:
  Add priority to poll abstraction
  Higher priority items will be serviced first

BKrev: 411dda8dXGsq4glmjj36km40YZhjCA

------------------------------------------------------------------------
r170 | broked.org!sdake | 2004-08-14 02:25:33 -0700 (Sat, 14 Aug 2004) | 4 lines

Make gmi highest priority when adding dispatch functions

(Logical change 1.54)

------------------------------------------------------------------------
r169 | broked.org!sdake | 2004-08-14 02:25:33 -0700 (Sat, 14 Aug 2004) | 4 lines

Add library accept handler at lowest priority

(Logical change 1.54)

------------------------------------------------------------------------
r168 | broked.org!sdake | 2004-08-09 21:47:05 -0700 (Mon, 09 Aug 2004) | 9 lines

gmi.c:
  When 2 processors are part of the configuration, then one
  of the members leaves, then a new configuration occurs
  with 2 or more members, the "joined" list was not
  being properly passed to the rest of the executive
  services.  This bug fixed.

BKrev: 41185349SwUWKZU-QQ_K91jAnvqYpA

------------------------------------------------------------------------
r167 | broked.org!sdake | 2004-08-09 21:47:05 -0700 (Mon, 09 Aug 2004) | 8 lines

When 2 processors are part of the configuration, then one
of the members leaves, then a new configuration occurs
with 2 or more members, the "joined" list was not
being properly passed to the rest of the executive
services.  This bug fixed.

(Logical change 1.53)

------------------------------------------------------------------------
r166 | mvista.com!sdake | 2004-08-09 14:32:37 -0700 (Mon, 09 Aug 2004) | 4 lines

Add encryption and authentication to GMI.

(Logical change 1.52)

------------------------------------------------------------------------
r165 | mvista.com!sdake | 2004-08-09 14:32:37 -0700 (Mon, 09 Aug 2004) | 19 lines

Add encryption and authentication to all messages so that messages are secret
and are always known to come from a source that knows the private key.

SECURITY:
  Describe latest security system using SOBER, SHA1, and HMAC.
QUICKSTART:
  Add details to creating security key to quickstart guide.
LICENSE:
  Add libtomcrypt's license text for crypto.c and crypto.h
Makefile:
  Add crytpo features to makefile
gmi.h:
  Add ability to pass key and keylen to gmi_init.
  Add ability to set security logging value.
gmi.c:
  Add encryption and authentication to GMI.

BKrev: 4117ed75MEkDZv2CoCUYGolBNHy17Q

------------------------------------------------------------------------
r164 | mvista.com!sdake | 2004-08-09 14:32:37 -0700 (Mon, 09 Aug 2004) | 4 lines

Add details to creating security key to quickstart guide.

(Logical change 1.52)

------------------------------------------------------------------------
r163 | mvista.com!sdake | 2004-08-09 14:32:37 -0700 (Mon, 09 Aug 2004) | 5 lines

Add ability to pass key and keylen to gmi_init.
Add ability to set security logging value.

(Logical change 1.52)

------------------------------------------------------------------------
r162 | mvista.com!sdake | 2004-08-09 14:32:37 -0700 (Mon, 09 Aug 2004) | 4 lines

Add libtomcrypt's license text for crypto.c and crypto.h

(Logical change 1.52)

------------------------------------------------------------------------
r161 | mvista.com!sdake | 2004-08-09 14:32:37 -0700 (Mon, 09 Aug 2004) | 4 lines

Add crytpo features to makefile

(Logical change 1.52)

------------------------------------------------------------------------
r160 | mvista.com!sdake | 2004-08-09 14:32:37 -0700 (Mon, 09 Aug 2004) | 2 lines

(Logical change 1.52)

------------------------------------------------------------------------
r159 | mvista.com!sdake | 2004-08-09 14:32:37 -0700 (Mon, 09 Aug 2004) | 4 lines

Describe latest security system using SOBER, SHA1, and HMAC.

(Logical change 1.52)

------------------------------------------------------------------------
r158 | mvista.com!sdake | 2004-08-09 14:29:42 -0700 (Mon, 09 Aug 2004) | 5 lines

keygen.c, crypto.h, crypto.c:
New files for cryptography support.

BKrev: 4117ecc6HWTXJ7DG7UZ3E01aKajTBA

------------------------------------------------------------------------
r157 | mvista.com!sdake | 2004-08-09 14:29:42 -0700 (Mon, 09 Aug 2004) | 2 lines

(Logical change 1.51)

------------------------------------------------------------------------
r156 | mvista.com!sdake | 2004-08-09 14:29:41 -0700 (Mon, 09 Aug 2004) | 2 lines

Initial revision

------------------------------------------------------------------------
r155 | osdl.net!markh | 2004-07-30 10:51:32 -0700 (Fri, 30 Jul 2004) | 4 lines

Fix compiler warning

(Logical change 1.50)

------------------------------------------------------------------------
r154 | osdl.net!markh | 2004-07-30 10:51:32 -0700 (Fri, 30 Jul 2004) | 4 lines

Fix compiler warning

BKrev: 410a8aa45tOLcJaeS6TU0H7l55hYiQ

------------------------------------------------------------------------
r153 | osdl.net!markh | 2004-07-30 10:49:14 -0700 (Fri, 30 Jul 2004) | 4 lines

Fix queue items memory leak.

(Logical change 1.49)

------------------------------------------------------------------------
r152 | osdl.net!markh | 2004-07-30 10:49:14 -0700 (Fri, 30 Jul 2004) | 4 lines

Fix queue items memory leak.

BKrev: 410a8a1arpYlwWZY9PRvbEkRYy7zkQ

------------------------------------------------------------------------
r151 | mvista.com!sdake | 2004-07-29 16:00:43 -0700 (Thu, 29 Jul 2004) | 6 lines

Change RecvQueue to use a stack structure for receiving the
response instead of passing in the maximum sized value for a
response message.

(Logical change 1.48)

------------------------------------------------------------------------
r150 | mvista.com!sdake | 2004-07-29 16:00:43 -0700 (Thu, 29 Jul 2004) | 7 lines

Clean up RecvQueue users and pass in actual buffer instead
of "overly large" buffer which has changed because of changes
to util.c
Also cleaned up memory leak in the dispatch function.

(Logical change 1.48)

------------------------------------------------------------------------
r149 | mvista.com!sdake | 2004-07-29 16:00:43 -0700 (Thu, 29 Jul 2004) | 15 lines

util.c:
  Change RecvQueue to use a stack structure for receiving the
  response instead of passing in the maximum sized value for a
  response message.
ckpt.c:
  Change all RecvQueue users to use RecvRetry since there is no
  reason to queue out of order messages.
amf.c:
  Clean up RecvQueue users and pass in actual buffer instead
  of "overly large" buffer which has changed because of changes
  to util.c
  Also cleaned up memory leak in the dispatch function.

BKrev: 4109819b_adTTm4cCZmfLJcsYb9hyA

------------------------------------------------------------------------
r148 | mvista.com!sdake | 2004-07-29 16:00:43 -0700 (Thu, 29 Jul 2004) | 5 lines

Change all RecvQueue users to use RecvRetry since there is no
reason to queue out of order messages.

(Logical change 1.48)

------------------------------------------------------------------------
r147 | mvista.com!sdake | 2004-07-29 12:53:46 -0700 (Thu, 29 Jul 2004) | 2 lines

(Logical change 1.47)

------------------------------------------------------------------------
r146 | mvista.com!sdake | 2004-07-29 12:53:46 -0700 (Thu, 29 Jul 2004) | 5 lines

Add function in exec/clm to get the full cluster node information
for any node in the cluster membership

(Logical change 1.47)

------------------------------------------------------------------------
r145 | osdl.net!markh | 2004-07-29 12:53:46 -0700 (Thu, 29 Jul 2004) | 10 lines

Merge bk://bk.osdl.org/openais
into markh1.pdx.osdl.net:/home/localmarkh/views/BK/openais_stage

2004/07/29 12:26:46-07:00 mvista.com!sdake
clm.c:
  Add function in exec/clm to get the full cluster node information
  for any node in the cluster membership

BKrev: 410955capPzVdVwzpMJetS80seWS7g

------------------------------------------------------------------------
r144 | osdl.net!markh | 2004-07-29 11:41:43 -0700 (Thu, 29 Jul 2004) | 4 lines

Added event code and dependencies.

(Logical change 1.46)

------------------------------------------------------------------------
r143 | osdl.net!markh | 2004-07-29 11:41:43 -0700 (Thu, 29 Jul 2004) | 4 lines

added event message types and associated data structures.

(Logical change 1.46)

------------------------------------------------------------------------
r142 | osdl.net!markh | 2004-07-29 11:41:43 -0700 (Thu, 29 Jul 2004) | 4 lines

Event service data types.

(Logical change 1.46)

------------------------------------------------------------------------
r141 | osdl.net!markh | 2004-07-29 11:41:43 -0700 (Thu, 29 Jul 2004) | 6 lines

This adds the start of the AIS event service code.  The library code
is mostly complete.  The aisexec part just has placeholders for now
and will be filled in later.

BKrev: 410944e7-oXL5OZSJvizPPH9dGS2GA

------------------------------------------------------------------------
r140 | osdl.net!markh | 2004-07-29 11:41:43 -0700 (Thu, 29 Jul 2004) | 4 lines

Added event library and depend target.

(Logical change 1.46)

------------------------------------------------------------------------
r139 | osdl.net!markh | 2004-07-29 11:41:43 -0700 (Thu, 29 Jul 2004) | 4 lines

added event service handler.

(Logical change 1.46)

------------------------------------------------------------------------
r138 | osdl.net!markh | 2004-07-29 11:41:43 -0700 (Thu, 29 Jul 2004) | 4 lines

added event service.

(Logical change 1.46)

------------------------------------------------------------------------
r137 | osdl.net!markh | 2004-07-29 11:41:43 -0700 (Thu, 29 Jul 2004) | 4 lines

Added clustTimeNow to get current time in nanoseconds.

(Logical change 1.46)

------------------------------------------------------------------------
r136 | osdl.net!markh | 2004-07-29 11:41:43 -0700 (Thu, 29 Jul 2004) | 4 lines

Added event test program and depend target.

(Logical change 1.46)

------------------------------------------------------------------------
r135 | osdl.net!markh | 2004-07-29 11:41:43 -0700 (Thu, 29 Jul 2004) | 2 lines

(Logical change 1.46)

------------------------------------------------------------------------
r134 | osdl.net!markh | 2004-07-29 11:41:42 -0700 (Thu, 29 Jul 2004) | 2 lines

Initial revision

------------------------------------------------------------------------
r133 | mvista.com!sdake | 2004-07-28 15:36:12 -0700 (Wed, 28 Jul 2004) | 9 lines

README.devmap:
  Document new changes to exec handler function prototype
  and recommend using the source_addr for deferring requests
  instead of recording the ip address in the message itself.
main.c, handlers.h, clm.c, ckpt.c, amf.c:
  Add source_addr to exec message handler for event service.

BKrev: 41082a5cY6cLQK7NG_rxZrkb7lERfw

------------------------------------------------------------------------
r132 | mvista.com!sdake | 2004-07-28 15:36:12 -0700 (Wed, 28 Jul 2004) | 6 lines

Document new changes to exec handler function prototype
and recommend using the source_addr for deferring requests
instead of recording the ip address in the message itself.

(Logical change 1.45)

------------------------------------------------------------------------
r131 | mvista.com!sdake | 2004-07-28 15:36:12 -0700 (Wed, 28 Jul 2004) | 4 lines

Add source_addr to exec message handler for event service.

(Logical change 1.45)

------------------------------------------------------------------------
r130 | mvista.com!sdake | 2004-07-27 16:30:47 -0700 (Tue, 27 Jul 2004) | 6 lines

Major cleanup and use hdb.c abstracted out functions
now instead of internal hacked together stuff that was
there previously.

(Logical change 1.44)

------------------------------------------------------------------------
r129 | mvista.com!sdake | 2004-07-27 16:30:47 -0700 (Tue, 27 Jul 2004) | 9 lines

Remove "old-style" handle database code from aispoll.c and include
instead hdb.c/hdb.h.  These files are copies of the handle database
code used for the library without mutexes.

This work for Mark Haverkamp to use the handle database functionality
as part of the event service.

BKrev: 4106e5a7ANCdXqe3zoIfO1tcYyrQhQ

------------------------------------------------------------------------
r128 | mvista.com!sdake | 2004-07-27 16:30:47 -0700 (Tue, 27 Jul 2004) | 4 lines

Major cleanup to use hdb.c handle database functions.

(Logical change 1.44)

------------------------------------------------------------------------
r127 | mvista.com!sdake | 2004-07-27 16:30:47 -0700 (Tue, 27 Jul 2004) | 4 lines

Add hdb.c to the build.

(Logical change 1.44)

------------------------------------------------------------------------
r126 | mvista.com!sdake | 2004-07-27 16:30:47 -0700 (Tue, 27 Jul 2004) | 2 lines

(Logical change 1.44)

------------------------------------------------------------------------
r125 | mvista.com!sdake | 2004-07-27 16:30:46 -0700 (Tue, 27 Jul 2004) | 2 lines

Initial revision

------------------------------------------------------------------------
r124 | mvista.com!sdake | 2004-07-27 16:27:13 -0700 (Tue, 27 Jul 2004) | 6 lines

Remove handle state and handle instance information.
Also cleanup saHandleCreate to return unsigned int
handle instead of int handle.

(Logical change 1.43)

------------------------------------------------------------------------
r123 | mvista.com!sdake | 2004-07-27 16:27:13 -0700 (Tue, 27 Jul 2004) | 5 lines

Hide handle state and handle instance information
in this file instead of in global header file.

(Logical change 1.43)

------------------------------------------------------------------------
r122 | mvista.com!sdake | 2004-07-27 16:27:13 -0700 (Tue, 27 Jul 2004) | 10 lines

util.h:
  Remove handle state and handle instance information.
  Also cleanup saHandleCreate to return unsigned int
  handle instead of int handle.
util.c:
  Hide handle state and handle instance information
  in this file instead of in global header file.

BKrev: 4106e4d1-Ntb973S5ymyNwgL6e0PDw

------------------------------------------------------------------------
r121 | mvista.com!sdake | 2004-07-26 15:17:36 -0700 (Mon, 26 Jul 2004) | 5 lines

Remove BINDTODEVICE socket option and replace with MULTICAST_IF
to be more portable and require less root privs.

(Logical change 1.42)

------------------------------------------------------------------------
r120 | mvista.com!sdake | 2004-07-26 15:17:36 -0700 (Mon, 26 Jul 2004) | 6 lines

gmi.c:
  Remove BINDTODEVICE socket option and replace with MULTICAST_IF
  to be more portable and require less root privs.

BKrev: 410583008afZgkQ66_jDep-8pFf_nw

------------------------------------------------------------------------
r119 | mvista.com!sdake | 2004-07-23 15:15:04 -0700 (Fri, 23 Jul 2004) | 5 lines

Additional information for using the saRecvQueue call in a
library.

(Logical change 1.41)

------------------------------------------------------------------------
r118 | mvista.com!sdake | 2004-07-23 15:15:04 -0700 (Fri, 23 Jul 2004) | 6 lines

README.devmap:
  Additional information for using the saRecvQueue call in a
  library.

BKrev: 41018de8tOmRhu_QtrtzbSGzWHSMKA

------------------------------------------------------------------------
r117 | mvista.com!sdake | 2004-07-20 16:47:28 -0700 (Tue, 20 Jul 2004) | 2 lines

(Logical change 1.40)

------------------------------------------------------------------------
r116 | mvista.com!sdake | 2004-07-20 16:47:28 -0700 (Tue, 20 Jul 2004) | 6 lines

SECURITY:
  Description of the security policy of the openais project.  Includes a
  description of the techniques used in openais.

BKrev: 40fdaf10zR42cuBrfB9UB-Bc-edNsQ

------------------------------------------------------------------------
r115 | mvista.com!sdake | 2004-07-20 16:47:27 -0700 (Tue, 20 Jul 2004) | 2 lines

Initial revision

------------------------------------------------------------------------
r114 | mvista.com!sdake | 2004-07-14 17:03:02 -0700 (Wed, 14 Jul 2004) | 4 lines

Major improvements to fragmentation.  It works alot better now.

(Logical change 1.39)

------------------------------------------------------------------------
r113 | mvista.com!sdake | 2004-07-14 17:03:02 -0700 (Wed, 14 Jul 2004) | 8 lines

Major improvements to quality in the GMI.  Previously with 12 processors
and running ckptstress from two nodes, one node would fail to make
forward progress.  Sometimes the nodes would assert or crash.  All the
fragmentation code has been rewritten to be more stable and of better
design (at the cost of a little more memory).

BKrev: 40f5c9b6KnXRw3_UyUgLV-cIvI7YpA

------------------------------------------------------------------------
r112 | mvista.com!sdake | 2004-07-13 10:20:56 -0700 (Tue, 13 Jul 2004) | 6 lines

Allow NULL delivery_fn in gmi_join.  This basically has no
effect but allows the processor to participate in multicasting
and membership.

(Logical change 1.38)

------------------------------------------------------------------------
r111 | mvista.com!sdake | 2004-07-13 10:20:56 -0700 (Tue, 13 Jul 2004) | 7 lines

gmi.c:
  Allow NULL delivery_fn in gmi_join.  This basically has no
  effect but allows the processor to participate in multicasting
  and membership.

BKrev: 40f419f8lTr8W134C7CXrtXRnzoMzw

------------------------------------------------------------------------
r110 | mvista.com!sdake | 2004-07-13 10:19:43 -0700 (Tue, 13 Jul 2004) | 7 lines

Extraneous tokens were not being rejected on token retransmits
that occurred during configuration changes.  The result was bad
behavior, especially with larger rings.  Also cleaned up the
token retransmit timer to be deleted if necessary.

(Logical change 1.37)

------------------------------------------------------------------------
r109 | mvista.com!sdake | 2004-07-13 10:19:43 -0700 (Tue, 13 Jul 2004) | 8 lines

gmi.c:
  Extraneous tokens were not being rejected on token retransmits
  that occurred during configuration changes.  The result was bad
  behavior, especially with larger rings.  Also cleaned up the
  token retransmit timer to be deleted if necessary.

BKrev: 40f419afbeZlmKywfUpsrDkU5kMnHg

------------------------------------------------------------------------
r108 | mvista.com!sdake | 2004-07-12 20:51:52 -0700 (Mon, 12 Jul 2004) | 4 lines

Add ip to deliver_fn callback

(Logical change 1.36)

------------------------------------------------------------------------
r107 | mvista.com!sdake | 2004-07-12 20:51:52 -0700 (Mon, 12 Jul 2004) | 4 lines

Add ip to deliver_fn callback

BKrev: 40f35c58ypi89e5Nq53F73OF8QGakA

------------------------------------------------------------------------
r106 | mvista.com!sdake | 2004-07-12 20:51:52 -0700 (Mon, 12 Jul 2004) | 6 lines

Add ip to deliver_fn callback
Add ip to deliver_fn callback
Add ip to deliver_fn callback

(Logical change 1.36)

------------------------------------------------------------------------
r105 | mvista.com!sdake | 2004-07-12 20:48:48 -0700 (Mon, 12 Jul 2004) | 4 lines

Removed something that was necessary in last changeset.

(Logical change 1.35)

------------------------------------------------------------------------
r104 | mvista.com!sdake | 2004-07-12 20:48:48 -0700 (Mon, 12 Jul 2004) | 5 lines

gmi.c:
  Removed something that was necessary in last changeset.

BKrev: 40f35ba0CGzAzJZVAZx-QxSIYzQlNQ

------------------------------------------------------------------------
r103 | mvista.com!sdake | 2004-07-12 14:46:02 -0700 (Mon, 12 Jul 2004) | 5 lines

gmi.c:
  Fix debug exit.

BKrev: 40f3069ao4cKWSuICZHrMdMIqJDlMw

------------------------------------------------------------------------
r102 | mvista.com!sdake | 2004-07-12 14:46:02 -0700 (Mon, 12 Jul 2004) | 4 lines

Fix debug exit.

(Logical change 1.34)

------------------------------------------------------------------------
r101 | mvista.com!sdake | 2004-07-12 14:40:31 -0700 (Mon, 12 Jul 2004) | 16 lines

Merge sdake@bk.osdl.org:/var/bk/openais
into persist.az.mvista.com:/home/sdake/openais

2004/07/12 14:40:19-07:00 mvista.com!sdake
gmi.c:
  When a processor left the membership, the next configuration would sometimes
  cause a form token timeout.  While not particularly harmful, it was wasteful
  and not part of the original design of the group messaging protocol.
  There was some extra junk code that was added to workaround some other bug
  that has since been fixed.
  This junk code removed and now the form token never times out (woohoo).
  Also removed some extra code that calculates the next ORF processor twice.
  We only really need to do it once.

BKrev: 40f3054fipDDp-KdB8CJpzw0vS3PfA

------------------------------------------------------------------------
r100 | mvista.com!sdake | 2004-07-12 14:40:31 -0700 (Mon, 12 Jul 2004) | 14 lines

Auto merged

2004/07/12 14:37:13-07:00 mvista.com!sdake
When a processor left the membership, the next configuration would sometimes
cause a form token timeout.  While not particularly harmful, it was wasteful
and not part of the original design of the group messaging protocol.
There was some extra junk code that was added to workaround some other bug
that has since been fixed.
This junk code removed and now the form token never times out (woohoo).
Also removed some extra code that calculates the next ORF processor twice.
We only really need to do it once.

(Logical change 1.33)

------------------------------------------------------------------------
r99 | broked.org!sdake | 2004-07-11 21:16:02 -0700 (Sun, 11 Jul 2004) | 8 lines

Retransmit orf token if no multicast or token received within a timeout
period.  This could mean that the token was lost, but no configuration
change has really occured.  Rather then execute the heavyweight
membership protocol, just retry the token and if it fails after the
token timeout, execute a configuration change sequence.

BKrev: 40f21082dvUxH0aOPvKmpqoqlkEgEA

------------------------------------------------------------------------
r98 | broked.org!sdake | 2004-07-11 21:16:02 -0700 (Sun, 11 Jul 2004) | 7 lines

Add retransmit of token if no multicast or token received
within a timeout period (100 msec).  This helps avoid
a reconfiguration when only the token is lost, but no
real configuration changes have occured.

(Logical change 1.32)

------------------------------------------------------------------------
r97 | broked.org!sdake | 2004-07-11 20:49:04 -0700 (Sun, 11 Jul 2004) | 5 lines

Changeset 1.22 introduced problem with managing messages
in the sort queue.  The result was memory leakage.

(Logical change 1.31)

------------------------------------------------------------------------
r96 | broked.org!sdake | 2004-07-11 20:49:04 -0700 (Sun, 11 Jul 2004) | 4 lines

Fix memory leak introduced in changeset 1.22.

BKrev: 40f20a301E28mF_1r27z43zk2MqHeA

------------------------------------------------------------------------
r95 | mvista.com!sdake | 2004-07-11 00:22:12 -0700 (Sun, 11 Jul 2004) | 4 lines

Clean up warnings found with -pedantic.

BKrev: 40f0eaa4fMlsgdXtJH-HQEl5nRh78Q

------------------------------------------------------------------------
r94 | mvista.com!sdake | 2004-07-11 00:22:12 -0700 (Sun, 11 Jul 2004) | 4 lines

Clean up warnings found with -pedantic.

(Logical change 1.30)

------------------------------------------------------------------------
r93 | mvista.com!sdake | 2004-07-11 00:22:12 -0700 (Sun, 11 Jul 2004) | 4 lines

Changed references to C99 initializers after pedantic cleanup

(Logical change 1.30)

------------------------------------------------------------------------
r92 | mvista.com!sdake | 2004-07-09 20:57:32 -0700 (Fri, 09 Jul 2004) | 6 lines

Removes the external dependency from the gmi to the global variable
this_ip.  This is still passed in for gmi_init users to be notified
of which IP was selected, but copied for local use.

BKrev: 40ef692cfv-e5JCQ8T9iC-_i3AaBcg

------------------------------------------------------------------------
r91 | mvista.com!sdake | 2004-07-09 20:57:32 -0700 (Fri, 09 Jul 2004) | 4 lines

Fixes build problem with rename of aispoll.c.

(Logical change 1.29)

------------------------------------------------------------------------
r90 | mvista.com!sdake | 2004-07-09 20:57:32 -0700 (Fri, 09 Jul 2004) | 6 lines

Removes this_ip external dependency and instead copies the
bound to address to storage local to the group messaging
interface.

(Logical change 1.29)

------------------------------------------------------------------------
r89 | mvista.com!sdake | 2004-07-09 14:35:41 -0700 (Fri, 09 Jul 2004) | 4 lines

Rename: exec/poll.h -> exec/aispoll.h

}(Logical change 1.28)

------------------------------------------------------------------------
r88 | mvista.com!sdake | 2004-07-09 14:35:41 -0700 (Fri, 09 Jul 2004) | 5 lines

Rename aispoll.h so that people using the aispoll header file do not
collide with sys/poll.h.

BKrev: 40ef0fadvg4jQb-J9VhBM25mh_mdMQ

------------------------------------------------------------------------
r87 | mvista.com!sdake | 2004-07-09 14:35:41 -0700 (Fri, 09 Jul 2004) | 4 lines

Rename: exec/poll.h -> exec/aispoll.h

(Logical change 1.28)

------------------------------------------------------------------------
r86 | mvista.com!sdake | 2004-07-09 14:35:41 -0700 (Fri, 09 Jul 2004) | 4 lines

Rename: exec/poll.c -> exec/aispoll.c

(Logical change 1.28)

------------------------------------------------------------------------
r85 | mvista.com!sdake | 2004-07-09 14:35:41 -0700 (Fri, 09 Jul 2004) | 4 lines

Rename: exec/poll.c -> exec/aispoll.c

}(Logical change 1.28)

------------------------------------------------------------------------
r84 | mvista.com!sdake | 2004-07-09 14:35:41 -0700 (Fri, 09 Jul 2004) | 4 lines

Rename poll.h to aispoll.h

(Logical change 1.28)

------------------------------------------------------------------------
r83 | mvista.com!sdake | 2004-07-09 14:35:40 -0700 (Fri, 09 Jul 2004) | 2 lines

Initial revision

------------------------------------------------------------------------
r82 | mvista.com!sdake | 2004-07-08 13:47:25 -0700 (Thu, 08 Jul 2004) | 6 lines

Fix a merge problem with the previous update to the amf with
the conn_info structure.
the track list was not being initialized at start.

(Logical change 1.27)

------------------------------------------------------------------------
r81 | mvista.com!sdake | 2004-07-08 13:47:25 -0700 (Thu, 08 Jul 2004) | 4 lines

Fix merge bugs from changeset 1.23.

BKrev: 40edb2ddF4jV4bxQYmbXj7nCSPCe2w

------------------------------------------------------------------------
r80 | mvista.com!sdake | 2004-07-08 13:47:25 -0700 (Thu, 08 Jul 2004) | 10 lines

Fix a couple merge problems with the previous update to clm with the
conn_info structure.
the track list was not being initialized.  When track start was called
the tracking wasn't added to a list.  When track stop was called
the tracking was not deleted.
The result of all this is that cluster membership tracking was broken
previously.

(Logical change 1.27)

------------------------------------------------------------------------
r79 | mvista.com!sdake | 2004-07-08 12:45:04 -0700 (Thu, 08 Jul 2004) | 5 lines

Development documentation update.  After reading these docs, it should
be possible to add a service to the AIS.

(Logical change 1.26)

------------------------------------------------------------------------
r78 | mvista.com!sdake | 2004-07-08 12:45:04 -0700 (Thu, 08 Jul 2004) | 4 lines

Learn how to develop an AIS service with README.devmap.

BKrev: 40eda440k9_Mia7kFQvGzgthaN_bWQ

------------------------------------------------------------------------
r77 | mvista.com!sdake | 2004-07-07 15:05:19 -0700 (Wed, 07 Jul 2004) | 4 lines

Fix build errors after previous commit.

(Logical change 1.25)

------------------------------------------------------------------------
r76 | mvista.com!sdake | 2004-07-07 15:05:19 -0700 (Wed, 07 Jul 2004) | 4 lines

Cleanup last commit so build occurs properly.

BKrev: 40ec739f-StbBZFtCXNnVcEbdIqOYg

------------------------------------------------------------------------
r75 | mvista.com!sdake | 2004-07-07 15:02:05 -0700 (Wed, 07 Jul 2004) | 6 lines

pass conn_info to all messages instead of file descriptor.
This requires changing the initialization phase of the socket
and all calls made.

(Logical change 1.24)

------------------------------------------------------------------------
r74 | mvista.com!sdake | 2004-07-07 15:02:05 -0700 (Wed, 07 Jul 2004) | 7 lines

Big cleanup of executive to pass connection info by reference instead
of having connection info as an array seperate from the poll interface.
This makes the code alot cleaner and easier to read, plus removes
duplicated code in the connection array management.

BKrev: 40ec72dd7wKGeQDubAA6lmUMc7JjOQ

------------------------------------------------------------------------
r73 | mvista.com!sdake | 2004-07-07 15:02:05 -0700 (Wed, 07 Jul 2004) | 4 lines

update todo by removing completed items.

(Logical change 1.24)

------------------------------------------------------------------------
r72 | mvista.com!sdake | 2004-07-07 15:02:05 -0700 (Wed, 07 Jul 2004) | 4 lines

store conn_info field is component structure.

(Logical change 1.24)

------------------------------------------------------------------------
r71 | mvista.com!sdake | 2004-07-07 15:02:05 -0700 (Wed, 07 Jul 2004) | 4 lines

pass conn_info to all messages instead of file descriptor.

(Logical change 1.24)

------------------------------------------------------------------------
r70 | mvista.com!sdake | 2004-07-07 15:02:05 -0700 (Wed, 07 Jul 2004) | 6 lines

pass conn_info to all messages instead of file descriptor.
this requires removing the connection structure and replacing
with the conn_info structure.

(Logical change 1.24)

------------------------------------------------------------------------
r69 | mvista.com!sdake | 2004-07-07 15:02:05 -0700 (Wed, 07 Jul 2004) | 5 lines

when gmi.c changed, full project would not always be rebuilt
fixed this issue.

(Logical change 1.24)

------------------------------------------------------------------------
r68 | mvista.com!sdake | 2004-07-07 15:02:05 -0700 (Wed, 07 Jul 2004) | 4 lines

Run full tests instead of writing a bunch of checkpoints.

(Logical change 1.24)

------------------------------------------------------------------------
r67 | mvista.com!sdake | 2004-07-07 15:02:05 -0700 (Wed, 07 Jul 2004) | 4 lines

Add track active variable to keep track of active connections.

(Logical change 1.24)

------------------------------------------------------------------------
r66 | mvista.com!sdake | 2004-07-07 15:02:05 -0700 (Wed, 07 Jul 2004) | 4 lines

cleanup valgrind warnings.

(Logical change 1.24)

------------------------------------------------------------------------
r65 | mvista.com!sdake | 2004-07-07 15:02:05 -0700 (Wed, 07 Jul 2004) | 6 lines

change message source to use conn_info field instead of fd.
Also removed a few unneeded calls which were moved to the
amf.c file.

(Logical change 1.24)

------------------------------------------------------------------------
r64 | mvista.com!sdake | 2004-07-07 14:12:01 -0700 (Wed, 07 Jul 2004) | 4 lines

Change memcpy to memmove to quiet down valgrind.

(Logical change 1.23)

------------------------------------------------------------------------
r63 | mvista.com!sdake | 2004-07-07 14:12:01 -0700 (Wed, 07 Jul 2004) | 6 lines

valgrind found an off-by-one error in message frees that could lead
to corruption.
l

(Logical change 1.23)

------------------------------------------------------------------------
r62 | mvista.com!sdake | 2004-07-07 14:12:01 -0700 (Wed, 07 Jul 2004) | 4 lines

Clean up some errors found with valgrind 2.1.1.

BKrev: 40ec6721IO7rAWx1t4cNnFNTugIZ1A

------------------------------------------------------------------------
r61 | mvista.com!sdake | 2004-07-07 14:12:01 -0700 (Wed, 07 Jul 2004) | 4 lines

Get rid of some errors from valgrind by initializing variables.

(Logical change 1.23)

------------------------------------------------------------------------
r60 | mvista.com!sdake | 2004-07-06 13:05:14 -0700 (Tue, 06 Jul 2004) | 4 lines

Remove extra unused parameter to exec messages.

(Logical change 1.22)

------------------------------------------------------------------------
r59 | mvista.com!sdake | 2004-07-06 13:05:14 -0700 (Tue, 06 Jul 2004) | 4 lines

Remove extra parameter to exec messages.

(Logical change 1.22)

------------------------------------------------------------------------
r58 | mvista.com!sdake | 2004-07-06 13:05:14 -0700 (Tue, 06 Jul 2004) | 6 lines

Every exec message was of the prototype int func (int fd, void *msg).
The "int fd" was not used by an executive message and was dead code from
a previous implementation.  This dead parameter removed from the tree.

BKrev: 40eb05fa_UbGyISyMyNciMoGXAXDeg

------------------------------------------------------------------------
r57 | mvista.com!sdake | 2004-07-06 12:25:41 -0700 (Tue, 06 Jul 2004) | 4 lines

Add activate poll message.

(Logical change 1.21)

------------------------------------------------------------------------
r56 | mvista.com!sdake | 2004-07-06 12:25:41 -0700 (Tue, 06 Jul 2004) | 4 lines

Use new APIs for handle reference counting

(Logical change 1.21)

------------------------------------------------------------------------
r55 | mvista.com!sdake | 2004-07-06 12:25:41 -0700 (Tue, 06 Jul 2004) | 6 lines

Change clunky locking used in library APIs to use reference counting
instead.  A BIG thanks to Chris Friesen who provided the initial ideas,
additional comments and more ideas leading up to the commit.

BKrev: 40eafcb50VMDbK4i9ZEiu0_90gFlPQ

------------------------------------------------------------------------
r54 | mvista.com!sdake | 2004-07-06 12:25:41 -0700 (Tue, 06 Jul 2004) | 4 lines

Fix example to use component names in example service group.

(Logical change 1.21)

------------------------------------------------------------------------
r53 | mvista.com!sdake | 2004-07-06 12:25:41 -0700 (Tue, 06 Jul 2004) | 5 lines

Change activate poll definitions to be generic instead of AMF
specific.

(Logical change 1.21)

------------------------------------------------------------------------
r52 | mvista.com!sdake | 2004-07-06 12:25:41 -0700 (Tue, 06 Jul 2004) | 4 lines

Use new APIs for handle reference counting.

(Logical change 1.21)

------------------------------------------------------------------------
r51 | mvista.com!sdake | 2004-07-06 12:25:41 -0700 (Tue, 06 Jul 2004) | 4 lines

add activate poll message

(Logical change 1.21)

------------------------------------------------------------------------
r50 | mvista.com!sdake | 2004-07-06 11:26:11 -0700 (Tue, 06 Jul 2004) | 5 lines

Fix segfault during membership changes with multiple leaves
at the same time.

BKrev: 40eaeec3CJrXaOzED0qddXmUUurQdg

------------------------------------------------------------------------
r49 | mvista.com!sdake | 2004-07-06 11:26:11 -0700 (Tue, 06 Jul 2004) | 6 lines

Wrong value being used to determine leave list, resulting in
a memcpy with a -1 value in some cases, and the incorrect memcpy
in other cases.

(Logical change 1.20)

------------------------------------------------------------------------
r48 | mvista.com!sdake | 2004-07-01 13:45:11 -0700 (Thu, 01 Jul 2004) | 6 lines

With a two node cluster and one node killed, the remaining node
didn't sent the appropriate configuration changes to the clm API
or to the rest of the services.

(Logical change 1.19)

------------------------------------------------------------------------
r47 | mvista.com!sdake | 2004-07-01 13:45:11 -0700 (Thu, 01 Jul 2004) | 5 lines

Fix two node cluster membership event not appearing on leave problem
reported by Chris Friesen.

BKrev: 40e477d75L2YauKHr18UGUlPGfAEoA

------------------------------------------------------------------------
r46 | mvista.com!sdake | 2004-07-01 11:03:30 -0700 (Thu, 01 Jul 2004) | 4 lines

remove dead code.

BKrev: 40e451f2-IOwwPNaNm65NetyBme-nw

------------------------------------------------------------------------
r45 | mvista.com!sdake | 2004-07-01 11:03:30 -0700 (Thu, 01 Jul 2004) | 4 lines

remove dead code.

(Logical change 1.18)

------------------------------------------------------------------------
r44 | mvista.com!sdake | 2004-06-30 12:07:39 -0700 (Wed, 30 Jun 2004) | 11 lines

The group messaging interface has been exported as a library for use
in other programs.  The key interfaces are exec/gmi.h and exec/poll.h.
gmi.h describes the interface for group messaging, while poll.h
describes the interface for abstracting poll system call with timers
and integrated with gmi.
By including these headers in programs and linking with libgmi, it is
possible to use the virtual synchrony layer (group messaging interface)
used in AIS for other applications.

BKrev: 40e30f7bM1KpRbp3-Bf2qVPRH1EsFA

------------------------------------------------------------------------
r43 | mvista.com!sdake | 2004-06-30 12:07:39 -0700 (Wed, 30 Jun 2004) | 4 lines

Initialize logging function in group messaging interface.

(Logical change 1.17)

------------------------------------------------------------------------
r42 | mvista.com!sdake | 2004-06-30 12:07:39 -0700 (Wed, 30 Jun 2004) | 4 lines

Build gmi static and shared library for use in other programs.

(Logical change 1.17)

------------------------------------------------------------------------
r41 | mvista.com!sdake | 2004-06-30 12:07:39 -0700 (Wed, 30 Jun 2004) | 4 lines

Add logging function init interface.

(Logical change 1.17)

------------------------------------------------------------------------
r40 | mvista.com!sdake | 2004-06-30 12:07:39 -0700 (Wed, 30 Jun 2004) | 5 lines

Add ability to pass in logging function for people that want to
use their own logging functions in their own programs.

(Logical change 1.17)

------------------------------------------------------------------------
r39 | mvista.com!sdake | 2004-06-30 12:07:39 -0700 (Wed, 30 Jun 2004) | 4 lines

add debug checking version of logging function.

(Logical change 1.17)

------------------------------------------------------------------------
r38 | mvista.com!sdake | 2004-06-30 12:07:39 -0700 (Wed, 30 Jun 2004) | 4 lines

make clean didn't remove ckptbench and ckptbenchth binaries

(Logical change 1.17)

------------------------------------------------------------------------
r37 | mvista.com!sdake | 2004-06-30 00:23:45 -0700 (Wed, 30 Jun 2004) | 8 lines

Chris Friesen reported the testamf programs don't work correctly.
Error in description of quickstart guide about how they
should work which has been corrected.
Also added information about using the ckptbench and
ckptbenchth programs to benchmark checkpoint writes.

(Logical change 1.16)

------------------------------------------------------------------------
r36 | mvista.com!sdake | 2004-06-30 00:23:45 -0700 (Wed, 30 Jun 2004) | 2 lines

(Logical change 1.16)

------------------------------------------------------------------------
r35 | mvista.com!sdake | 2004-06-30 00:23:45 -0700 (Wed, 30 Jun 2004) | 6 lines

Modify QUICKSTART to clarify how testamf{1-6} work and added some
text about using the ckptbench and ckptbenchth test programs.  Also
added the ckptbench and ckptbenchth programs to the build environment.

BKrev: 40e26a810DYCs3LU79Ne-q51pO2TgA

------------------------------------------------------------------------
r34 | mvista.com!sdake | 2004-06-30 00:23:45 -0700 (Wed, 30 Jun 2004) | 4 lines

Add ckptbench and ckptbenchth targets

(Logical change 1.16)

------------------------------------------------------------------------
r33 | mvista.com!sdake | 2004-06-30 00:23:44 -0700 (Wed, 30 Jun 2004) | 2 lines

Initial revision

------------------------------------------------------------------------
r32 | mvista.com!sdake | 2004-06-28 15:04:20 -0700 (Mon, 28 Jun 2004) | 5 lines

Cluster membership API not being authenticated by openais executive.
This results in testclm locking on start in saClmInitialize.

BKrev: 40e095e4VUojyuQYOBeAUqjZnbBTCA

------------------------------------------------------------------------
r31 | mvista.com!sdake | 2004-06-28 15:04:20 -0700 (Mon, 28 Jun 2004) | 4 lines

Fix cluster membership API not being authenticated bug.

(Logical change 1.15)

------------------------------------------------------------------------
r30 | mvista.com!sdake | 2004-06-27 14:01:24 -0700 (Sun, 27 Jun 2004) | 6 lines

Make bind to a device really work properly.  Now
it is possible to specify the bind network and
the networking will take place over that interface.

(Logical change 1.14)

------------------------------------------------------------------------
r29 | mvista.com!sdake | 2004-06-27 14:01:24 -0700 (Sun, 27 Jun 2004) | 6 lines

Add priv drop so process doesn't have to run
as root in order to lock, set RR 99, and
bind to a specific ethernet interface for multicast.

(Logical change 1.14)

------------------------------------------------------------------------
r28 | mvista.com!sdake | 2004-06-27 14:01:24 -0700 (Sun, 27 Jun 2004) | 5 lines

Make binding to a specific network really work.  Also added priv
dropping so process doesn't have to run as root for process lifetime.

BKrev: 40df35a4eUCTfC660C7oBwg-P9YE2g

------------------------------------------------------------------------
r27 | mvista.com!sdake | 2004-06-23 14:01:32 -0700 (Wed, 23 Jun 2004) | 7 lines

Yixiong Zou reported a problem where on some OSes the aisexec
couldn't join the multicast group.  This problem fixed.  Also
changed binding rules for sockets relating to the group messaging.
see detailed changlogs for more details.

BKrev: 40d9efacQooUDhv3APjn55QVVjMueg

------------------------------------------------------------------------
r26 | mvista.com!sdake | 2004-06-23 14:01:32 -0700 (Wed, 23 Jun 2004) | 14 lines

Fix binding rules so that instead of binding to INADDR_ANY for
UDP sockets, bind to specific interface defined in network.conf.
This is done by creating two fds.  gmi_fd_token is used for all
token communication.  gmi_fd_mcast is used for all mcast
communication.  I'm not sure if gmi_fd_mcast binding rules is
correct.  Once work begins on multipathing, this will have to
be figured out :)

2004/06/23 13:55:52-07:00 mvista.com!sdake
Use portable mreq instead of mreqn when joining the multicast
group.

(Logical change 1.13)

------------------------------------------------------------------------
r25 | mvista.com!sdake | 2004-06-22 23:19:43 -0700 (Tue, 22 Jun 2004) | 8 lines

QUICKSTART:
  Modified quickstart guide thanks to comments from Yixiong Zou
  Information about adding groups added
  Information about testclm blocking until cluster membership
  event occurs added.

BKrev: 40d920ffgjnZO35fZ2d947AV5TWGWQ

------------------------------------------------------------------------
r24 | mvista.com!sdake | 2004-06-22 23:19:43 -0700 (Tue, 22 Jun 2004) | 7 lines

Modified quickstart guide thanks to comments from Yixiong Zou
Information about adding groups added
Information about testclm blocking until cluster membership
event occurs added.

(Logical change 1.12)

------------------------------------------------------------------------
r23 | mvista.com!sdake | 2004-06-21 01:08:30 -0700 (Mon, 21 Jun 2004) | 9 lines

Buffer with message data used outside lock.  This creates a possible race
where data from another response could be used to execute a dispatch.

2004/06/21 00:59:54-07:00 mvista.com!sdake
Remove double pthread_mutex_unlock on saAmfDispatch routine.  Unlock could
unlock another thread's unlock midthread.

(Logical change 1.11)

------------------------------------------------------------------------
r22 | mvista.com!sdake | 2004-06-21 01:08:30 -0700 (Mon, 21 Jun 2004) | 5 lines

Fix race with saClmDispatch where two threads could race
for access to the response data from the AIS Executive.

(Logical change 1.11)

------------------------------------------------------------------------
r21 | mvista.com!sdake | 2004-06-21 01:08:30 -0700 (Mon, 21 Jun 2004) | 4 lines

Fix race relating to threads and saClmDispatch/saAmfDispatch.

BKrev: 40d6977ewZ8VFYD8mJyEaPWxg0tI7w

------------------------------------------------------------------------
r20 | mvista.com!sdake | 2004-06-20 00:35:39 -0700 (Sun, 20 Jun 2004) | 5 lines

Add support for C++ linkage to cluster membership API.
Without this change, C++ programs will not link to the library.

BKrev: 40d53e4bzcKNiPnfX523_065NBw4gg

------------------------------------------------------------------------
r19 | mvista.com!sdake | 2004-06-20 00:35:39 -0700 (Sun, 20 Jun 2004) | 4 lines

Add support for C++ linkage to cluster membership APIs.

(Logical change 1.10)

------------------------------------------------------------------------
r18 | mvista.com!sdake | 2004-06-20 00:30:46 -0700 (Sun, 20 Jun 2004) | 4 lines

Port not actually set to correct port as found with tcpdump.

BKrev: 40d53d26QDtzR8msp2zMvJ-9Mq6-Tw

------------------------------------------------------------------------
r17 | mvista.com!sdake | 2004-06-20 00:30:46 -0700 (Sun, 20 Jun 2004) | 6 lines

x86 was not setting port to network byte order, which resulted in
port being byte swapped.  This of course, doesn't work well with
xscale boards.

(Logical change 1.9)

------------------------------------------------------------------------
r16 | mvista.com!sdake | 2004-06-18 14:15:44 -0700 (Fri, 18 Jun 2004) | 4 lines

quickstart gives incorrect info about multicast addresses, now corrected.

BKrev: 40d35b80BGcr_8TvtSlrbEZBn14zZA

------------------------------------------------------------------------
r15 | mvista.com!sdake | 2004-06-18 14:15:44 -0700 (Fri, 18 Jun 2004) | 4 lines

fix error in quickstart

(Logical change 1.8)

------------------------------------------------------------------------
r14 | mvista.com!sdake | 2004-06-17 16:50:26 -0700 (Thu, 17 Jun 2004) | 4 lines

Fix single-node AMF assertion failure (cause runaway recursion).

BKrev: 40d22e42IsByk3WqoRIGSlETLqdUgw

------------------------------------------------------------------------
r13 | mvista.com!sdake | 2004-06-17 16:50:26 -0700 (Thu, 17 Jun 2004) | 7 lines

single node AMF would fail because of a recursion bug.  Removed
the recursion by queueing single node message delivery as a timer
with 0 timeout.  This was happening before, but the logic was
wrong.

(Logical change 1.7)

------------------------------------------------------------------------
r12 | mvista.com!sdake | 2004-06-17 14:54:28 -0700 (Thu, 17 Jun 2004) | 4 lines

Crash when no network.conf file present (missing error checking).

(Logical change 1.6)

------------------------------------------------------------------------
r11 | mvista.com!sdake | 2004-06-17 14:54:28 -0700 (Thu, 17 Jun 2004) | 4 lines

Fix crash when error reading network.conf file.

BKrev: 40d21314UfLNnjjrMSt_4U9rJZSVHA

------------------------------------------------------------------------
r10 | mvista.com!sdake | 2004-06-16 15:50:39 -0700 (Wed, 16 Jun 2004) | 11 lines

Fix bug in membership protocol where form token sometimes times out
because the initial send of the token is sent to the wrong address.

2004/06/16 15:42:49-07:00 mvista.com!sdake
Performance enhancements: Allow more messages to be multicast per
token possession to reach 8.8MB/sec checkpoint performance without
remcasts.  Trim gather/commit timeouts to 100 msec to speed up the
membership gathering process.

(Logical change 1.5)

------------------------------------------------------------------------
r9 | mvista.com!sdake | 2004-06-16 15:50:39 -0700 (Wed, 16 Jun 2004) | 4 lines

Bug fix and performance enhancements to the group messaging protocol.

BKrev: 40d0cebf3iPVrudikdxGEhhTs-CQMw

------------------------------------------------------------------------
r8 | mvista.com!sdake | 2004-06-15 23:10:39 -0700 (Tue, 15 Jun 2004) | 5 lines

QUICKSTART:
  Test change

BKrev: 40cfe45fPOa0mbN6jPO9bRiSG_tZWA

------------------------------------------------------------------------
r7 | mvista.com!sdake | 2004-06-15 23:10:39 -0700 (Tue, 15 Jun 2004) | 4 lines

Test change

(Logical change 1.4)

------------------------------------------------------------------------
r6 | osdl.net!cherry | 2004-06-15 15:18:04 -0700 (Tue, 15 Jun 2004) | 4 lines

Import changeset

BKrev: 40cf759cAkpvgQbZ43nWNRClHYqlXQ

------------------------------------------------------------------------
r5 | osdl.net!cherry | 2004-06-15 15:18:04 -0700 (Tue, 15 Jun 2004) | 2 lines

(Logical change 1.3)

------------------------------------------------------------------------
r4 | osdl.net!cherry | 2004-06-15 15:18:03 -0700 (Tue, 15 Jun 2004) | 2 lines

Initial revision

------------------------------------------------------------------------
r3 | osdl.net!cem | 2004-06-15 15:16:01 -0700 (Tue, 15 Jun 2004) | 4 lines

Initial repository create

BKrev: 40cf7521T7yNtYdteqiCUMgD7RdOCA

------------------------------------------------------------------------
r2 | osdl.net!cem | 2004-06-15 15:16:00 -0700 (Tue, 15 Jun 2004) | 2 lines

Initial revision

------------------------------------------------------------------------
r1 | (no author) | 2004-06-15 15:16:00 -0700 (Tue, 15 Jun 2004) | 1 line

New repository initialized by cvs2svn.
------------------------------------------------------------------------
